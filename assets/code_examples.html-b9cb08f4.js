import{_ as s,o as a,c as n,a as l}from"./app-4f7ad5aa.js";const p={},e=l(`<h2 id="行情示例" tabindex="-1"><a class="header-anchor" href="#行情示例" aria-hidden="true">#</a> 行情示例</h2><h2 id="_1-vba模式获取涨停股" tabindex="-1"><a class="header-anchor" href="#_1-vba模式获取涨停股" aria-hidden="true">#</a> 1.VBA模式获取涨停股</h2><p>本示例用于获取某列表涨停股。 <br>示例</p><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">stocktype:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">INBLOCK</span><span style="color:#F8F8F2;">(</span><span style="color:#6272A4;">&#39;创业板&#39;) or INBLOCK(&#39;科创板&#39;);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">lastprice:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">ref</span><span style="color:#F8F8F2;">(c,</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">ZT:</span><span style="color:#FF79C6;">IF</span><span style="color:#F8F8F2;">(stocktype,</span><span style="color:#50FA7B;">ROUNDS</span><span style="color:#F8F8F2;">(lastprice</span><span style="color:#FF79C6;">*</span><span style="color:#BD93F9;">1.2</span><span style="color:#F8F8F2;">,</span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;">)</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">close,</span><span style="color:#50FA7B;">ROUNDS</span><span style="color:#F8F8F2;">(lastprice</span><span style="color:#FF79C6;">*</span><span style="color:#BD93F9;">1.1</span><span style="color:#F8F8F2;">,</span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;">)</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">close);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-如何获取连续放量标的" tabindex="-1"><a class="header-anchor" href="#_2-如何获取连续放量标的" aria-hidden="true">#</a> 2.如何获取连续放量标的</h2><p>本示例用于获取连续放量标的。 <br>示例</p><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">B:</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">VOL</span><span style="color:#FF79C6;">&gt;</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(VOL,</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">UPVOL:</span><span style="color:#50FA7B;">COUNT</span><span style="color:#F8F8F2;">(B,M)</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">M;//持续M个周期放量</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-macd背离模型" tabindex="-1"><a class="header-anchor" href="#_3-macd背离模型" aria-hidden="true">#</a> 3.MACD背离模型</h2><p>在相应股票上,建立MACD背离模型，以指标背离作为入场或出出场参考。 <br>示例</p><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">//…………MACD指标计算…………</span></span>
<span class="line"><span style="color:#F8F8F2;">DIFF:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">EMA</span><span style="color:#F8F8F2;">(CLOSE,</span><span style="color:#BD93F9;">12</span><span style="color:#F8F8F2;">)</span><span style="color:#FF79C6;">-</span><span style="color:#50FA7B;">EMA</span><span style="color:#F8F8F2;">(CLOSE,</span><span style="color:#BD93F9;">26</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F8F8F2;">DEA:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">EMA</span><span style="color:#F8F8F2;">(DIFF,</span><span style="color:#BD93F9;">9</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F8F8F2;">MACD:</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">2</span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;">(DIFF</span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;">DEA),COLORSTICK;</span></span>
<span class="line"><span style="color:#F8F8F2;">//……………………………………………………</span></span>
<span class="line"><span style="color:#F8F8F2;">N:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">BARSLAST</span><span style="color:#F8F8F2;">(</span><span style="color:#50FA7B;">CROSS</span><span style="color:#F8F8F2;">(DIFF,DEA))</span><span style="color:#FF79C6;">+</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">N1:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">BARSLAST</span><span style="color:#F8F8F2;">(</span><span style="color:#50FA7B;">CROSS</span><span style="color:#F8F8F2;">(DEA,DIFF))</span><span style="color:#FF79C6;">+</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">DIFF1:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(DIFF,N</span><span style="color:#BD93F9;">-1</span><span style="color:#F8F8F2;">),</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F8F8F2;">DIFF2:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(DIFF,N1</span><span style="color:#BD93F9;">-1</span><span style="color:#F8F8F2;">),</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F8F8F2;">C1:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(C,N</span><span style="color:#BD93F9;">-1</span><span style="color:#F8F8F2;">),</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F8F8F2;">C2:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(C,N1</span><span style="color:#BD93F9;">-1</span><span style="color:#F8F8F2;">),</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F8F8F2;">DBL1:DIFF</span><span style="color:#FF79C6;">&gt;</span><span style="color:#F8F8F2;">DIFF1 </span><span style="color:#FF79C6;">AND</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">CROSS</span><span style="color:#F8F8F2;">(DIFF,DEA) </span><span style="color:#FF79C6;">AND</span><span style="color:#F8F8F2;"> C</span><span style="color:#FF79C6;">&lt;</span><span style="color:#F8F8F2;">C1; //底背离</span></span>
<span class="line"><span style="color:#F8F8F2;">DBL:DIFF</span><span style="color:#FF79C6;">&lt;</span><span style="color:#F8F8F2;">DIFF2 </span><span style="color:#FF79C6;">AND</span><span style="color:#F8F8F2;">  </span><span style="color:#50FA7B;">CROSS</span><span style="color:#F8F8F2;">(DEA,DIFF) </span><span style="color:#FF79C6;">AND</span><span style="color:#F8F8F2;"> C</span><span style="color:#FF79C6;">&gt;</span><span style="color:#F8F8F2;">C2; //顶背离</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-如何在日内分钟级别实现《菲阿里四价》判断" tabindex="-1"><a class="header-anchor" href="#_4-如何在日内分钟级别实现《菲阿里四价》判断" aria-hidden="true">#</a> 4.如何在日内分钟级别实现《菲阿里四价》判断</h2><details class="custom-container details"><summary>什么是菲阿里四价？</summary><p>昨天高点、昨天低点、昨日收盘价、今天开盘价，可并称为菲阿里四价。它由日本期货冠军菲阿里实盘采用的主要突破交易参照系统。 <br>主要特点： 日内交易策略，收盘平仓； <br> 上轨＝昨日高点； <br> 下轨＝昨日低点；</p></details><div class="custom-container tip"><p class="custom-container-title">核心点</p><p>实现该指标的核心在于跨周期引用数据，可以使用CALLSTOCK函数。</p></div><details class="custom-container details"><summary>用法</summary><p>CALLSTOCK(CODE,TYPE[,CYC,N]),引用指定品种代码为 CODE,周期为 CYC(可选)若不填或者为-1 表示使用当前周期,类型为 TYPE 的数据<br>N 为左右偏移周期个数（可选）0 表示引用当前数据，&lt;0 为引用之前数据，&gt;0为引用之后数据。<br>其中 TYPE 的值可为 VTOPEN(开盘) VTHIGH(最高) VTLOW(最低) VTCLOSE(收盘)<br>VTVOL(成交量) VTAMOUNT(成交额) vtOPENINT(持仓量) VTADVANCE(涨数,大盘有效) VTDECLINE(跌数,大盘有效)以及外部数据和万德数据<br>如果找不到同期数据，那么将返回最近的一个。<br>CYC 范围为 0-19，分别表示<br>0:分笔成交、1:1 分钟、2:5 分钟、3:15 分钟、4:30 分钟、5:60 分钟<br>6:日、7:周、8:月、9:年、10:多日、11:多分钟、12:多秒<br>13:多小时、14:季度线、15:半年线、16:节气线、17:3 分钟、18:10 分钟、19:多笔线<br><br> <code>注意</code>引用数据时，需要确认被引用品种周期数据齐全，在首次使用或者在不确定时，请手工进行数据补充工作；</p></details><p>示例</p><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">昨高:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">callstock</span><span style="color:#F8F8F2;">(</span><span style="color:#6272A4;">&#39;&#39;,vthigh,6,-1);//获取当前主图标的昨高</span></span>
<span class="line"><span style="color:#F8F8F2;">昨低:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">callstock</span><span style="color:#F8F8F2;">(</span><span style="color:#6272A4;">&#39;&#39;,vtlow,6,-1);//获取当前主图标的昨低</span></span>
<span class="line"><span style="color:#F8F8F2;">昨收:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">callstock</span><span style="color:#F8F8F2;">(</span><span style="color:#6272A4;">&#39;&#39;,vtclose,6,-1);//获取当前主图标的昨收</span></span>
<span class="line"><span style="color:#F8F8F2;">上轨:昨高;</span></span>
<span class="line"><span style="color:#F8F8F2;">下轨:昨低;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="回测示例" tabindex="-1"><a class="header-anchor" href="#回测示例" aria-hidden="true">#</a> 回测示例</h2><h3 id="单股回测模型a" tabindex="-1"><a class="header-anchor" href="#单股回测模型a" aria-hidden="true">#</a> 单股回测模型A</h3><p>参见默认脚本<code>单股回测模型A</code></p><h3 id="单股回测模型b" tabindex="-1"><a class="header-anchor" href="#单股回测模型b" aria-hidden="true">#</a> 单股回测模型B</h3><p>参见默认脚本<code>单股回测模型B</code></p>`,21),o=[e];function F(c,r){return a(),n("div",null,o)}const i=s(p,[["render",F],["__file","code_examples.html.vue"]]);export{i as default};
