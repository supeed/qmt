import{_ as c,r as t,o as r,c as p,d as F,w as n,e as l,b as s}from"./app-4f7ad5aa.js";const i={},y=s("h2",{id:"调用vba指标计算历史数据",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#调用vba指标计算历史数据","aria-hidden":"true"},"#"),l(" 调用VBA指标计算历史数据")],-1),d=s("div",{class:"language-python line-numbers-mode","data-ext":"py"},[s("pre",{class:"shiki dracula",style:{"background-color":"#282A36"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"# coding:gbk")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"stocks "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," ["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"000001.SZ"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"]")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"formula_name  "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"  "),s("span",{style:{color:"#6272A4"}},"# VBA指标名称")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"period        "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"1d"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"  "),s("span",{style:{color:"#6272A4"}},"# 计算的数据周期")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"start_time    "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"''"),s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#6272A4"}},"# %Y%m%d 或%Y%m%d%H%M%S")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"end_time      "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"''"),s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#6272A4"}},"# %Y%m%d 或%Y%m%d%H%M%S")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"count         "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#FF79C6"}},"-"),s("span",{style:{color:"#BD93F9"}},"1"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#6272A4"}},"# 数据条数，-1为 时间区间内全部数据")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"dividend_type "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"front"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#6272A4"}},"# 复权方式，参考get_market_data_ex的复权种类")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"extend_param  "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," {"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA:N1"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},":"),s("span",{style:{color:"#BD93F9"}},"5"),s("span",{style:{color:"#F8F8F2"}},","),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA:N2"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},":"),s("span",{style:{color:"#BD93F9"}},"20"),s("span",{style:{color:"#F8F8F2"}},","),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA:N3"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},":"),s("span",{style:{color:"#BD93F9"}},"40"),s("span",{style:{color:"#F8F8F2"}},","),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA:N4"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},":"),s("span",{style:{color:"#BD93F9"}},"60"),s("span",{style:{color:"#F8F8F2"}},",} "),s("span",{style:{color:"#6272A4"}},"# MA指标中的参数，等同VBA编辑界面的参数设置中指定参数值")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"# 注意！VBA指标中的变量和值必须以 `:` 符号赋值，才能被python取到")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"# ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"# 例如 MA 指标的VBA写法")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"#       ma1:MA(C,N1);ma2:MA(C,N2);......")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"# 其中，N1等VBA指标使用的参数可用通过extend_param字典进行指定")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FF79C6"}},"def"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#50FA7B"}},"after_init"),s("span",{style:{color:"#F8F8F2"}},"("),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"C"),s("span",{style:{color:"#F8F8F2"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#6272A4"}},"# for s in stocks:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#6272A4"}},"# 订阅后，call_formula可以获取到盘中动态结果")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        "),s("span",{style:{color:"#6272A4"}},"# id = C.subscribe_quote(s, period, '', '', -1)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#FF79C6"}},"for"),s("span",{style:{color:"#F8F8F2"}}," s "),s("span",{style:{color:"#FF79C6"}},"in"),s("span",{style:{color:"#F8F8F2"}}," stocks:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        "),s("span",{style:{color:"#6272A4"}},"# 通过 call_formula 去调用客户端中的 `MA` 指标")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        formula_results "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," call_formula(")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                                formula_name,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                                s,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                                "),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"period"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}},"period,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                                "),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"start_time"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}},"start_time,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                                "),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"end_time"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}},"end_time,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                                "),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"count"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}},"count,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                                "),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"dividend_type"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}},"dividend_type,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                                "),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"extend_param"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}},"extend_param")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                            )")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        "),s("span",{style:{color:"#6272A4"}},"# 返回值是一个多层嵌套的对象")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        "),s("span",{style:{color:"#8BE9FD"}},"print"),s("span",{style:{color:"#F8F8F2"}},"(formula_results.keys()) "),s("span",{style:{color:"#6272A4"}},"# 外层key")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        "),s("span",{style:{color:"#8BE9FD"}},"print"),s("span",{style:{color:"#F8F8F2"}},"(formula_results["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"outputs"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"].keys()) "),s("span",{style:{color:"#6272A4"}},"# 输出MA指标输出值名称")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        "),s("span",{style:{color:"#FF79C6"}},"for"),s("span",{style:{color:"#F8F8F2"}}," k "),s("span",{style:{color:"#FF79C6"}},"in"),s("span",{style:{color:"#F8F8F2"}}," formula_results["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"outputs"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"]:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"            "),s("span",{style:{color:"#6272A4"}},"# 依次输出 标的代码, 指标值名称, 时间戳, 指标值列表")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"            "),s("span",{style:{color:"#8BE9FD"}},"print"),s("span",{style:{color:"#F8F8F2"}},"(s, k, formula_results["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"timelist"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"]["),s("span",{style:{color:"#FF79C6"}},"-"),s("span",{style:{color:"#BD93F9"}},"1"),s("span",{style:{color:"#F8F8F2"}},"],formula_results["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"outputs"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"][k]["),s("span",{style:{color:"#FF79C6"}},"-"),s("span",{style:{color:"#BD93F9"}},"5"),s("span",{style:{color:"#F8F8F2"}},":])")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),m=s("div",{class:"language-python line-numbers-mode","data-ext":"py"},[s("pre",{class:"shiki dracula",style:{"background-color":"#282A36"},tabindex:"0"},[s("code",null,[s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FF79C6"}},"from"),s("span",{style:{color:"#F8F8F2"}}," xtquant "),s("span",{style:{color:"#FF79C6"}},"import"),s("span",{style:{color:"#F8F8F2"}}," xtdata")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"# xtdata.connect(port=58612)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"stocks "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," ["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"000001.SZ"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"]")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"formula_name  "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"  "),s("span",{style:{color:"#6272A4"}},"# VBA指标名称")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"period        "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"1d"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"  "),s("span",{style:{color:"#6272A4"}},"# 计算的数据周期")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"start_time    "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"''"),s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#6272A4"}},"# %Y%m%d 或%Y%m%d%H%M%S")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"end_time      "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"''"),s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#6272A4"}},"# %Y%m%d 或%Y%m%d%H%M%S")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"count         "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#FF79C6"}},"-"),s("span",{style:{color:"#BD93F9"}},"1"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#6272A4"}},"# 数据条数，-1为 时间区间内全部数据")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"dividend_type "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"front"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#6272A4"}},"# 复权方式，参考get_market_data_ex的复权种类")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"extend_param  "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," {"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA:N1"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},":"),s("span",{style:{color:"#BD93F9"}},"5"),s("span",{style:{color:"#F8F8F2"}},","),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA:N2"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},":"),s("span",{style:{color:"#BD93F9"}},"20"),s("span",{style:{color:"#F8F8F2"}},","),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA:N3"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},":"),s("span",{style:{color:"#BD93F9"}},"40"),s("span",{style:{color:"#F8F8F2"}},","),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA:N4"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},":"),s("span",{style:{color:"#BD93F9"}},"60"),s("span",{style:{color:"#F8F8F2"}},",} "),s("span",{style:{color:"#6272A4"}},"# MA指标中的参数，等同VBA编辑界面的参数设置中指定参数值")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"# 注意！VBA指标中的变量和值必须以 `:` 符号赋值，才能被python取到")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"# ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"# 例如 MA 指标的VBA写法")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"#       ma1:MA(C,N1);ma2:MA(C,N2);......")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"# 其中，N1等VBA指标使用的参数可用通过extend_param字典进行指定")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FF79C6"}},"import"),s("span",{style:{color:"#F8F8F2"}}," time")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FF79C6"}},"for"),s("span",{style:{color:"#F8F8F2"}}," s "),s("span",{style:{color:"#FF79C6"}},"in"),s("span",{style:{color:"#F8F8F2"}}," stocks:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#6272A4"}},"# 订阅后，call_formula可以获取到盘中动态结果")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#8BE9FD"}},"id"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," xtdata.subscribe_quote(s, period, "),s("span",{style:{color:"#E9F284"}},"''"),s("span",{style:{color:"#F8F8F2"}},", "),s("span",{style:{color:"#E9F284"}},"''"),s("span",{style:{color:"#F8F8F2"}},", "),s("span",{style:{color:"#FF79C6"}},"-"),s("span",{style:{color:"#BD93F9"}},"1"),s("span",{style:{color:"#F8F8F2"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FF79C6"}},"while"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#BD93F9"}},"1"),s("span",{style:{color:"#F8F8F2"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#FF79C6"}},"for"),s("span",{style:{color:"#F8F8F2"}}," s "),s("span",{style:{color:"#FF79C6"}},"in"),s("span",{style:{color:"#F8F8F2"}}," stocks:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        formula_results "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," xtdata.call_formula(")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                                formula_name,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                                s,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                                "),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"period"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}},"period,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                                "),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"start_time"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}},"start_time,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                                "),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"end_time"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}},"end_time,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                                "),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"count"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}},"count,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                                "),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"dividend_type"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}},"dividend_type,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                                "),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"extend_param"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}},"extend_param")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                            )")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        "),s("span",{style:{color:"#6272A4"}},"# 返回值是一个多层嵌套的对象")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        "),s("span",{style:{color:"#8BE9FD"}},"print"),s("span",{style:{color:"#F8F8F2"}},"(formula_results.keys()) "),s("span",{style:{color:"#6272A4"}},"# 外层key")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        "),s("span",{style:{color:"#8BE9FD"}},"print"),s("span",{style:{color:"#F8F8F2"}},"(formula_results["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"outputs"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"].keys()) "),s("span",{style:{color:"#6272A4"}},"# 输出MA指标输出值名称")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        "),s("span",{style:{color:"#FF79C6"}},"for"),s("span",{style:{color:"#F8F8F2"}}," k "),s("span",{style:{color:"#FF79C6"}},"in"),s("span",{style:{color:"#F8F8F2"}}," formula_results["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"outputs"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"]:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"            "),s("span",{style:{color:"#6272A4"}},"# 依次输出 标的代码, 指标值名称, 时间戳, 指标值列表")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"            "),s("span",{style:{color:"#8BE9FD"}},"print"),s("span",{style:{color:"#F8F8F2"}},"(s, k, formula_results["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"timelist"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"]["),s("span",{style:{color:"#FF79C6"}},"-"),s("span",{style:{color:"#BD93F9"}},"1"),s("span",{style:{color:"#F8F8F2"}},"],formula_results["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"outputs"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"][k]["),s("span",{style:{color:"#FF79C6"}},"-"),s("span",{style:{color:"#BD93F9"}},"5"),s("span",{style:{color:"#F8F8F2"}},":])")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"   ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    time.sleep("),s("span",{style:{color:"#BD93F9"}},"3"),s("span",{style:{color:"#F8F8F2"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),u=s("p",null,null,-1),b=s("div",{class:"language-vb line-numbers-mode","data-ext":"vb"},[s("pre",{class:"shiki dracula",style:{"background-color":"#282A36"},tabindex:"0"},[s("code",null,[s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"code:"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#6272A4"}},"''; // 标的代码，传空为主图标的")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"CO :"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#BD93F9"}},"0"),s("span",{style:{color:"#F8F8F2"}},"; // CO为坐标轴类型0交易日坐标1自然日2交易交易时间")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"p :"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#BD93F9"}},"-1"),s("span",{style:{color:"#F8F8F2"}},"; // 周期，传"),s("span",{style:{color:"#FF79C6"}},"-"),s("span",{style:{color:"#F8F8F2"}},"1为当前主图周期，具体值见STKINDI函数说明")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"ma1:"),s("span",{style:{color:"#50FA7B"}},"STKINDI"),s("span",{style:{color:"#F8F8F2"}},"(code,"),s("span",{style:{color:"#6272A4"}},"'ma.ma1',CO,p);  // 引用其他的指标，格式为 '指标名称.输出值名称'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"kdj_k:"),s("span",{style:{color:"#50FA7B"}},"STKINDI"),s("span",{style:{color:"#F8F8F2"}},"(code,"),s("span",{style:{color:"#6272A4"}},"'kdj.k',CO,p);  // 引用其他的指标，格式为 '指标名称.输出值名称'")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),v=s("h3",{id:"订阅vba指标实时计算结果",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#订阅vba指标实时计算结果","aria-hidden":"true"},"#"),l(" 订阅VBA指标实时计算结果")],-1),C=s("div",{class:"language-python line-numbers-mode","data-ext":"py"},[s("pre",{class:"shiki dracula",style:{"background-color":"#282A36"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"# coding:gbk")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FF79C6"}},"import"),s("span",{style:{color:"#F8F8F2"}}," time")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FF79C6"}},"from"),s("span",{style:{color:"#F8F8F2"}}," functools "),s("span",{style:{color:"#FF79C6"}},"import"),s("span",{style:{color:"#F8F8F2"}}," partial")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FF79C6"}},"import"),s("span",{style:{color:"#F8F8F2"}}," pandas "),s("span",{style:{color:"#FF79C6"}},"as"),s("span",{style:{color:"#F8F8F2"}}," pd")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FF79C6"}},"def"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#50FA7B"}},"callback"),s("span",{style:{color:"#F8F8F2"}},"("),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"s"),s("span",{style:{color:"#F8F8F2"}},", "),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"data"),s("span",{style:{color:"#F8F8F2"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#6272A4"}},"'''")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"    回调函数，展示结果")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"    data格式示例：")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"    {'dbt': 0, 'timelist': [1712592000000, 1712678400000], 'outputs': {'ma1': [nan, nan], 'ma2': [nan, nan], 'ma3': [nan, nan], 'ma4': [nan, nan]}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"    '''")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"   ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#6272A4"}},"# 转换时间戳")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    timelist "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," data["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"timelist"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"]["),s("span",{style:{color:"#FF79C6"}},"-"),s("span",{style:{color:"#BD93F9"}},"5"),s("span",{style:{color:"#F8F8F2"}},":]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    timelist_fmt "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," [timetag_to_datetime(t,"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"%Y%m"),s("span",{style:{color:"#BD93F9"}},"%d"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},") "),s("span",{style:{color:"#FF79C6"}},"for"),s("span",{style:{color:"#F8F8F2"}}," t "),s("span",{style:{color:"#FF79C6"}},"in"),s("span",{style:{color:"#F8F8F2"}}," timelist]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#FF79C6"}},"for"),s("span",{style:{color:"#F8F8F2"}}," index_name "),s("span",{style:{color:"#FF79C6"}},"in"),s("span",{style:{color:"#F8F8F2"}}," data["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"outputs"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"]:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        "),s("span",{style:{color:"#FF79C6"}},"for"),s("span",{style:{color:"#F8F8F2"}}," k, t, v "),s("span",{style:{color:"#FF79C6"}},"in"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#8BE9FD"}},"zip"),s("span",{style:{color:"#F8F8F2"}},"(timelist,timelist_fmt,data["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"outputs"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"][index_name]["),s("span",{style:{color:"#FF79C6"}},"-"),s("span",{style:{color:"#BD93F9"}},"5"),s("span",{style:{color:"#F8F8F2"}},":]):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"            "),s("span",{style:{color:"#6272A4"}},"# 依次输出 : 标的代码, 时间戳, 转换后的格式化时间, 指标值名称, 指标值值")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"            "),s("span",{style:{color:"#8BE9FD"}},"print"),s("span",{style:{color:"#F8F8F2"}},"(s, k, t, index_name, v)")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"# 初始化参数变量")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"stock_list    "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," ["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"000001.SZ"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"]    "),s("span",{style:{color:"#6272A4"}},"# 股票代码列表")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"formula_name  "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"  "),s("span",{style:{color:"#6272A4"}},"# VBA指标名称")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"period        "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"1d"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"  "),s("span",{style:{color:"#6272A4"}},"# 计算的数据周期")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"start_time    "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"''"),s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#6272A4"}},"# %Y%m%d 或%Y%m%d%H%M%S")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"end_time      "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"''"),s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#6272A4"}},"# %Y%m%d 或%Y%m%d%H%M%S")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"count         "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#FF79C6"}},"-"),s("span",{style:{color:"#BD93F9"}},"1"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#6272A4"}},"# 数据条数，-1为 时间区间内全部数据")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"dividend_type "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"front"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#6272A4"}},"# 复权方式，参考get_market_data_ex的复权种类")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"extend_param  "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," {"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA:N1"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},":"),s("span",{style:{color:"#BD93F9"}},"5"),s("span",{style:{color:"#F8F8F2"}},","),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA:N2"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},":"),s("span",{style:{color:"#BD93F9"}},"20"),s("span",{style:{color:"#F8F8F2"}},","),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA:N3"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},":"),s("span",{style:{color:"#BD93F9"}},"40"),s("span",{style:{color:"#F8F8F2"}},","),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA:N4"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},":"),s("span",{style:{color:"#BD93F9"}},"60"),s("span",{style:{color:"#F8F8F2"}},",} "),s("span",{style:{color:"#6272A4"}},"# MA指标中的参数，等同VBA编辑界面的参数设置中指定参数值")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FF79C6"}},"def"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#50FA7B"}},"after_init"),s("span",{style:{color:"#F8F8F2"}},"("),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"C"),s("span",{style:{color:"#F8F8F2"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#FF79C6"}},"for"),s("span",{style:{color:"#F8F8F2"}}," s "),s("span",{style:{color:"#FF79C6"}},"in"),s("span",{style:{color:"#F8F8F2"}}," stock_list:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        "),s("span",{style:{color:"#6272A4"}},"# 订阅该指标实时计算结果，并把结果传给回调函数")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        "),s("span",{style:{color:"#8BE9FD"}},"id"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," subscribe_formula(formula_name,s,period,start_time,end_time,"),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"count"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}},"count,"),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"extend_param"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}},"extend_param,"),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"callback"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," partial(callback, s))")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"                ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"            ")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),A=s("div",{class:"language-python line-numbers-mode","data-ext":"py"},[s("pre",{class:"shiki dracula",style:{"background-color":"#282A36"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FF79C6"}},"import"),s("span",{style:{color:"#F8F8F2"}}," time")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FF79C6"}},"from"),s("span",{style:{color:"#F8F8F2"}}," xtquant "),s("span",{style:{color:"#FF79C6"}},"import"),s("span",{style:{color:"#F8F8F2"}}," xtdata")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FF79C6"}},"from"),s("span",{style:{color:"#F8F8F2"}}," functools "),s("span",{style:{color:"#FF79C6"}},"import"),s("span",{style:{color:"#F8F8F2"}}," partial")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FF79C6"}},"import"),s("span",{style:{color:"#F8F8F2"}}," pandas "),s("span",{style:{color:"#FF79C6"}},"as"),s("span",{style:{color:"#F8F8F2"}}," pd")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"xtdata.connect("),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"port"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#BD93F9"}},"58612"),s("span",{style:{color:"#F8F8F2"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FF79C6"}},"def"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#50FA7B"}},"callback"),s("span",{style:{color:"#F8F8F2"}},"("),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"s"),s("span",{style:{color:"#F8F8F2"}},", "),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"data"),s("span",{style:{color:"#F8F8F2"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#6272A4"}},"'''")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"    回调函数，展示结果")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"    data格式示例：")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"    {'dbt': 0, 'timelist': [1712592000000, 1712678400000], 'outputs': {'ma1': [nan, nan], 'ma2': [nan, nan], 'ma3': [nan, nan], 'ma4': [nan, nan]}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"    '''")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"   ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#6272A4"}},"# 转换时间戳")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    timelist "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," data["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"timelist"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"]["),s("span",{style:{color:"#FF79C6"}},"-"),s("span",{style:{color:"#BD93F9"}},"5"),s("span",{style:{color:"#F8F8F2"}},":]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    timelist_fmt "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," [xtdata.timetag_to_datetime(t,"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"%Y%m"),s("span",{style:{color:"#BD93F9"}},"%d"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},") "),s("span",{style:{color:"#FF79C6"}},"for"),s("span",{style:{color:"#F8F8F2"}}," t "),s("span",{style:{color:"#FF79C6"}},"in"),s("span",{style:{color:"#F8F8F2"}}," timelist]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#FF79C6"}},"for"),s("span",{style:{color:"#F8F8F2"}}," index_name "),s("span",{style:{color:"#FF79C6"}},"in"),s("span",{style:{color:"#F8F8F2"}}," data["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"outputs"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"]:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"        "),s("span",{style:{color:"#FF79C6"}},"for"),s("span",{style:{color:"#F8F8F2"}}," k, t, v "),s("span",{style:{color:"#FF79C6"}},"in"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#8BE9FD"}},"zip"),s("span",{style:{color:"#F8F8F2"}},"(timelist,timelist_fmt,data["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"outputs"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"][index_name]["),s("span",{style:{color:"#FF79C6"}},"-"),s("span",{style:{color:"#BD93F9"}},"5"),s("span",{style:{color:"#F8F8F2"}},":]):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"            "),s("span",{style:{color:"#6272A4"}},"# 依次输出 : 标的代码, 时间戳, 转换后的格式化时间, 指标值名称, 指标值值")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"            "),s("span",{style:{color:"#8BE9FD"}},"print"),s("span",{style:{color:"#F8F8F2"}},"(s, k, t, index_name, v)")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6272A4"}},"# 初始化参数变量")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"stock_list    "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," ["),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"000001.SZ"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"]    "),s("span",{style:{color:"#6272A4"}},"# 股票代码列表")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"formula_name  "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"  "),s("span",{style:{color:"#6272A4"}},"# VBA指标名称")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"period        "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"1d"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},"  "),s("span",{style:{color:"#6272A4"}},"# 计算的数据周期")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"start_time    "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"''"),s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#6272A4"}},"# %Y%m%d 或%Y%m%d%H%M%S")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"end_time      "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"''"),s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#6272A4"}},"# %Y%m%d 或%Y%m%d%H%M%S")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"count         "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#FF79C6"}},"-"),s("span",{style:{color:"#BD93F9"}},"1"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#6272A4"}},"# 数据条数，-1为 时间区间内全部数据")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"dividend_type "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"front"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#6272A4"}},"# 复权方式，参考get_market_data_ex的复权种类")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"extend_param  "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," {"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA:N1"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},":"),s("span",{style:{color:"#BD93F9"}},"5"),s("span",{style:{color:"#F8F8F2"}},","),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA:N2"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},":"),s("span",{style:{color:"#BD93F9"}},"20"),s("span",{style:{color:"#F8F8F2"}},","),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA:N3"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},":"),s("span",{style:{color:"#BD93F9"}},"40"),s("span",{style:{color:"#F8F8F2"}},","),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F1FA8C"}},"MA:N4"),s("span",{style:{color:"#E9F284"}},"'"),s("span",{style:{color:"#F8F8F2"}},":"),s("span",{style:{color:"#BD93F9"}},"60"),s("span",{style:{color:"#F8F8F2"}},",} "),s("span",{style:{color:"#6272A4"}},"# MA指标中的参数，等同VBA编辑界面的参数设置中指定参数值")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FF79C6"}},"for"),s("span",{style:{color:"#F8F8F2"}}," s "),s("span",{style:{color:"#FF79C6"}},"in"),s("span",{style:{color:"#F8F8F2"}}," stock_list:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#6272A4"}},"# 订阅该指标实时计算结果，并把结果传给回调函数")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"    "),s("span",{style:{color:"#8BE9FD"}},"id"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," xtdata.subscribe_formula(formula_name,s,period,start_time,end_time,"),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"count"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}},"count,"),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"extend_param"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}},"extend_param,"),s("span",{style:{color:"#FFB86C","font-style":"italic"}},"callback"),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," partial(callback, s))")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),_=s("p",null,null,-1),E=s("div",{class:"language-vb line-numbers-mode","data-ext":"vb"},[s("pre",{class:"shiki dracula",style:{"background-color":"#282A36"},tabindex:"0"},[s("code",null,[s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"code:"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#6272A4"}},"''; // 标的代码，传空为主图标的")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"CO :"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#BD93F9"}},"0"),s("span",{style:{color:"#F8F8F2"}},"; // CO为坐标轴类型0交易日坐标1自然日2交易交易时间")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"p :"),s("span",{style:{color:"#FF79C6"}},"="),s("span",{style:{color:"#F8F8F2"}}," "),s("span",{style:{color:"#BD93F9"}},"-1"),s("span",{style:{color:"#F8F8F2"}},"; // 周期，传"),s("span",{style:{color:"#FF79C6"}},"-"),s("span",{style:{color:"#F8F8F2"}},"1为当前主图周期，具体值见STKINDI函数说明")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"ma1:"),s("span",{style:{color:"#50FA7B"}},"STKINDI"),s("span",{style:{color:"#F8F8F2"}},"(code,"),s("span",{style:{color:"#6272A4"}},"'ma.ma1',CO,p);  // 引用其他的指标，格式为 '指标名称.输出值名称'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F8F8F2"}},"kdj_k:"),s("span",{style:{color:"#50FA7B"}},"STKINDI"),s("span",{style:{color:"#F8F8F2"}},"(code,"),s("span",{style:{color:"#6272A4"}},"'kdj.k',CO,p);  // 引用其他的指标，格式为 '指标名称.输出值名称'")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1);function B(f,k){const a=t("Tabs");return r(),p("div",null,[y,F(a,{id:"3",data:[{id:"内置python"},{id:"原生python"},{id:"VBA指标相互引用"}]},{title0:n(({value:o,isActive:e})=>[l("内置python")]),title1:n(({value:o,isActive:e})=>[l("原生python")]),title2:n(({value:o,isActive:e})=>[l("VBA指标相互引用")]),tab0:n(({value:o,isActive:e})=>[d]),tab1:n(({value:o,isActive:e})=>[m,u]),tab2:n(({value:o,isActive:e})=>[b]),_:1}),v,F(a,{id:"20",data:[{id:"内置python"},{id:"原生python"},{id:"VBA指标相互引用"}]},{title0:n(({value:o,isActive:e})=>[l("内置python")]),title1:n(({value:o,isActive:e})=>[l("原生python")]),title2:n(({value:o,isActive:e})=>[l("VBA指标相互引用")]),tab0:n(({value:o,isActive:e})=>[C]),tab1:n(({value:o,isActive:e})=>[A,_]),tab2:n(({value:o,isActive:e})=>[E]),_:1})])}const h=c(i,[["render",B],["__file","python调用VBA.html.vue"]]);export{h as default};
