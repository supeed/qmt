
<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.67">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    
	<title>完整示例</title><meta name="description" content="QMT说明, QMT-Python-API, QMT用户手册。">
    <link rel="preload" href="../assets/style-8436f03b.css" as="style"><link rel="stylesheet" href="../assets/style-8436f03b.css">
    <link rel="modulepreload" href="../assets/app-99722cb8.js"><link rel="modulepreload" href="../assets/code_examples.html-aa1deec9.js"><link rel="modulepreload" href="../assets/code_examples.html-985b4984.js"><link rel="prefetch" href="../assets/index.html-93a0007d.js" as="script"><link rel="prefetch" href="../assets/basic_syntax.html-e393df56.js" as="script"><link rel="prefetch" href="../assets/check_sheet.html-a405c8a3.js" as="script"><link rel="prefetch" href="../assets/control_statement.html-bf992bd7.js" as="script"><link rel="prefetch" href="../assets/operating_mode.html-a2f39c1a.js" as="script"><link rel="prefetch" href="../assets/start_now.html-1be21f8a.js" as="script"><link rel="prefetch" href="../assets/system_function.html-49a65798.js" as="script"><link rel="prefetch" href="../assets/index.html-179668eb.js" as="script"><link rel="prefetch" href="../assets/bond.html-d9c1be0d.js" as="script"><link rel="prefetch" href="../assets/floorfunds.html-8810bed2.js" as="script"><link rel="prefetch" href="../assets/future.html-8c1c26b7.js" as="script"><link rel="prefetch" href="../assets/indexes.html-ec6ecef0.js" as="script"><link rel="prefetch" href="../assets/industry.html-cffc4e77.js" as="script"><link rel="prefetch" href="../assets/option.html-1d25e189.js" as="script"><link rel="prefetch" href="../assets/question_answer.html-bed5ae76.js" as="script"><link rel="prefetch" href="../assets/stock.html-035c3630.js" as="script"><link rel="prefetch" href="../assets/python调用VBA.html-e92f2331.js" as="script"><link rel="prefetch" href="../assets/全市场涨跌幅度统计.html-b8ba35f1.js" as="script"><link rel="prefetch" href="../assets/全市场资金流向.html-3bd359eb.js" as="script"><link rel="prefetch" href="../assets/北向资金.html-c14449da.js" as="script"><link rel="prefetch" href="../assets/南向资金.html-ed8f1d67.js" as="script"><link rel="prefetch" href="../assets/外盘_内盘.html-f9f023d3.js" as="script"><link rel="prefetch" href="../assets/多空对比.html-a634bb69.js" as="script"><link rel="prefetch" href="../assets/委买价_委卖价_委买量_委卖量.html-e791f06d.js" as="script"><link rel="prefetch" href="../assets/总市值.html-54cae4e7.js" as="script"><link rel="prefetch" href="../assets/总股本_涨停_跌停.html-9495eb6a.js" as="script"><link rel="prefetch" href="../assets/换手.html-396e0a2d.js" as="script"><link rel="prefetch" href="../assets/最新_今开_最高_最低_总额_总手_交易状态.html-1ae0fd22.js" as="script"><link rel="prefetch" href="../assets/注册资本.html-061f0b8d.js" as="script"><link rel="prefetch" href="../assets/流通盘.html-26dbb5b3.js" as="script"><link rel="prefetch" href="../assets/涨跌_涨幅.html-c4201ae4.js" as="script"><link rel="prefetch" href="../assets/涨跌家数变化.html-a30316a7.js" as="script"><link rel="prefetch" href="../assets/规模风向标.html-d7dc3f5e.js" as="script"><link rel="prefetch" href="../assets/量比.html-ca6f9a2e.js" as="script"><link rel="prefetch" href="../assets/rookie.html-df76d0ad.js" as="script"><link rel="prefetch" href="../assets/code_examples.html-f1708e88.js" as="script"><link rel="prefetch" href="../assets/download_xtquant.html-337a4246.js" as="script"><link rel="prefetch" href="../assets/question_function.html-92b003d3.js" as="script"><link rel="prefetch" href="../assets/start_now.html-b45a357d.js" as="script"><link rel="prefetch" href="../assets/xtdata.html-97c855c0.js" as="script"><link rel="prefetch" href="../assets/xttrader.html-cb4abe04.js" as="script"><link rel="prefetch" href="../assets/callback_function.html-4153be6c.js" as="script"><link rel="prefetch" href="../assets/code_examples.html-c1ae1001.js" as="script"><link rel="prefetch" href="../assets/data_function.html-2411bf01.js" as="script"><link rel="prefetch" href="../assets/data_structure.html-a96a202d.js" as="script"><link rel="prefetch" href="../assets/drawing_function.html-dee669df.js" as="script"><link rel="prefetch" href="../assets/enum_constants.html-2c1f6dcc.js" as="script"><link rel="prefetch" href="../assets/interface_operation.html-47a2cf15.js" as="script"><link rel="prefetch" href="../assets/question_answer.html-4f12deae.js" as="script"><link rel="prefetch" href="../assets/quote_function.html-827e9fb8.js" as="script"><link rel="prefetch" href="../assets/related_instructions.html-9b630c20.js" as="script"><link rel="prefetch" href="../assets/start_now.html-79f8f415.js" as="script"><link rel="prefetch" href="../assets/system_function.html-03a1dc3a.js" as="script"><link rel="prefetch" href="../assets/trading_function.html-3c0f4ee8.js" as="script"><link rel="prefetch" href="../assets/user_attention.html-e0d27a96.js" as="script"><link rel="prefetch" href="../assets/variable_convention.html-17caf0d6.js" as="script"><link rel="prefetch" href="../assets/JoinQuant2QMT.html-38cb9974.js" as="script"><link rel="prefetch" href="../assets/index.html-22b6b31a.js" as="script"><link rel="prefetch" href="../assets/daoru_daochu.html-c8cace75.js" as="script"><link rel="prefetch" href="../assets/hangqing_setting.html-1a9570b3.js" as="script"><link rel="prefetch" href="../assets/ty_add_indicator.html-1f2f4b0a.js" as="script"><link rel="prefetch" href="../assets/ty_backtest_strategy.html-270aeeab.js" as="script"><link rel="prefetch" href="../assets/ty_code_review_backtest.html-200ceddd.js" as="script"><link rel="prefetch" href="../assets/ty_content.html-bac1ad25.js" as="script"><link rel="prefetch" href="../assets/ty_data_download.html-351b4a4f.js" as="script"><link rel="prefetch" href="../assets/ty_data_interface.html-2e32a98a.js" as="script"><link rel="prefetch" href="../assets/ty_direct_connect.html-f8b10f83.js" as="script"><link rel="prefetch" href="../assets/ty_factor_data.html-1746bcaa.js" as="script"><link rel="prefetch" href="../assets/ty_linux_xtquant_data.html-44bf60fb.js" as="script"><link rel="prefetch" href="../assets/ty_native_python.html-8028f714.js" as="script"><link rel="prefetch" href="../assets/ty_register_install.html-0d2c078f.js" as="script"><link rel="prefetch" href="../assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="../assets/index.html-23445d95.js" as="script"><link rel="prefetch" href="../assets/basic_syntax.html-5af886ee.js" as="script"><link rel="prefetch" href="../assets/check_sheet.html-5184a806.js" as="script"><link rel="prefetch" href="../assets/control_statement.html-3b20a2b9.js" as="script"><link rel="prefetch" href="../assets/operating_mode.html-fd0ec393.js" as="script"><link rel="prefetch" href="../assets/start_now.html-bdc1834b.js" as="script"><link rel="prefetch" href="../assets/system_function.html-4f0942d4.js" as="script"><link rel="prefetch" href="../assets/index.html-a0cb365e.js" as="script"><link rel="prefetch" href="../assets/bond.html-7a63f47e.js" as="script"><link rel="prefetch" href="../assets/floorfunds.html-9746e82a.js" as="script"><link rel="prefetch" href="../assets/future.html-dff59680.js" as="script"><link rel="prefetch" href="../assets/indexes.html-f0ffc2ed.js" as="script"><link rel="prefetch" href="../assets/industry.html-6c37727a.js" as="script"><link rel="prefetch" href="../assets/option.html-bc239cdd.js" as="script"><link rel="prefetch" href="../assets/question_answer.html-eb13f2ba.js" as="script"><link rel="prefetch" href="../assets/stock.html-5b93fe23.js" as="script"><link rel="prefetch" href="../assets/python调用VBA.html-f3232163.js" as="script"><link rel="prefetch" href="../assets/全市场涨跌幅度统计.html-0615d22a.js" as="script"><link rel="prefetch" href="../assets/全市场资金流向.html-0e599d6b.js" as="script"><link rel="prefetch" href="../assets/北向资金.html-dabcf598.js" as="script"><link rel="prefetch" href="../assets/南向资金.html-dbd875ea.js" as="script"><link rel="prefetch" href="../assets/外盘_内盘.html-5f883999.js" as="script"><link rel="prefetch" href="../assets/多空对比.html-11c1c488.js" as="script"><link rel="prefetch" href="../assets/委买价_委卖价_委买量_委卖量.html-0df576f7.js" as="script"><link rel="prefetch" href="../assets/总市值.html-e1af9791.js" as="script"><link rel="prefetch" href="../assets/总股本_涨停_跌停.html-41245f1b.js" as="script"><link rel="prefetch" href="../assets/换手.html-2811be82.js" as="script"><link rel="prefetch" href="../assets/最新_今开_最高_最低_总额_总手_交易状态.html-b756ceca.js" as="script"><link rel="prefetch" href="../assets/注册资本.html-049b932e.js" as="script"><link rel="prefetch" href="../assets/流通盘.html-e48d17b3.js" as="script"><link rel="prefetch" href="../assets/涨跌_涨幅.html-c49f09e7.js" as="script"><link rel="prefetch" href="../assets/涨跌家数变化.html-b0a2702d.js" as="script"><link rel="prefetch" href="../assets/规模风向标.html-8caa0565.js" as="script"><link rel="prefetch" href="../assets/量比.html-13e416e5.js" as="script"><link rel="prefetch" href="../assets/rookie.html-e305c3cb.js" as="script"><link rel="prefetch" href="../assets/code_examples.html-37f2c141.js" as="script"><link rel="prefetch" href="../assets/download_xtquant.html-7a7ee88f.js" as="script"><link rel="prefetch" href="../assets/question_function.html-437cccea.js" as="script"><link rel="prefetch" href="../assets/start_now.html-01155b75.js" as="script"><link rel="prefetch" href="../assets/xtdata.html-1e0a07b7.js" as="script"><link rel="prefetch" href="../assets/xttrader.html-ed1b1fe5.js" as="script"><link rel="prefetch" href="../assets/callback_function.html-a1ef7560.js" as="script"><link rel="prefetch" href="../assets/code_examples.html-8a240771.js" as="script"><link rel="prefetch" href="../assets/data_function.html-94c8c7e6.js" as="script"><link rel="prefetch" href="../assets/data_structure.html-47f36229.js" as="script"><link rel="prefetch" href="../assets/drawing_function.html-ad741397.js" as="script"><link rel="prefetch" href="../assets/enum_constants.html-6a4d27a4.js" as="script"><link rel="prefetch" href="../assets/interface_operation.html-9b7579d2.js" as="script"><link rel="prefetch" href="../assets/question_answer.html-15175a6b.js" as="script"><link rel="prefetch" href="../assets/quote_function.html-86d4ef78.js" as="script"><link rel="prefetch" href="../assets/related_instructions.html-b4f87603.js" as="script"><link rel="prefetch" href="../assets/start_now.html-d25bd7fe.js" as="script"><link rel="prefetch" href="../assets/system_function.html-b5032370.js" as="script"><link rel="prefetch" href="../assets/trading_function.html-51206dd7.js" as="script"><link rel="prefetch" href="../assets/user_attention.html-d2df5640.js" as="script"><link rel="prefetch" href="../assets/variable_convention.html-8bcc5c5f.js" as="script"><link rel="prefetch" href="../assets/JoinQuant2QMT.html-5a5867f6.js" as="script"><link rel="prefetch" href="../assets/index.html-925d7c12.js" as="script"><link rel="prefetch" href="../assets/daoru_daochu.html-9feb8edf.js" as="script"><link rel="prefetch" href="../assets/hangqing_setting.html-6f4f36fa.js" as="script"><link rel="prefetch" href="../assets/ty_add_indicator.html-ab4dcef5.js" as="script"><link rel="prefetch" href="../assets/ty_backtest_strategy.html-3da9fb3c.js" as="script"><link rel="prefetch" href="../assets/ty_code_review_backtest.html-bc72c419.js" as="script"><link rel="prefetch" href="../assets/ty_content.html-93b129b3.js" as="script"><link rel="prefetch" href="../assets/ty_data_download.html-6381aec1.js" as="script"><link rel="prefetch" href="../assets/ty_data_interface.html-2a716790.js" as="script"><link rel="prefetch" href="../assets/ty_direct_connect.html-b63051ab.js" as="script"><link rel="prefetch" href="../assets/ty_factor_data.html-5f08c397.js" as="script"><link rel="prefetch" href="../assets/ty_linux_xtquant_data.html-bf571773.js" as="script"><link rel="prefetch" href="../assets/ty_native_python.html-264f76d4.js" as="script"><link rel="prefetch" href="../assets/ty_register_install.html-cfe8e155.js" as="script"><link rel="prefetch" href="../assets/404.html-a36e0f1a.js" as="script"><link rel="prefetch" href="../assets/SearchBox-a1914cb6.js" as="script"><link rel="prefetch" href="../assets/auto-6adc87e8.js" as="script"><link rel="prefetch" href="../assets/index-2bf332f6.js" as="script"><link rel="prefetch" href="../assets/flowchart-c441f34d.js" as="script"><link rel="prefetch" href="../assets/SignPanel-39d95e93.js" as="script"><link rel="prefetch" href="../assets/SignPanel-39d95e93.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[-->
	
	<aside class="sidebar">
	
	<ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">VBA <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="../VBA/start_now.html" class="sidebar-item" aria-label="快速开始"><!--[--><!--]--> 快速开始 <!--[--><!--]--></a><!----></li><li><a href="../VBA/basic_syntax.html" class="sidebar-item" aria-label="基础语法"><!--[--><!--]--> 基础语法 <!--[--><!--]--></a><!----></li><li><a href="../VBA/control_statement.html" class="sidebar-item" aria-label="控制语句"><!--[--><!--]--> 控制语句 <!--[--><!--]--></a><!----></li><li><a href="../VBA/operating_mode.html" class="sidebar-item" aria-label="运行机制"><!--[--><!--]--> 运行机制 <!--[--><!--]--></a><!----></li><li><a href="../VBA/system_function.html" class="sidebar-item" aria-label="系统函数"><!--[--><!--]--> 系统函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/code_examples.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="完整示例"><!--[--><!--]--> 完整示例 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="../VBA/code_examples.html#行情示例" class="router-link-active router-link-exact-active sidebar-item" aria-label="行情示例"><!--[--><!--]--> 行情示例 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/code_examples.html#_1-vba模式获取涨停股" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.VBA模式获取涨停股"><!--[--><!--]--> 1.VBA模式获取涨停股 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/code_examples.html#_2-如何获取连续放量标的" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.如何获取连续放量标的"><!--[--><!--]--> 2.如何获取连续放量标的 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/code_examples.html#_3-macd背离模型" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.MACD背离模型"><!--[--><!--]--> 3.MACD背离模型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/code_examples.html#_4-如何在日内分钟级别实现《菲阿里四价》判断" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.如何在日内分钟级别实现《菲阿里四价》判断"><!--[--><!--]--> 4.如何在日内分钟级别实现《菲阿里四价》判断 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/code_examples.html#回测示例" class="router-link-active router-link-exact-active sidebar-item" aria-label="回测示例"><!--[--><!--]--> 回测示例 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="../VBA/code_examples.html#单股回测模型a" class="router-link-active router-link-exact-active sidebar-item" aria-label="单股回测模型A"><!--[--><!--]--> 单股回测模型A <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/code_examples.html#单股回测模型b" class="router-link-active router-link-exact-active sidebar-item" aria-label="单股回测模型B"><!--[--><!--]--> 单股回测模型B <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page" data-v-3c904194><!--[--><!--]--><div class="theme-default-contents" data-v-3c904194><!----><!--[--><!--]--><div class="theme-default-content" data-v-3c904194><div data-v-3c904194><h2 id="行情示例" tabindex="-1"><a class="header-anchor" href="#行情示例" aria-hidden="true">#</a> 行情示例</h2><h2 id="_1-vba模式获取涨停股" tabindex="-1"><a class="header-anchor" href="#_1-vba模式获取涨停股" aria-hidden="true">#</a> 1.VBA模式获取涨停股</h2><p>本示例用于获取某列表涨停股。 <br>示例</p><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">stocktype:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">INBLOCK</span><span style="color:#F8F8F2;">(</span><span style="color:#6272A4;">&#39;创业板&#39;) or INBLOCK(&#39;科创板&#39;);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">lastprice:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">ref</span><span style="color:#F8F8F2;">(c,</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">ZT:</span><span style="color:#FF79C6;">IF</span><span style="color:#F8F8F2;">(stocktype,</span><span style="color:#50FA7B;">ROUNDS</span><span style="color:#F8F8F2;">(lastprice</span><span style="color:#FF79C6;">*</span><span style="color:#BD93F9;">1.2</span><span style="color:#F8F8F2;">,</span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;">)</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">close,</span><span style="color:#50FA7B;">ROUNDS</span><span style="color:#F8F8F2;">(lastprice</span><span style="color:#FF79C6;">*</span><span style="color:#BD93F9;">1.1</span><span style="color:#F8F8F2;">,</span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;">)</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">close);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-如何获取连续放量标的" tabindex="-1"><a class="header-anchor" href="#_2-如何获取连续放量标的" aria-hidden="true">#</a> 2.如何获取连续放量标的</h2><p>本示例用于获取连续放量标的。 <br>示例</p><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">B:</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">VOL</span><span style="color:#FF79C6;">&gt;</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(VOL,</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">UPVOL:</span><span style="color:#50FA7B;">COUNT</span><span style="color:#F8F8F2;">(B,M)</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">M;//持续M个周期放量</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-macd背离模型" tabindex="-1"><a class="header-anchor" href="#_3-macd背离模型" aria-hidden="true">#</a> 3.MACD背离模型</h2><p>在相应股票上,建立MACD背离模型，以指标背离作为入场或出出场参考。 <br>示例</p><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">//…………MACD指标计算…………</span></span>
<span class="line"><span style="color:#F8F8F2;">DIFF:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">EMA</span><span style="color:#F8F8F2;">(CLOSE,</span><span style="color:#BD93F9;">12</span><span style="color:#F8F8F2;">)</span><span style="color:#FF79C6;">-</span><span style="color:#50FA7B;">EMA</span><span style="color:#F8F8F2;">(CLOSE,</span><span style="color:#BD93F9;">26</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F8F8F2;">DEA:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">EMA</span><span style="color:#F8F8F2;">(DIFF,</span><span style="color:#BD93F9;">9</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F8F8F2;">MACD:</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">2</span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;">(DIFF</span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;">DEA),COLORSTICK;</span></span>
<span class="line"><span style="color:#F8F8F2;">//……………………………………………………</span></span>
<span class="line"><span style="color:#F8F8F2;">N:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">BARSLAST</span><span style="color:#F8F8F2;">(</span><span style="color:#50FA7B;">CROSS</span><span style="color:#F8F8F2;">(DIFF,DEA))</span><span style="color:#FF79C6;">+</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">N1:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">BARSLAST</span><span style="color:#F8F8F2;">(</span><span style="color:#50FA7B;">CROSS</span><span style="color:#F8F8F2;">(DEA,DIFF))</span><span style="color:#FF79C6;">+</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">DIFF1:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(DIFF,N</span><span style="color:#BD93F9;">-1</span><span style="color:#F8F8F2;">),</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F8F8F2;">DIFF2:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(DIFF,N1</span><span style="color:#BD93F9;">-1</span><span style="color:#F8F8F2;">),</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F8F8F2;">C1:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(C,N</span><span style="color:#BD93F9;">-1</span><span style="color:#F8F8F2;">),</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F8F8F2;">C2:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(</span><span style="color:#50FA7B;">REF</span><span style="color:#F8F8F2;">(C,N1</span><span style="color:#BD93F9;">-1</span><span style="color:#F8F8F2;">),</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F8F8F2;">DBL1:DIFF</span><span style="color:#FF79C6;">&gt;</span><span style="color:#F8F8F2;">DIFF1 </span><span style="color:#FF79C6;">AND</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">CROSS</span><span style="color:#F8F8F2;">(DIFF,DEA) </span><span style="color:#FF79C6;">AND</span><span style="color:#F8F8F2;"> C</span><span style="color:#FF79C6;">&lt;</span><span style="color:#F8F8F2;">C1; //底背离</span></span>
<span class="line"><span style="color:#F8F8F2;">DBL:DIFF</span><span style="color:#FF79C6;">&lt;</span><span style="color:#F8F8F2;">DIFF2 </span><span style="color:#FF79C6;">AND</span><span style="color:#F8F8F2;">  </span><span style="color:#50FA7B;">CROSS</span><span style="color:#F8F8F2;">(DEA,DIFF) </span><span style="color:#FF79C6;">AND</span><span style="color:#F8F8F2;"> C</span><span style="color:#FF79C6;">&gt;</span><span style="color:#F8F8F2;">C2; //顶背离</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-如何在日内分钟级别实现《菲阿里四价》判断" tabindex="-1"><a class="header-anchor" href="#_4-如何在日内分钟级别实现《菲阿里四价》判断" aria-hidden="true">#</a> 4.如何在日内分钟级别实现《菲阿里四价》判断</h2><details class="custom-container details"><summary>什么是菲阿里四价？</summary><p>昨天高点、昨天低点、昨日收盘价、今天开盘价，可并称为菲阿里四价。它由日本期货冠军菲阿里实盘采用的主要突破交易参照系统。 <br>主要特点： 日内交易策略，收盘平仓； <br> 上轨＝昨日高点； <br> 下轨＝昨日低点；</p></details><div class="custom-container tip"><p class="custom-container-title">核心点</p><p>实现该指标的核心在于跨周期引用数据，可以使用CALLSTOCK函数。</p></div><details class="custom-container details"><summary>用法</summary><p>CALLSTOCK(CODE,TYPE[,CYC,N]),引用指定品种代码为 CODE,周期为 CYC(可选)若不填或者为-1 表示使用当前周期,类型为 TYPE 的数据<br>N 为左右偏移周期个数（可选）0 表示引用当前数据，&lt;0 为引用之前数据，&gt;0为引用之后数据。<br>其中 TYPE 的值可为 VTOPEN(开盘) VTHIGH(最高) VTLOW(最低) VTCLOSE(收盘)<br>VTVOL(成交量) VTAMOUNT(成交额) vtOPENINT(持仓量) VTADVANCE(涨数,大盘有效) VTDECLINE(跌数,大盘有效)以及外部数据和万德数据<br>如果找不到同期数据，那么将返回最近的一个。<br>CYC 范围为 0-19，分别表示<br>0:分笔成交、1:1 分钟、2:5 分钟、3:15 分钟、4:30 分钟、5:60 分钟<br>6:日、7:周、8:月、9:年、10:多日、11:多分钟、12:多秒<br>13:多小时、14:季度线、15:半年线、16:节气线、17:3 分钟、18:10 分钟、19:多笔线<br><br> <code>注意</code>引用数据时，需要确认被引用品种周期数据齐全，在首次使用或者在不确定时，请手工进行数据补充工作；</p></details><p>示例</p><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">昨高:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">callstock</span><span style="color:#F8F8F2;">(</span><span style="color:#6272A4;">&#39;&#39;,vthigh,6,-1);//获取当前主图标的昨高</span></span>
<span class="line"><span style="color:#F8F8F2;">昨低:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">callstock</span><span style="color:#F8F8F2;">(</span><span style="color:#6272A4;">&#39;&#39;,vtlow,6,-1);//获取当前主图标的昨低</span></span>
<span class="line"><span style="color:#F8F8F2;">昨收:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">callstock</span><span style="color:#F8F8F2;">(</span><span style="color:#6272A4;">&#39;&#39;,vtclose,6,-1);//获取当前主图标的昨收</span></span>
<span class="line"><span style="color:#F8F8F2;">上轨:昨高;</span></span>
<span class="line"><span style="color:#F8F8F2;">下轨:昨低;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="回测示例" tabindex="-1"><a class="header-anchor" href="#回测示例" aria-hidden="true">#</a> 回测示例</h2><h3 id="单股回测模型a" tabindex="-1"><a class="header-anchor" href="#单股回测模型a" aria-hidden="true">#</a> 单股回测模型A</h3><p>参见默认脚本<code>单股回测模型A</code></p><h3 id="单股回测模型b" tabindex="-1"><a class="header-anchor" href="#单股回测模型b" aria-hidden="true">#</a> 单股回测模型B</h3><p>参见默认脚本<code>单股回测模型B</code></p></div></div><!--[--><!--]--></div>

<nav class="page-nav" data-v-3c904194><p class="inner"><span class="prev"><a href="../VBA/system_function.html" class="" aria-label="系统函数"><!--[--><!--]--> 系统函数 <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>

  <div class="toFixedCopy wxFixed" style="text-align: center"><a href="https://work.weixin.qq.com/ca/cawcde1dc261ca71f1" target="_blank" rel="noopener noreferrer">联系微信获取权限<br><img src="../assets/联系客户经理.png" alt="微信扫码联系客服" title="点击联系客服" style="width:150px;"></a></div></body>
</html>
