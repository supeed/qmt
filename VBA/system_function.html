
<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.67">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    
	<title>系统函数</title><meta name="description" content="QMT说明, QMT-Python-API, QMT用户手册。">
    <link rel="preload" href="../assets/style-8436f03b.css" as="style"><link rel="stylesheet" href="../assets/style-8436f03b.css">
    <link rel="modulepreload" href="../assets/app-99722cb8.js"><link rel="modulepreload" href="../assets/system_function.html-49a65798.js"><link rel="modulepreload" href="../assets/system_function.html-4f0942d4.js"><link rel="prefetch" href="../assets/index.html-93a0007d.js" as="script"><link rel="prefetch" href="../assets/basic_syntax.html-e393df56.js" as="script"><link rel="prefetch" href="../assets/check_sheet.html-a405c8a3.js" as="script"><link rel="prefetch" href="../assets/code_examples.html-985b4984.js" as="script"><link rel="prefetch" href="../assets/control_statement.html-bf992bd7.js" as="script"><link rel="prefetch" href="../assets/operating_mode.html-a2f39c1a.js" as="script"><link rel="prefetch" href="../assets/start_now.html-1be21f8a.js" as="script"><link rel="prefetch" href="../assets/index.html-179668eb.js" as="script"><link rel="prefetch" href="../assets/bond.html-d9c1be0d.js" as="script"><link rel="prefetch" href="../assets/floorfunds.html-8810bed2.js" as="script"><link rel="prefetch" href="../assets/future.html-8c1c26b7.js" as="script"><link rel="prefetch" href="../assets/indexes.html-ec6ecef0.js" as="script"><link rel="prefetch" href="../assets/industry.html-cffc4e77.js" as="script"><link rel="prefetch" href="../assets/option.html-1d25e189.js" as="script"><link rel="prefetch" href="../assets/question_answer.html-bed5ae76.js" as="script"><link rel="prefetch" href="../assets/stock.html-035c3630.js" as="script"><link rel="prefetch" href="../assets/python调用VBA.html-e92f2331.js" as="script"><link rel="prefetch" href="../assets/全市场涨跌幅度统计.html-b8ba35f1.js" as="script"><link rel="prefetch" href="../assets/全市场资金流向.html-3bd359eb.js" as="script"><link rel="prefetch" href="../assets/北向资金.html-c14449da.js" as="script"><link rel="prefetch" href="../assets/南向资金.html-ed8f1d67.js" as="script"><link rel="prefetch" href="../assets/外盘_内盘.html-f9f023d3.js" as="script"><link rel="prefetch" href="../assets/多空对比.html-a634bb69.js" as="script"><link rel="prefetch" href="../assets/委买价_委卖价_委买量_委卖量.html-e791f06d.js" as="script"><link rel="prefetch" href="../assets/总市值.html-54cae4e7.js" as="script"><link rel="prefetch" href="../assets/总股本_涨停_跌停.html-9495eb6a.js" as="script"><link rel="prefetch" href="../assets/换手.html-396e0a2d.js" as="script"><link rel="prefetch" href="../assets/最新_今开_最高_最低_总额_总手_交易状态.html-1ae0fd22.js" as="script"><link rel="prefetch" href="../assets/注册资本.html-061f0b8d.js" as="script"><link rel="prefetch" href="../assets/流通盘.html-26dbb5b3.js" as="script"><link rel="prefetch" href="../assets/涨跌_涨幅.html-c4201ae4.js" as="script"><link rel="prefetch" href="../assets/涨跌家数变化.html-a30316a7.js" as="script"><link rel="prefetch" href="../assets/规模风向标.html-d7dc3f5e.js" as="script"><link rel="prefetch" href="../assets/量比.html-ca6f9a2e.js" as="script"><link rel="prefetch" href="../assets/rookie.html-df76d0ad.js" as="script"><link rel="prefetch" href="../assets/code_examples.html-f1708e88.js" as="script"><link rel="prefetch" href="../assets/download_xtquant.html-337a4246.js" as="script"><link rel="prefetch" href="../assets/question_function.html-92b003d3.js" as="script"><link rel="prefetch" href="../assets/start_now.html-b45a357d.js" as="script"><link rel="prefetch" href="../assets/xtdata.html-97c855c0.js" as="script"><link rel="prefetch" href="../assets/xttrader.html-cb4abe04.js" as="script"><link rel="prefetch" href="../assets/callback_function.html-4153be6c.js" as="script"><link rel="prefetch" href="../assets/code_examples.html-c1ae1001.js" as="script"><link rel="prefetch" href="../assets/data_function.html-2411bf01.js" as="script"><link rel="prefetch" href="../assets/data_structure.html-a96a202d.js" as="script"><link rel="prefetch" href="../assets/drawing_function.html-dee669df.js" as="script"><link rel="prefetch" href="../assets/enum_constants.html-2c1f6dcc.js" as="script"><link rel="prefetch" href="../assets/interface_operation.html-47a2cf15.js" as="script"><link rel="prefetch" href="../assets/question_answer.html-4f12deae.js" as="script"><link rel="prefetch" href="../assets/quote_function.html-827e9fb8.js" as="script"><link rel="prefetch" href="../assets/related_instructions.html-9b630c20.js" as="script"><link rel="prefetch" href="../assets/start_now.html-79f8f415.js" as="script"><link rel="prefetch" href="../assets/system_function.html-03a1dc3a.js" as="script"><link rel="prefetch" href="../assets/trading_function.html-3c0f4ee8.js" as="script"><link rel="prefetch" href="../assets/user_attention.html-e0d27a96.js" as="script"><link rel="prefetch" href="../assets/variable_convention.html-17caf0d6.js" as="script"><link rel="prefetch" href="../assets/JoinQuant2QMT.html-38cb9974.js" as="script"><link rel="prefetch" href="../assets/index.html-22b6b31a.js" as="script"><link rel="prefetch" href="../assets/daoru_daochu.html-c8cace75.js" as="script"><link rel="prefetch" href="../assets/hangqing_setting.html-1a9570b3.js" as="script"><link rel="prefetch" href="../assets/ty_add_indicator.html-1f2f4b0a.js" as="script"><link rel="prefetch" href="../assets/ty_backtest_strategy.html-270aeeab.js" as="script"><link rel="prefetch" href="../assets/ty_code_review_backtest.html-200ceddd.js" as="script"><link rel="prefetch" href="../assets/ty_content.html-bac1ad25.js" as="script"><link rel="prefetch" href="../assets/ty_data_download.html-351b4a4f.js" as="script"><link rel="prefetch" href="../assets/ty_data_interface.html-2e32a98a.js" as="script"><link rel="prefetch" href="../assets/ty_direct_connect.html-f8b10f83.js" as="script"><link rel="prefetch" href="../assets/ty_factor_data.html-1746bcaa.js" as="script"><link rel="prefetch" href="../assets/ty_linux_xtquant_data.html-44bf60fb.js" as="script"><link rel="prefetch" href="../assets/ty_native_python.html-8028f714.js" as="script"><link rel="prefetch" href="../assets/ty_register_install.html-0d2c078f.js" as="script"><link rel="prefetch" href="../assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="../assets/index.html-23445d95.js" as="script"><link rel="prefetch" href="../assets/basic_syntax.html-5af886ee.js" as="script"><link rel="prefetch" href="../assets/check_sheet.html-5184a806.js" as="script"><link rel="prefetch" href="../assets/code_examples.html-aa1deec9.js" as="script"><link rel="prefetch" href="../assets/control_statement.html-3b20a2b9.js" as="script"><link rel="prefetch" href="../assets/operating_mode.html-fd0ec393.js" as="script"><link rel="prefetch" href="../assets/start_now.html-bdc1834b.js" as="script"><link rel="prefetch" href="../assets/index.html-a0cb365e.js" as="script"><link rel="prefetch" href="../assets/bond.html-7a63f47e.js" as="script"><link rel="prefetch" href="../assets/floorfunds.html-9746e82a.js" as="script"><link rel="prefetch" href="../assets/future.html-dff59680.js" as="script"><link rel="prefetch" href="../assets/indexes.html-f0ffc2ed.js" as="script"><link rel="prefetch" href="../assets/industry.html-6c37727a.js" as="script"><link rel="prefetch" href="../assets/option.html-bc239cdd.js" as="script"><link rel="prefetch" href="../assets/question_answer.html-eb13f2ba.js" as="script"><link rel="prefetch" href="../assets/stock.html-5b93fe23.js" as="script"><link rel="prefetch" href="../assets/python调用VBA.html-f3232163.js" as="script"><link rel="prefetch" href="../assets/全市场涨跌幅度统计.html-0615d22a.js" as="script"><link rel="prefetch" href="../assets/全市场资金流向.html-0e599d6b.js" as="script"><link rel="prefetch" href="../assets/北向资金.html-dabcf598.js" as="script"><link rel="prefetch" href="../assets/南向资金.html-dbd875ea.js" as="script"><link rel="prefetch" href="../assets/外盘_内盘.html-5f883999.js" as="script"><link rel="prefetch" href="../assets/多空对比.html-11c1c488.js" as="script"><link rel="prefetch" href="../assets/委买价_委卖价_委买量_委卖量.html-0df576f7.js" as="script"><link rel="prefetch" href="../assets/总市值.html-e1af9791.js" as="script"><link rel="prefetch" href="../assets/总股本_涨停_跌停.html-41245f1b.js" as="script"><link rel="prefetch" href="../assets/换手.html-2811be82.js" as="script"><link rel="prefetch" href="../assets/最新_今开_最高_最低_总额_总手_交易状态.html-b756ceca.js" as="script"><link rel="prefetch" href="../assets/注册资本.html-049b932e.js" as="script"><link rel="prefetch" href="../assets/流通盘.html-e48d17b3.js" as="script"><link rel="prefetch" href="../assets/涨跌_涨幅.html-c49f09e7.js" as="script"><link rel="prefetch" href="../assets/涨跌家数变化.html-b0a2702d.js" as="script"><link rel="prefetch" href="../assets/规模风向标.html-8caa0565.js" as="script"><link rel="prefetch" href="../assets/量比.html-13e416e5.js" as="script"><link rel="prefetch" href="../assets/rookie.html-e305c3cb.js" as="script"><link rel="prefetch" href="../assets/code_examples.html-37f2c141.js" as="script"><link rel="prefetch" href="../assets/download_xtquant.html-7a7ee88f.js" as="script"><link rel="prefetch" href="../assets/question_function.html-437cccea.js" as="script"><link rel="prefetch" href="../assets/start_now.html-01155b75.js" as="script"><link rel="prefetch" href="../assets/xtdata.html-1e0a07b7.js" as="script"><link rel="prefetch" href="../assets/xttrader.html-ed1b1fe5.js" as="script"><link rel="prefetch" href="../assets/callback_function.html-a1ef7560.js" as="script"><link rel="prefetch" href="../assets/code_examples.html-8a240771.js" as="script"><link rel="prefetch" href="../assets/data_function.html-94c8c7e6.js" as="script"><link rel="prefetch" href="../assets/data_structure.html-47f36229.js" as="script"><link rel="prefetch" href="../assets/drawing_function.html-ad741397.js" as="script"><link rel="prefetch" href="../assets/enum_constants.html-6a4d27a4.js" as="script"><link rel="prefetch" href="../assets/interface_operation.html-9b7579d2.js" as="script"><link rel="prefetch" href="../assets/question_answer.html-15175a6b.js" as="script"><link rel="prefetch" href="../assets/quote_function.html-86d4ef78.js" as="script"><link rel="prefetch" href="../assets/related_instructions.html-b4f87603.js" as="script"><link rel="prefetch" href="../assets/start_now.html-d25bd7fe.js" as="script"><link rel="prefetch" href="../assets/system_function.html-b5032370.js" as="script"><link rel="prefetch" href="../assets/trading_function.html-51206dd7.js" as="script"><link rel="prefetch" href="../assets/user_attention.html-d2df5640.js" as="script"><link rel="prefetch" href="../assets/variable_convention.html-8bcc5c5f.js" as="script"><link rel="prefetch" href="../assets/JoinQuant2QMT.html-5a5867f6.js" as="script"><link rel="prefetch" href="../assets/index.html-925d7c12.js" as="script"><link rel="prefetch" href="../assets/daoru_daochu.html-9feb8edf.js" as="script"><link rel="prefetch" href="../assets/hangqing_setting.html-6f4f36fa.js" as="script"><link rel="prefetch" href="../assets/ty_add_indicator.html-ab4dcef5.js" as="script"><link rel="prefetch" href="../assets/ty_backtest_strategy.html-3da9fb3c.js" as="script"><link rel="prefetch" href="../assets/ty_code_review_backtest.html-bc72c419.js" as="script"><link rel="prefetch" href="../assets/ty_content.html-93b129b3.js" as="script"><link rel="prefetch" href="../assets/ty_data_download.html-6381aec1.js" as="script"><link rel="prefetch" href="../assets/ty_data_interface.html-2a716790.js" as="script"><link rel="prefetch" href="../assets/ty_direct_connect.html-b63051ab.js" as="script"><link rel="prefetch" href="../assets/ty_factor_data.html-5f08c397.js" as="script"><link rel="prefetch" href="../assets/ty_linux_xtquant_data.html-bf571773.js" as="script"><link rel="prefetch" href="../assets/ty_native_python.html-264f76d4.js" as="script"><link rel="prefetch" href="../assets/ty_register_install.html-cfe8e155.js" as="script"><link rel="prefetch" href="../assets/404.html-a36e0f1a.js" as="script"><link rel="prefetch" href="../assets/SearchBox-a1914cb6.js" as="script"><link rel="prefetch" href="../assets/auto-6adc87e8.js" as="script"><link rel="prefetch" href="../assets/index-2bf332f6.js" as="script"><link rel="prefetch" href="../assets/flowchart-c441f34d.js" as="script"><link rel="prefetch" href="../assets/SignPanel-39d95e93.js" as="script"><link rel="prefetch" href="../assets/SignPanel-39d95e93.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[-->
	<header class="navbar">
	
	<div class="navbar-item"><a href="../index.html" class="" aria-label="首页">首页</a></div>
	<div class="navbar-item"><a href="../innerApi/start_now.html" class="" aria-label="内置Python"><!--[--><!--]--> 内置Python <!--[--><!--]--></a></div>
	<div class="navbar-item"><a href="../nativeApi/start_now.html" class="" aria-label="原生Python"><!--[--><!--]--> 原生Python <!--[--><!--]--></a></div>
	<div class="navbar-item"><a href="../VBA/start_now.html" class="" aria-label="VBA"><!--[--><!--]--> VBA <!--[--><!--]--></a></div>

	<div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据字典"><span class="title">数据字典</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据字典"><span class="title">数据字典</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="../dictionary/stock.html" class="" aria-label="股票数据"><!--[--><!--]--> 股票数据 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="../dictionary/industry.html" class="" aria-label="行业概念数据"><!--[--><!--]--> 行业概念数据 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="../dictionary/indexes.html" class="" aria-label="指数数据"><!--[--><!--]--> 指数数据 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="../dictionary/future.html" class="" aria-label="期货数据"><!--[--><!--]--> 期货数据 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="../dictionary/option.html" class="" aria-label="期权数据"><!--[--><!--]--> 期权数据 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="../dictionary/floorfunds.html" class="" aria-label="场内基金数据"><!--[--><!--]--> 场内基金数据 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="../dictionary/bond.html" class="" aria-label="债券数据"><!--[--><!--]--> 债券数据 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="../dictionary/question_answer.html" class="" aria-label="常见问题"><!--[--><!--]--> 常见问题 <!--[--><!--]--></a></li><!--]--></ul></div></div>

	<div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--这里是导航右侧--></nav></div>
	
	</header>
	<aside class="sidebar">
	
	<ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">VBA <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="../VBA/start_now.html" class="sidebar-item" aria-label="快速开始"><!--[--><!--]--> 快速开始 <!--[--><!--]--></a><!----></li><li><a href="../VBA/basic_syntax.html" class="sidebar-item" aria-label="基础语法"><!--[--><!--]--> 基础语法 <!--[--><!--]--></a><!----></li><li><a href="../VBA/control_statement.html" class="sidebar-item" aria-label="控制语句"><!--[--><!--]--> 控制语句 <!--[--><!--]--></a><!----></li><li><a href="../VBA/operating_mode.html" class="sidebar-item" aria-label="运行机制"><!--[--><!--]--> 运行机制 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="系统函数"><!--[--><!--]--> 系统函数 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="../VBA/system_function.html#下单函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="下单函数"><!--[--><!--]--> 下单函数 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="../VBA/system_function.html#passorder函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="PASSORDER函数"><!--[--><!--]--> PASSORDER函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#holding-返回持仓数量" class="router-link-active router-link-exact-active sidebar-item" aria-label="holding :返回持仓数量"><!--[--><!--]--> holding :返回持仓数量 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#holdings-返回持仓信息" class="router-link-active router-link-exact-active sidebar-item" aria-label="holdings：返回持仓信息"><!--[--><!--]--> holdings：返回持仓信息 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#ordering-返回当前委托数量" class="router-link-active router-link-exact-active sidebar-item" aria-label="ordering：返回当前委托数量"><!--[--><!--]--> ordering：返回当前委托数量 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#deal-返回某个时间内的成交数量" class="router-link-active router-link-exact-active sidebar-item" aria-label="deal：返回某个时间内的成交数量"><!--[--><!--]--> deal：返回某个时间内的成交数量 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#deals-返回成交信息" class="router-link-active router-link-exact-active sidebar-item" aria-label="deals：返回成交信息"><!--[--><!--]--> deals：返回成交信息 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#cancel-撤单" class="router-link-active router-link-exact-active sidebar-item" aria-label="cancel:撤单"><!--[--><!--]--> cancel:撤单 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="../VBA/system_function.html#监控函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="监控函数"><!--[--><!--]--> 监控函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#控制函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="控制函数"><!--[--><!--]--> 控制函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#线型描述" class="router-link-active router-link-exact-active sidebar-item" aria-label="线型描述"><!--[--><!--]--> 线型描述 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#逻辑函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="逻辑函数"><!--[--><!--]--> 逻辑函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#动态行情" class="router-link-active router-link-exact-active sidebar-item" aria-label="动态行情"><!--[--><!--]--> 动态行情 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#绘图函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="绘图函数"><!--[--><!--]--> 绘图函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#字符串函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="字符串函数"><!--[--><!--]--> 字符串函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#引用函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="引用函数"><!--[--><!--]--> 引用函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#控制函数-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="控制函数"><!--[--><!--]--> 控制函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#指标函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="指标函数"><!--[--><!--]--> 指标函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#统计函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="统计函数"><!--[--><!--]--> 统计函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#时间函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="时间函数"><!--[--><!--]--> 时间函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#数学函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="数学函数"><!--[--><!--]--> 数学函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#行情函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="行情函数"><!--[--><!--]--> 行情函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#扩展数据" class="router-link-active router-link-exact-active sidebar-item" aria-label="扩展数据"><!--[--><!--]--> 扩展数据 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#组合模型" class="router-link-active router-link-exact-active sidebar-item" aria-label="组合模型"><!--[--><!--]--> 组合模型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#组合模型交易函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="组合模型交易函数"><!--[--><!--]--> 组合模型交易函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#系统函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="系统函数"><!--[--><!--]--> 系统函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../VBA/system_function.html#附加函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="附加函数"><!--[--><!--]--> 附加函数 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="../VBA/code_examples.html" class="sidebar-item" aria-label="完整示例"><!--[--><!--]--> 完整示例 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page" data-v-3c904194><!--[--><!--]--><div class="theme-default-contents" data-v-3c904194><!----><!--[--><!--]--><div class="theme-default-content" data-v-3c904194><div data-v-3c904194><p>编辑器提供完备的下单交易函数，可以完成下单、监控以及控制一系列的交易逻辑。</p><h3 id="下单函数" tabindex="-1"><a class="header-anchor" href="#下单函数" aria-hidden="true">#</a> 下单函数</h3><h4 id="passorder函数" tabindex="-1"><a class="header-anchor" href="#passorder函数" aria-hidden="true">#</a> PASSORDER函数</h4><div class="custom-container tip"><p class="custom-container-title">提示</p><p>该函数的参数值与内置python的passorder一致，具体值请参考内置python文档</p></div><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#50FA7B;">passorder</span><span style="color:#F8F8F2;">(opType, orderType, accountID , orderCode, prType, price, volume)</span></span>
<span class="line"><span style="color:#F8F8F2;">[, orderCode, prType, price, volume] 不是必填，默认值分别是, </span><span style="color:#E9F284;">&quot;&quot;</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">-1</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>参数数据类型</p><p><a href="../innerApi/enum_constants.html#optype-%E6%93%8D%E4%BD%9C%E7%B1%BB%E5%9E%8B" class="">opType：数字型（int）</a></p><p><a href="../innerApi/enum_constants.html#ordertype-%E4%B8%8B%E5%8D%95%E6%96%B9%E5%BC%8F" class="">orderType：数字型（int）</a></p><p><a href="../innerApi/trading_function.html?id=null#passorder-%E7%BB%BC%E5%90%88%E4%B8%8B%E5%8D%95%E5%87%BD%E6%95%B0">accountID：字符串型（string）</a></p><p><a href="../innerApi/trading_function.html?id=null#passorder-%E7%BB%BC%E5%90%88%E4%B8%8B%E5%8D%95%E5%87%BD%E6%95%B0">orderCode：字符串型（string）</a></p><p><a href="../innerApi/enum_constants.html#prtype-%E4%B8%8B%E5%8D%95%E9%80%89%E4%BB%B7%E7%B1%BB%E5%9E%8B" class="">prType：数字型（int）</a></p><p><a href="../innerApi/trading_function.html?id=null#passorder-%E7%BB%BC%E5%90%88%E4%B8%8B%E5%8D%95%E5%87%BD%E6%95%B0">price：数字型（double）</a></p><p><a href="../innerApi/trading_function.html?id=null#passorder-%E7%BB%BC%E5%90%88%E4%B8%8B%E5%8D%95%E5%87%BD%E6%95%B0">volume：数字型（double）</a></p><details class="custom-container details"><summary>一个发出套利单的例子：</summary><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">stockAccountID:</span><span style="color:#FF79C6;">=</span><span style="color:#6272A4;">&#39;6000000255&#39;;</span></span>
<span class="line"><span style="color:#F8F8F2;">futureAccountID:</span><span style="color:#FF79C6;">=</span><span style="color:#6272A4;">&#39;039427&#39;;</span></span>
<span class="line"><span style="color:#F8F8F2;">basketName:</span><span style="color:#FF79C6;">=</span><span style="color:#6272A4;">&#39;testStock&#39;;//预先建立好的股票篮子</span></span>
<span class="line"><span style="color:#F8F8F2;">futureName:</span><span style="color:#FF79C6;">=</span><span style="color:#6272A4;">&#39;IF1703&#39;;</span></span>
<span class="line"><span style="color:#F8F8F2;">operateType:</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">25</span><span style="color:#F8F8F2;">;//股票篮子买入</span></span>
<span class="line"><span style="color:#F8F8F2;">orderType:</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">2333</span><span style="color:#F8F8F2;">;//按账号可用方式下单并套利</span></span>
<span class="line"><span style="color:#F8F8F2;">priceType:</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">5</span><span style="color:#F8F8F2;">;//以最新价</span></span>
<span class="line"><span style="color:#F8F8F2;">model_price:</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">;//套利比例 </span><span style="color:#BD93F9;">100</span><span style="color:#FF79C6;">%</span><span style="color:#F8F8F2;">，这里对 modelprice 这个字段进行了重用作 套利比例用</span></span>
<span class="line"><span style="color:#F8F8F2;">volume:</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">0.05</span><span style="color:#F8F8F2;">;//以账号可用资金的 </span><span style="color:#BD93F9;">5</span><span style="color:#FF79C6;">%</span><span style="color:#F8F8F2;">买入篮子</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">AccountID:</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">stockAccountID</span><span style="color:#FF79C6;">+</span><span style="color:#6272A4;">&#39;,&#39;+futureAccountID;</span></span>
<span class="line"><span style="color:#F8F8F2;">orderCode:</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">basketName</span><span style="color:#FF79C6;">+</span><span style="color:#6272A4;">&#39;,&#39;+futureName;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">doit:</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> c</span><span style="color:#FF79C6;">&gt;</span><span style="color:#F8F8F2;">o </span><span style="color:#FF79C6;">then</span><span style="color:#F8F8F2;"> //是阳线就套利</span></span>
<span class="line"><span style="color:#F8F8F2;">begin</span></span>
<span class="line"><span style="color:#F8F8F2;">//下套利单</span></span>
<span class="line"><span style="color:#F8F8F2;">orderType</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">2333</span></span>
<span class="line"><span style="color:#50FA7B;">passorder</span><span style="color:#F8F8F2;">(operateType,orderType,AccountID,orderCode,priceType,model_price,volume)</span></span>
<span class="line"><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">doit:</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#8BE9FD;">end</span></span>
<span class="line"><span style="color:#F8F8F2;">single:doit;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><p>passorder支持融资融券</p><h4 id="holding-返回持仓数量" tabindex="-1"><a class="header-anchor" href="#holding-返回持仓数量" aria-hidden="true">#</a> holding :返回持仓数量</h4><p>调用：holding(AccountID , MarketID, StockID,Direction);</p><p>AccountID, MarketID, StockID 为字符串；Direction 为整型（1 多，2 空）</p><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">例 ：</span></span>
<span class="line"><span style="color:#F8F8F2;">ho:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">holding</span><span style="color:#F8F8F2;">(‘</span><span style="color:#BD93F9;">037055</span><span style="color:#F8F8F2;">’,’</span><span style="color:#FF79C6;">IF</span><span style="color:#F8F8F2;">’,’IF06’,</span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="holdings-返回持仓信息" tabindex="-1"><a class="header-anchor" href="#holdings-返回持仓信息" aria-hidden="true">#</a> holdings：返回持仓信息</h4><p>调用：holdings(Account);</p><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">例 </span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">：</span></span>
<span class="line"><span style="color:#F8F8F2;">xxx:</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">holdings</span><span style="color:#F8F8F2;">(‘</span><span style="color:#BD93F9;">037055</span><span style="color:#F8F8F2;">’);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">例 </span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;">：</span></span>
<span class="line"><span style="color:#F8F8F2;">统计某个账号所有品种做多方向的持仓</span></span>
<span class="line"><span style="color:#F8F8F2;">xxx :</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">holdings</span><span style="color:#F8F8F2;">(</span><span style="color:#6272A4;">&#39;037055&#39;);</span></span>
<span class="line"><span style="color:#F8F8F2;">loh :</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> x </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> xxx </span><span style="color:#FF79C6;">do</span><span style="color:#F8F8F2;"> begin </span><span style="color:#FF79C6;">if</span></span>
<span class="line"><span style="color:#F8F8F2;">x.direction </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">48</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">then</span><span style="color:#F8F8F2;"> loh:</span><span style="color:#FF79C6;">=</span></span>
<span class="line"><span style="color:#F8F8F2;">loh </span><span style="color:#FF79C6;">+</span><span style="color:#F8F8F2;"> x.volume;</span></span>
<span class="line"><span style="color:#8BE9FD;">end</span></span>
<span class="line"><span style="color:#F8F8F2;">longhold:loh;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>xxx 为一个 positiondetail 结构体，含有如下项：</strong></p><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">exchangeid 证券市场,交易所代码</span></span>
<span class="line"><span style="color:#F8F8F2;">exchangename 市场名字</span></span>
<span class="line"><span style="color:#F8F8F2;">productid 品种代码</span></span>
<span class="line"><span style="color:#F8F8F2;">productname 品种名称</span></span>
<span class="line"><span style="color:#F8F8F2;">instrumentid 证券代码,合约代码</span></span>
<span class="line"><span style="color:#F8F8F2;">instrumentname 证券名称,合约名称</span></span>
<span class="line"><span style="color:#F8F8F2;">hedgeflag 投保</span></span>
<span class="line"><span style="color:#F8F8F2;">direction 买卖</span></span>
<span class="line"><span style="color:#F8F8F2;">opendate 成交日期</span></span>
<span class="line"><span style="color:#F8F8F2;">tradeid 最初开仓位的成交</span></span>
<span class="line"><span style="color:#F8F8F2;">volume 持仓量 当前拥股</span></span>
<span class="line"><span style="color:#F8F8F2;">openprice 开仓价</span></span>
<span class="line"><span style="color:#F8F8F2;">tradingday 交易日</span></span>
<span class="line"><span style="color:#F8F8F2;">margin 使用的保证金 历史的直接用 ctp 的，新的自己用成本价</span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;">存量</span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;">系数算 股票不需要</span></span>
<span class="line"><span style="color:#F8F8F2;">opencost 开仓成本 等于股票的成本价</span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;">第一次建仓的量，后续减持不影响，不算手续费 股票不需要</span></span>
<span class="line"><span style="color:#F8F8F2;">settlementprice /结算价 对于股票的当前价</span></span>
<span class="line"><span style="color:#F8F8F2;">closevolume 平仓量 等于股票已经卖掉的 股票不需要</span></span>
<span class="line"><span style="color:#F8F8F2;">closeamount 平仓额 等于股票每次卖出的量</span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;">卖出价</span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;">合约乘数（股票为 </span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">）的累加 股票不需要</span></span>
<span class="line"><span style="color:#F8F8F2;">dloatprofit 浮动盈亏 当前量</span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;">（当前价</span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;">开仓价）</span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;">合约乘数（股票为 </span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">）</span></span>
<span class="line"><span style="color:#F8F8F2;">closeprofit 平仓盈亏 平仓额 </span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;"> 开仓价</span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;">平仓量</span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;">合约乘数（股票为 </span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">） 股票不需要</span></span>
<span class="line"><span style="color:#F8F8F2;">marketvalue 市值 合约价值</span></span>
<span class="line"><span style="color:#F8F8F2;">positioncost 持仓成本 股票不需要</span></span>
<span class="line"><span style="color:#F8F8F2;">positionprofit 持仓盈亏 股票不需要</span></span>
<span class="line"><span style="color:#F8F8F2;">lastsettlementprice 最新结算价 股票不需要</span></span>
<span class="line"><span style="color:#F8F8F2;">instrumentvalue 合约价值 股票不需要</span></span>
<span class="line"><span style="color:#F8F8F2;">istoday 是否今仓</span></span>
<span class="line"><span style="color:#F8F8F2;">xttag 量化投研平台标签</span></span>
<span class="line"><span style="color:#F8F8F2;">stockholder 股东账号</span></span>
<span class="line"><span style="color:#F8F8F2;">frozenvolume 期货不用这个字段，冻结数量</span></span>
<span class="line"><span style="color:#F8F8F2;">canusevolume 期货不用这个字段，股票的可用数量</span></span>
<span class="line"><span style="color:#F8F8F2;">onroadvolume 期货不用这个字段，股票的在途数量</span></span>
<span class="line"><span style="color:#F8F8F2;">yesterdayvolume 期货不用这个字段，股票的股份余额</span></span>
<span class="line"><span style="color:#F8F8F2;">lastprice 结算价 对于股票的当前价</span></span>
<span class="line"><span style="color:#F8F8F2;">profitrate 持仓盈亏比例</span></span>
<span class="line"><span style="color:#F8F8F2;">futuretradetype 成交类型</span></span>
<span class="line"><span style="color:#F8F8F2;">expiredate 到期日，逆回购用</span></span>
<span class="line"><span style="color:#F8F8F2;">comtradeid 套利成交 Id</span></span>
<span class="line"><span style="color:#F8F8F2;">legid 组合 Id</span></span>
<span class="line"><span style="color:#F8F8F2;">totalcost 自定义累计成本 股票信用用到</span></span>
<span class="line"><span style="color:#F8F8F2;">singlecost 自定义单股成本 股票信用用到</span></span>
<span class="line"><span style="color:#F8F8F2;">coveredvolume 用于个股期权</span></span>
<span class="line"><span style="color:#F8F8F2;">sideflag 用于个股期权，标记 </span><span style="color:#6272A4;">&#39;0&#39; - 权利，&#39;1&#39; - 义务，&#39;2&#39; - &#39;备兑&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">referencerate 汇率,目前用于港股通</span></span>
<span class="line"><span style="color:#F8F8F2;">structfundvol 分级基金可用（可分拆或可合并）</span></span>
<span class="line"><span style="color:#F8F8F2;">redemptionvolume 分级基金可赎回量</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ordering-返回当前委托数量" tabindex="-1"><a class="header-anchor" href="#ordering-返回当前委托数量" aria-hidden="true">#</a> ordering：返回当前委托数量</h4><p>调用：ordering(AccountID , MarketID, StockID,Direction);</p><p>AccountID, MarketID, StockID 为字符串；Direction 为整型（1 buy，2 sell）</p><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">例 ：</span></span>
<span class="line"><span style="color:#F8F8F2;">ord:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">ordering</span><span style="color:#F8F8F2;">(‘</span><span style="color:#BD93F9;">037055</span><span style="color:#F8F8F2;">’,’</span><span style="color:#FF79C6;">IF</span><span style="color:#F8F8F2;">’,’IF06’,</span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F8F8F2;">（</span><span style="color:#BD93F9;">7</span><span style="color:#F8F8F2;">） orderings：返回委托信息</span></span>
<span class="line"><span style="color:#F8F8F2;">调用：</span><span style="color:#50FA7B;">orderings</span><span style="color:#F8F8F2;">(AccountID);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">例：</span></span>
<span class="line"><span style="color:#F8F8F2;">统计某账号买入的所有的当天委托量</span></span>
<span class="line"><span style="color:#F8F8F2;">xxx :</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">orderings</span><span style="color:#F8F8F2;">(</span><span style="color:#6272A4;">&#39;037055&#39;);</span></span>
<span class="line"><span style="color:#F8F8F2;">loo :</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> x </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> xxx </span><span style="color:#FF79C6;">do</span><span style="color:#F8F8F2;"> begin</span></span>
<span class="line"><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> x.direction </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">48</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">then</span></span>
<span class="line"><span style="color:#F8F8F2;">loo:</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> loo </span><span style="color:#FF79C6;">+</span><span style="color:#F8F8F2;"> x.volumetotaloriginal;</span></span>
<span class="line"><span style="color:#8BE9FD;">end</span></span>
<span class="line"><span style="color:#F8F8F2;">longorder:loo</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>xxx 为一个 orderdetail 结构体，含有如下项：</strong></p><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">exchangeid 证券市场,交易所代码</span></span>
<span class="line"><span style="color:#F8F8F2;">exchangename 市场名字</span></span>
<span class="line"><span style="color:#F8F8F2;">productid 品种代码</span></span>
<span class="line"><span style="color:#F8F8F2;">productname 品种名称</span></span>
<span class="line"><span style="color:#F8F8F2;">instrumentid 证券代码,合约代码</span></span>
<span class="line"><span style="color:#F8F8F2;">instrumentname 证券名称,合约名称</span></span>
<span class="line"><span style="color:#BD93F9;">sessionid</span></span>
<span class="line"><span style="color:#F8F8F2;">frontid 前端 id</span></span>
<span class="line"><span style="color:#F8F8F2;">orderref 下单引用 等于股票的内部委托号</span></span>
<span class="line"><span style="color:#F8F8F2;">orderpricetype 类型，例如市价单 限价单</span></span>
<span class="line"><span style="color:#F8F8F2;">direction 期货多空 股票买卖</span></span>
<span class="line"><span style="color:#F8F8F2;">offsetflag 期货开平，股票买卖其实就是开平</span></span>
<span class="line"><span style="color:#F8F8F2;">hedgeflag 投保</span></span>
<span class="line"><span style="color:#F8F8F2;">limitprice 限价单的限价，就是报价</span></span>
<span class="line"><span style="color:#F8F8F2;">volumetotaloriginal 最初委托量</span></span>
<span class="line"><span style="color:#F8F8F2;">ordersubmitstatus 提交状态</span></span>
<span class="line"><span style="color:#F8F8F2;">ordersysid 委托号</span></span>
<span class="line"><span style="color:#F8F8F2;">orderstatus 委托状态</span></span>
<span class="line"><span style="color:#F8F8F2;">volumetraded 已成交量</span></span>
<span class="line"><span style="color:#F8F8F2;">volumetotal 当前总委托量 股票不需要总委托量</span></span>
<span class="line"><span style="color:#F8F8F2;">errorid</span></span>
<span class="line"><span style="color:#F8F8F2;">errormsg 状态信息</span></span>
<span class="line"><span style="color:#F8F8F2;">taskid</span></span>
<span class="line"><span style="color:#F8F8F2;">frozenmargin 冻结保证金</span></span>
<span class="line"><span style="color:#F8F8F2;">frozencommission 冻结手续费</span></span>
<span class="line"><span style="color:#F8F8F2;">insertdate 日期</span></span>
<span class="line"><span style="color:#F8F8F2;">inserttime 时间</span></span>
<span class="line"><span style="color:#F8F8F2;">xttag 量化投研平台标签</span></span>
<span class="line"><span style="color:#F8F8F2;">tradeprice 成交均价</span></span>
<span class="line"><span style="color:#F8F8F2;">cancelamount 已撤数量</span></span>
<span class="line"><span style="color:#F8F8F2;">optname 展示委托属性的中文</span></span>
<span class="line"><span style="color:#F8F8F2;">tradeamount 成交额 期货</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">均价</span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;">量</span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;">合约乘数</span></span>
<span class="line"><span style="color:#F8F8F2;">entrusttype 委托类别</span></span>
<span class="line"><span style="color:#F8F8F2;">cancelinfo 废单原因</span></span>
<span class="line"><span style="color:#F8F8F2;">undercode 标的证券</span></span>
<span class="line"><span style="color:#F8F8F2;">covereflag 备兑标记 </span><span style="color:#6272A4;">&#39;0&#39; - 非备兑，&#39;1&#39; - 备兑</span></span>
<span class="line"><span style="color:#F8F8F2;">orderpricermb 委托价格 人民币 用于港股通</span></span>
<span class="line"><span style="color:#F8F8F2;">tradeamountrmb 成交金额 人民币用于港股通</span></span>
<span class="line"><span style="color:#F8F8F2;">referencerate 参考汇率 用于港股通</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="deal-返回某个时间内的成交数量" tabindex="-1"><a class="header-anchor" href="#deal-返回某个时间内的成交数量" aria-hidden="true">#</a> deal：返回某个时间内的成交数量</h4><p>调用：deal(AccountID , MarketID, StockID,Direction);</p><p>或 deal(AccountID , MarketID, StockID,Direction,Seconds);</p><p>AccountID, MarketID, StockID 为字符串；Direction 为整型（1 多，2 空）, Seconds 为整型，表示多少秒内。</p><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">例 </span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">：</span></span>
<span class="line"><span style="color:#F8F8F2;">de:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">deal</span><span style="color:#F8F8F2;">(‘</span><span style="color:#BD93F9;">037055</span><span style="color:#F8F8F2;">’,’</span><span style="color:#FF79C6;">IF</span><span style="color:#F8F8F2;">’,’IF06’,</span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;">);//返回当天 IF06 的 sell 的成交数量</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">例 </span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;">：</span></span>
<span class="line"><span style="color:#F8F8F2;">de:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">deal</span><span style="color:#F8F8F2;">(‘</span><span style="color:#BD93F9;">037055</span><span style="color:#F8F8F2;">’,’</span><span style="color:#FF79C6;">IF</span><span style="color:#F8F8F2;">’,’IF06’,</span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;">,</span><span style="color:#BD93F9;">90</span><span style="color:#F8F8F2;">);//返回最近 </span><span style="color:#BD93F9;">90</span><span style="color:#F8F8F2;"> 秒内 IF06 的 sell 的成交数量</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="deals-返回成交信息" tabindex="-1"><a class="header-anchor" href="#deals-返回成交信息" aria-hidden="true">#</a> deals：返回成交信息</h4><p>调用：deals(AccountID);</p><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">例：</span></span>
<span class="line"><span style="color:#F8F8F2;">返回某账号当天 buy 的成交量</span></span>
<span class="line"><span style="color:#F8F8F2;">xxx :</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">deals</span><span style="color:#F8F8F2;">(</span><span style="color:#6272A4;">&#39;037055&#39;);</span></span>
<span class="line"><span style="color:#F8F8F2;">dea:</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> x </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> xxx </span><span style="color:#FF79C6;">do</span><span style="color:#F8F8F2;"> begin </span><span style="color:#FF79C6;">if</span></span>
<span class="line"><span style="color:#F8F8F2;">x.direction </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">48</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">then</span><span style="color:#F8F8F2;"> dea:</span><span style="color:#FF79C6;">=</span></span>
<span class="line"><span style="color:#F8F8F2;">dea </span><span style="color:#FF79C6;">+</span><span style="color:#F8F8F2;"> x.volume;</span></span>
<span class="line"><span style="color:#8BE9FD;">end</span></span>
<span class="line"><span style="color:#F8F8F2;">longdeal:dea</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>xxx 为一个 dealdetail 结构体，含有如下项：</strong></p><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">exchangeid 证券市场,交易所代码</span></span>
<span class="line"><span style="color:#F8F8F2;">exchangename 市场名字</span></span>
<span class="line"><span style="color:#F8F8F2;">productid 品种代码</span></span>
<span class="line"><span style="color:#F8F8F2;">productname 品种名称</span></span>
<span class="line"><span style="color:#F8F8F2;">instrumentid 证券代码,合约代码</span></span>
<span class="line"><span style="color:#F8F8F2;">instrumentname 证券名称,合约名称</span></span>
<span class="line"><span style="color:#F8F8F2;">tradeid 成交编号</span></span>
<span class="line"><span style="color:#F8F8F2;">orderref 下单引用 等于股票的内部委托号</span></span>
<span class="line"><span style="color:#F8F8F2;">ordersysid 委托号</span></span>
<span class="line"><span style="color:#F8F8F2;">direction 买卖 股票不需要</span></span>
<span class="line"><span style="color:#F8F8F2;">offsetflag 开平 股票的买卖</span></span>
<span class="line"><span style="color:#F8F8F2;">hedgeflag 投保 股票不需要</span></span>
<span class="line"><span style="color:#F8F8F2;">price 成交均价</span></span>
<span class="line"><span style="color:#F8F8F2;">volume 成交量 期货单位手 股票做到股</span></span>
<span class="line"><span style="color:#F8F8F2;">tradedate 成交日期</span></span>
<span class="line"><span style="color:#F8F8F2;">tradetime 成交时间</span></span>
<span class="line"><span style="color:#F8F8F2;">comssion 手续费</span></span>
<span class="line"><span style="color:#F8F8F2;">tradeamount 成交额 期货</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">均价</span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;">量</span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;">合约乘数</span></span>
<span class="line"><span style="color:#F8F8F2;">taskid</span></span>
<span class="line"><span style="color:#F8F8F2;">xttag 量化投研平台标签</span></span>
<span class="line"><span style="color:#F8F8F2;">orderpricetype 类型，例如市价单 限价单</span></span>
<span class="line"><span style="color:#F8F8F2;">optname 展示委托属性的中文</span></span>
<span class="line"><span style="color:#F8F8F2;">entrusttype 委托类别</span></span>
<span class="line"><span style="color:#F8F8F2;">futuretradetype 成交类型</span></span>
<span class="line"><span style="color:#F8F8F2;">realoffsetflag 实际开平,主要是区分平今和平昨</span></span>
<span class="line"><span style="color:#F8F8F2;">coveredflag 备兑标记 </span><span style="color:#6272A4;">&#39;0&#39; - 非备兑，&#39;1&#39; - 备兑</span></span>
<span class="line"><span style="color:#F8F8F2;">closetodayvolume 平今量, 不显示</span></span>
<span class="line"><span style="color:#F8F8F2;">orderpricermb 委托价格 人民币 用于港股通</span></span>
<span class="line"><span style="color:#F8F8F2;">pricermb 目前用于港股通</span></span>
<span class="line"><span style="color:#F8F8F2;">tradeamountrmb 目前用于港股通</span></span>
<span class="line"><span style="color:#F8F8F2;">referencerate 汇率,目前用于港股通</span></span>
<span class="line"><span style="color:#F8F8F2;">xttrade 是否是量化投研平台交易</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="cancel-撤单" tabindex="-1"><a class="header-anchor" href="#cancel-撤单" aria-hidden="true">#</a> cancel:撤单</h4><p>cancel(委托号);</p><details class="custom-container details"><summary>一个模型例子：</summary><div class="language-vb line-numbers-mode" data-ext="vb"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">//VAB 不区分大小写</span></span>
<span class="line"><span style="color:#F8F8F2;">variable:TestHolding</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">//……………………下单参数定义……………………………………</span></span>
<span class="line"><span style="color:#F8F8F2;">ORDERTYPE:</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">1101</span><span style="color:#F8F8F2;">; //下单类型</span></span>
<span class="line"><span style="color:#F8F8F2;">ACCOUNTID:</span><span style="color:#FF79C6;">=</span><span style="color:#6272A4;">&#39;6000000248&#39;; //填写对应资金账号,用户修改成自己的资金账号</span></span>
<span class="line"><span style="color:#F8F8F2;">ORDERCODE:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">STKLABEL</span><span style="color:#F8F8F2;">(); //下单代码,当前主图品种</span></span>
<span class="line"><span style="color:#F8F8F2;">PRICETYPE:</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">5</span><span style="color:#F8F8F2;">; //下单价格类型,</span><span style="color:#BD93F9;">4</span><span style="color:#F8F8F2;"> 卖 </span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;"> 价,</span><span style="color:#BD93F9;">5</span><span style="color:#F8F8F2;"> 最新价,</span><span style="color:#BD93F9;">6</span><span style="color:#F8F8F2;"> 买 </span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;"> 价,</span><span style="color:#BD93F9;">12</span><span style="color:#F8F8F2;"> 市价,</span><span style="color:#BD93F9;">13</span><span style="color:#F8F8F2;"> 挂单价,</span></span>
<span class="line"><span style="color:#BD93F9;">14</span><span style="color:#F8F8F2;"> 对手价,</span><span style="color:#BD93F9;">11</span><span style="color:#F8F8F2;">(指定价)模型价VOLUME:</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">100</span><span style="color:#F8F8F2;">; //下单数量,</span><span style="color:#BD93F9;">100</span><span style="color:#F8F8F2;"> 股</span></span>
<span class="line"><span style="color:#F8F8F2;">//………………………下单…………………………………………</span></span>
<span class="line"><span style="color:#F8F8F2;">DIFF :</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">EMA</span><span style="color:#F8F8F2;">(CLOSE,</span><span style="color:#BD93F9;">12</span><span style="color:#F8F8F2;">) </span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">EMA</span><span style="color:#F8F8F2;">(CLOSE,</span><span style="color:#BD93F9;">26</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F8F8F2;">DEA :</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">EMA</span><span style="color:#F8F8F2;">(DIFF,</span><span style="color:#BD93F9;">9</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F8F8F2;">MACD1 :</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">2</span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;">(DIFF</span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;">DEA), COLORSTICK;</span></span>
<span class="line"><span style="color:#F8F8F2;">t:</span><span style="color:#50FA7B;">BARSLAST</span><span style="color:#F8F8F2;">(TestHolding</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">),nodraw;//////////持仓周期</span></span>
<span class="line"><span style="color:#F8F8F2;">bk:</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> macd1</span><span style="color:#FF79C6;">&gt;</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">;//////////开仓条件,可根据需要更改,如 bk:</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> close</span><span style="color:#FF79C6;">&gt;</span><span style="color:#F8F8F2;">open;</span></span>
<span class="line"><span style="color:#F8F8F2;">bp:</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">(t</span><span style="color:#FF79C6;">&gt;=</span><span style="color:#BD93F9;">3</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">and</span><span style="color:#F8F8F2;"> macd1</span><span style="color:#FF79C6;">&lt;</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">);////平仓条件</span></span>
<span class="line"><span style="color:#F8F8F2;">nn:</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">;//////往后推迟几个周期交易//</span></span>
<span class="line"><span style="color:#FF79C6;">IF</span><span style="color:#F8F8F2;"> (</span><span style="color:#50FA7B;">ref</span><span style="color:#F8F8F2;">(Bk,nn) </span><span style="color:#FF79C6;">and</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">not</span><span style="color:#F8F8F2;">(bp) </span><span style="color:#FF79C6;">and</span><span style="color:#F8F8F2;"> TestHolding</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;"> ） </span><span style="color:#FF79C6;">THEN</span><span style="color:#F8F8F2;"> BEGIN</span></span>
<span class="line"><span style="color:#F8F8F2;">TestHolding:</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">BBD:</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">BARPOS;</span></span>
<span class="line"><span style="color:#50FA7B;">DRAWTEXT</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;"> ,H</span><span style="color:#FF79C6;">+</span><span style="color:#BD93F9;">4</span><span style="color:#F8F8F2;">,</span><span style="color:#6272A4;">&#39;买入&#39;);</span></span>
<span class="line"><span style="color:#50FA7B;">VERTLINE</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;"> ,h</span><span style="color:#FF79C6;">+</span><span style="color:#BD93F9;">10</span><span style="color:#F8F8F2;">,l</span><span style="color:#BD93F9;">-10</span><span style="color:#F8F8F2;">,coloryellow,</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">,VTDOT);</span></span>
<span class="line"><span style="color:#50FA7B;">PASSORDER</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">23</span><span style="color:#F8F8F2;">{股票买入},ORDERTYPE{单股下单类型},ACCOUNTID{账号},ORDERCODE{下单代</span></span>
<span class="line"><span style="color:#F8F8F2;">码},PRICETYPE{选价类型},</span><span style="color:#BD93F9;">-1</span><span style="color:#F8F8F2;">{下单价格选价类型非指定价填</span><span style="color:#BD93F9;">-1</span><span style="color:#F8F8F2;">},VOLUME{下单量});</span></span>
<span class="line"><span style="color:#8BE9FD;">END</span></span>
<span class="line"><span style="color:#F8F8F2;">//卖出</span></span>
<span class="line"><span style="color:#FF79C6;">IF</span><span style="color:#F8F8F2;"> (</span><span style="color:#50FA7B;">ref</span><span style="color:#F8F8F2;">(bp,nn) </span><span style="color:#FF79C6;">AND</span><span style="color:#F8F8F2;"> TestHolding</span><span style="color:#FF79C6;">&gt;</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;"> ) </span><span style="color:#FF79C6;">THEN</span><span style="color:#F8F8F2;"> BEGIN</span></span>
<span class="line"><span style="color:#F8F8F2;">TestHolding:</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">BBD:</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#50FA7B;">DRAWTEXT</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">,H</span><span style="color:#FF79C6;">+</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">,</span><span style="color:#6272A4;">&#39;卖出&#39;);</span></span>
<span class="line"><span style="color:#50FA7B;">VERTLINE</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">,h</span><span style="color:#FF79C6;">+</span><span style="color:#BD93F9;">10</span><span style="color:#F8F8F2;">,l</span><span style="color:#BD93F9;">-10</span><span style="color:#F8F8F2;">,colorwhite,</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">,VTDOT);</span></span>
<span class="line"><span style="color:#50FA7B;">PASSORDER</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">24</span><span style="color:#F8F8F2;">{股票买入},ORDERTYPE,ACCOUNTID,ORDERCODE,PRICETYPE,</span><span style="color:#BD93F9;">-1</span><span style="color:#F8F8F2;">,VOLUME);</span></span>
<span class="line"><span style="color:#8BE9FD;">END</span></span>
<span class="line"><span style="color:#F8F8F2;">//..................撤单..................................</span></span>
<span class="line"><span style="color:#F8F8F2;">orderss:</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">orderings</span><span style="color:#F8F8F2;">(ACCOUNTID);//获取该资金账号所有的委托信息</span></span>
<span class="line"><span style="color:#F8F8F2;">nowtime:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">CURRENTTIME</span><span style="color:#F8F8F2;">();</span></span>
<span class="line"><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> ord </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> orderss </span><span style="color:#FF79C6;">do</span><span style="color:#F8F8F2;"> begin</span></span>
<span class="line"><span style="color:#F8F8F2;">insertime:</span><span style="color:#FF79C6;">=</span><span style="color:#50FA7B;">strtonum</span><span style="color:#F8F8F2;">(ord.inserttime);</span></span>
<span class="line"><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">isequalv</span><span style="color:#F8F8F2;">(ord.orderstatus,</span><span style="color:#BD93F9;">56</span><span style="color:#F8F8F2;">)</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">and</span><span style="color:#F8F8F2;"> nowtime </span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;"> insertime </span><span style="color:#FF79C6;">&gt;</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">30</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">then</span><span style="color:#F8F8F2;"> begin //委托没</span></span>
<span class="line"><span style="color:#F8F8F2;">成功,30s 内没成交或部分成交则撤单</span></span>
<span class="line"><span style="color:#50FA7B;">cancel</span><span style="color:#F8F8F2;">(ord.ordersysid);</span></span>
<span class="line"><span style="color:#8BE9FD;">end</span></span>
<span class="line"><span style="color:#8BE9FD;">end</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h2 id="监控函数" tabindex="-1"><a class="header-anchor" href="#监控函数" aria-hidden="true">#</a> 监控函数</h2><p>量化投研平台提供 TACCOUNT、MARKETVALUE、HOLDING 和 HOLDINGS 函数用以监控账户资金以及持仓状况</p><p><strong>TACCOUNT</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">获取指定账号的可用资金</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">TACCOUNT(1,&#39;37500001&#39;);1 表示是期货账号，2 为普通股票账号，3 为信用账号，37500001 是账号 ID</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">TACCOUNT(1,&#39;37500001&#39;);//获取37500001期货账号的可用资金</td></tr></tbody></table><p><strong>HOLDING</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">得到当前帐户持仓量,多仓返回正数空仓返回负数</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">HOLDING(AccountID,MarketID,StockID,Direction);<br>AccountID,MarketID,StockID为字符串；Direction为整型（1多,2空）</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">HOLDING(&#39;037055&#39;,&#39;IF&#39;,&#39;IF09&#39;,2);//获取037055账号IF09做空持仓；<br>HOLDING(&#39;6000000255&#39;,&#39;SH&#39;,&#39;600000&#39;,1)//获取6000000255账号的股票600000的持仓</td></tr></tbody></table><p><strong>HOLDINGS</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">取某资金帐号对应的持仓</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">HOLDINGS(Account)表示获取帐号&quot;Account&quot;的持仓</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">统计某个账号所有品种做多方向的持仓<br>xxx := holdings(&#39;037055&#39;);<br>loh := 0;<br>for x in xxx do begin<br>if x.direction = 48 then<br>loh := loh+xvolume;<br>end<br>longhold:loh;<br>xxx为一个positiondetail结构体,含有如下项：<br>exchangeid证券市场,交易所代码<br>exchangename市场名字<br>productid品种代码<br>productname品种名称<br>instrumentid证券代码,合约代码<br>instrumentname证券名称,合约名称<br>hedgeflag投保<br>direction买卖<br>opendate成交日期<br>tradeid最初开仓位的成交<br>volume持仓量当前拥股<br>openprice开仓价<br>tradingday交易日<br>margin使用的保证金历史的直接用ctp的,新的自己用成本价<em>存量</em>系数算股票不需要<br>opencost开仓成本等于股票的成本价<em>第一次建仓的量,后续减持不影响,不算手续费股票不需要<br>settlementprice/结算价对于股票的当前价<br>closevolume平仓量等于股票已经卖掉的股票不需要<br>closeamount平仓额等于股票每次卖出的量</em>卖出价<em>合约乘数（股票为1）的累加股票不需要<br>dloatprofit浮动盈亏当前量</em>（当前价-开仓价）<em>合约乘数（股票为1）<br>closeprofit平仓盈亏平仓额-开仓价</em>平仓量*合约乘数（股票为1）股票不需要<br>marketvalue市值合约价值<br>positioncost持仓成本股票不需要<br>positionprofit持仓盈亏股票不需要<br>lastsettlementprice最新结算价股票不需要<br>instrumentvalue合约价值股票不需要<br>istoday是否今仓<br>xttag标签<br>stockholder股东账号<br>frozenvolume期货不用这个字段,冻结数量<br>canusevolume期货不用这个字段,股票的可用数量<br>onroadvolume期货不用这个字段,股票的在途数量<br>yesterdayvolume期货不用这个字段,股票的股份余额<br>lastprice结算价对于股票的当前价<br>profitrate持仓盈亏比例<br>futuretradetype成交类型<br>expiredate到期日,逆回购用<br>comtradeid套利成交Id<br>legid组合Id<br>totalcost自定义累计成本股票信用用到<br>singlecost自定义单股成本股票信用用到<br>coveredvolume用于个股期权<br>sideflag用于个股期权,标记&#39;0&#39;-权利,&#39;1&#39;-义务,&#39;2&#39;-&#39;备兑&#39;<br>referencerate汇率,目前用于港股通<br>structfundvol分级基金可用（可分拆或可合并）<br>redemptionvolume分级基金可赎回量</td></tr></tbody></table><p><strong>MARKETVALUE</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">获取指定账号的可用资金</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">MARKETVALUE(2，&#39;AA&#39;）表示返回帐号&quot;AA&quot;的股票市值，1 表示是期货账号，2 为普通股票账号，3 为信用账号</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">MARKETVALUE(2，&#39;37500001&#39;）;//返回股票账号37500001的股票市值</td></tr></tbody></table><h2 id="控制函数" tabindex="-1"><a class="header-anchor" href="#控制函数" aria-hidden="true">#</a> 控制函数</h2><p>控制函数主要有 SLEEP 和 CANCEL 函数分别用于控制下单的频率以及对于指定报单指令执行撤单。</p><p><strong>CANCEL</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">针对委托号进行撤单</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">CANCEL(orderId,accountID,accountType)表示撤销委托号为orderId的委托<br>orderId：委托号；<br>accountId:资金账号；<br>accountType:资金账号类型（&#39;STOCK&#39;,&#39;FUTURE&#39;,&#39;CREDIT&#39;,&#39;HUGANGTONG&#39;,&#39;SHENGANGTONG&#39;）</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">CANCEL(&#39;1234&#39;,&#39;37500001&#39;,&#39;STOCK&#39;);//撤销股票账号37500001委托号为1234的委托</td></tr></tbody></table><p><strong>SLEEP</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">函数作用于模型的最后一个周期，在最新周期中延时设定的时间之后再执行之后的语句</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">SLEEP(D),D 为延时的设置时间，单位为毫秒(1 秒钟等于 1000 毫秒)</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">SLEEP(1000);//表示等待 1 秒后再执行下行语句</td></tr></tbody></table><h2 id="线型描述" tabindex="-1"><a class="header-anchor" href="#线型描述" aria-hidden="true">#</a> 线型描述</h2><p><strong>COLORBLACK</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:center;">设为黑色</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:center;">MA1:MA(CLOSE,5),COLORBLACK；//5日均线设为黑色</td></tr></tbody></table><p><strong>COLORBLUE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:center;">设为蓝色</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:center;">MA1:MA(CLOSE,5),COLORBLUE；//5日均线设为蓝色</td></tr></tbody></table><p><strong>COLORBROWN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:center;">设为棕色</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:center;">MA1:MA(CLOSE,5),COLORBROWN；//5日均线设为棕色</td></tr></tbody></table><p><strong>COLORCYAN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:center;">设为青色</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:center;">MA1:MA(CLOSE,5),COLORCYAN；//5日均线设为青色</td></tr></tbody></table><p><strong>COLORGRAY</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:center;">设为灰色</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:center;">MA1:MA(CLOSE,5),COLORGRAY；//5日均线设为灰色</td></tr></tbody></table><p><strong>COLORGREEN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:center;">设为绿色</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:center;">MA1:MA(CLOSE,5),COLORGREEN；//5日均线设为绿色</td></tr></tbody></table><p><strong>COLORMAGENTA</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:center;">设为晶红色</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:center;">MA1:MA(CLOSE,5),COLORMAGENTA；//5日均线设为晶红色</td></tr></tbody></table><p><strong>COLORRED</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:center;">设为红色</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:center;">MA1:MA(CLOSE,5),COLORRED；//5日均线设为红色</td></tr></tbody></table><p><strong>COLORWHITE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:center;">设为白色</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:center;">MA1:MA(CLOSE,5),COLORWHITE；//5日均线设为白色</td></tr></tbody></table><p><strong>COLORYELLOW</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:center;">设为黄色</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:center;">MA1:MA(CLOSE,5),COLORYELLOW；//5日均线设为黄色</td></tr></tbody></table><p><strong>COLORSTICK</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:center;">颜色柱状线：以零轴为中心画彩色棒状线，零轴下为阴线颜色，零轴上为阳线颜色</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:center;">CLOSE-OPEN,COLORSTICK;//收盘价大于开盘价画阳线颜色，收盘价小于开盘价画阴线颜色</td></tr></tbody></table><p><strong>CIRCLEDOT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:center;">画小圆圈线</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:center;">CLOSE,CIRCLEDOT;//收盘价画小圆圈线</td></tr></tbody></table><p><strong>NOAXIS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:center;">无坐标：不影响坐标最高最低值</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:center;">C,NOAXIS; //输出收盘价,但不影响坐标最高最低值,用于叠加到其它指标上</td></tr></tbody></table><p><strong>LINETHICK</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:center;">改变指标线粗细</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:center;">MA1:MA(CLOSE,5),LINETHICK3;//5日均线绘制使用3号粗细度</td></tr></tbody></table><h2 id="逻辑函数" tabindex="-1"><a class="header-anchor" href="#逻辑函数" aria-hidden="true">#</a> 逻辑函数</h2><p><strong>ALL</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">是否一直满足条件</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">ALL(X,N),统计 N 周期中是否一直都满足 X 条件,若 N=0 则从第一个有效值开始</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">ALL(CLOSE&gt;OPEN,20);//表示是否 20 周期内全部都收阳线，满足返回1，不满足返回0</td></tr></tbody></table><p><strong>ANY</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">是否存在</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">ANY(X,N)返回 N 周期内是否存在满足条件 X,N 可为常数或变量,若 N=0 则从第一个有效值开始</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">ANY(C&gt;O,10);//表示 10 个周期中存在阳线，存在返回1，不存在返回0</td></tr></tbody></table><p><strong>BETWEEN</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">介于两个数之间</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">BETWEEN(A,B,C)表示 A 处于 B 和 C 之间时返回 1，否则返回 0</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">BETWEEN(CLOSE,MA(CLOSE,10),MA(CLOSE,5));//表示收盘价介于5 日均线和10日均线之间，满足返回1，不满足返回0</td></tr></tbody></table><p><strong>CROSS</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">两条线交叉</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">CROSS(A,B)表示当 A 从下方向上穿过 B 时返回 1，否则返回 0</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">CROSS(MA(CLOSE,5),MA(CLOSE,10));//表示 5 日均线与 10 日均线交金叉</td></tr></tbody></table><p><strong>IF</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">根据条件求不同的值</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">IF(X,A,B)若 X 不为 0 则返回 A,否则返回 B</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">IF(CLOSE&gt;OPEN,HIGH,LOW);//表示该周期收阳则返回最高值，否则返回最低值</td></tr></tbody></table><p><strong>IFN</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">根据条件求不同的值</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">IFN(X,A,B)若 X 不为 0 则返回 B,否则返回 A</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">IFN(CLOSE&gt;OPEN,HIGH,LOW);//表示该周期收阴则返回最高值,否则返回最低值</td></tr></tbody></table><p><strong>ISDOWN</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">该周期是否收阴</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">ISDOWN()</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">ISDOWN();//当收盘价&lt;开盘价时，返回值为 1，否则为 0</td></tr></tbody></table><p><strong>ISEQUAL</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">该周期是否平盘</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">ISEQUAL()</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">ISEQUAL();//当收盘价=开盘价时，返回值为 1，否则为 0</td></tr></tbody></table><p><strong>ISLASTBAR</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">该周期是否为最后一个周期。</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">ISLASTBAR</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">ISLASTBAR;//最后一个周期返回值为 1，其余为 0</td></tr></tbody></table><p><strong>ISUP</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">该周期是否收阳。</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">SUP()</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">SUP();//当收盘价&gt;开盘价时，返回值为 1，否则为 0</td></tr></tbody></table><p><strong>LAST</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">持续存在</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">LAST(X,A,B)返回第前 A 周期到第前 B 周期是否一直满足条件 X <br> 若 A 为 0，表示从第一天开始，B 为 0，表示到最后日止</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">LAST(C&gt;O,10,5);//表示从第前10个周期到第前5个周期内一直是阳线，满足返回1，不满足返回0</td></tr></tbody></table><p><strong>LONGCROSS</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">两条线维持一定周期后交叉。</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">LONGCROSS(A,B,N)表示 A 在 N 周期内都小于 B，本周期从下方向上穿过 B 时返回 1，否则返回 0</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">LONGCROSS(MA(CLOSE,5),MA(CLOSE,10),5);//5日均线在5周期后与10日均线交金叉，满足返回1，不满足返回0</td></tr></tbody></table><p><strong>NOT</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">求逻辑非。</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">NOT(X)返回非 X,即当 X=0 时返回 1，否则返回 0</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">NOT(ISUP);//表示平盘或收阴</td></tr></tbody></table><p><strong>RANGE</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">介于某个范围之间。</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">RANGE(A,B,C)表示 A 大于 B 同时小于 C 时返回 1，否则返回 0</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">RANGE(CLOSE,MA(CLOSE,5),MA(CLOSE,10));//表示收盘价大于5日均线并且小于10日均线，满足返回1，不满足返回0</td></tr></tbody></table><p><strong>VALID</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">判断指定值是否是有效数据</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">VALID(X)</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">VALID(X);//当 X 为有效数据时返回 1,否则返回 0</td></tr></tbody></table><p><strong>VALUEWHEN</strong></p><table><thead><tr><th style="text-align:left;">释义</th><th style="text-align:left;">条件跟随：当条件 COND 满足时，取当时的 DATA 的值，否则取得 VALUEWHEN 的前一个值。</th></tr></thead><tbody><tr><td style="text-align:left;">用法</td><td style="text-align:left;">VALUEWHEN(COND, DATA)</td></tr><tr><td style="text-align:left;">示例</td><td style="text-align:left;">VALUEWHEN(HIGH&gt;REF(HIGH,5),HIGH);// 表示当前最高价大于前五个周期最高价的最大值时返回当前最高价</td></tr></tbody></table><h2 id="动态行情" tabindex="-1"><a class="header-anchor" href="#动态行情" aria-hidden="true">#</a> 动态行情</h2><table><thead><tr><th style="text-align:left;">序号</th><th style="text-align:left;">函数名称</th><th style="text-align:left;">释义</th></tr></thead><tbody><tr><td style="text-align:left;">1</td><td style="text-align:left;">DYNAINFO(3)</td><td style="text-align:left;">取得最新动态行情: 昨收</td></tr><tr><td style="text-align:left;">2</td><td style="text-align:left;">DYNAINFO(4)</td><td style="text-align:left;">取得最新动态行情: 今开</td></tr><tr><td style="text-align:left;">3</td><td style="text-align:left;">DYNAINFO(5)</td><td style="text-align:left;">取得最新动态行情: 最高</td></tr><tr><td style="text-align:left;">4</td><td style="text-align:left;">DYNAINFO(6)</td><td style="text-align:left;">取得最新动态行情: 最低</td></tr><tr><td style="text-align:left;">5</td><td style="text-align:left;">DYNAINFO(7)</td><td style="text-align:left;">取得最新动态行情: 最新</td></tr><tr><td style="text-align:left;">6</td><td style="text-align:left;">DYNAINFO(8)</td><td style="text-align:left;">取得最新动态行情: 总手</td></tr><tr><td style="text-align:left;">7</td><td style="text-align:left;">DYNAINFO(9)</td><td style="text-align:left;">取得最新动态行情: 现手</td></tr><tr><td style="text-align:left;">8</td><td style="text-align:left;">DYNAINFO(10)</td><td style="text-align:left;">取得最新动态行情: 总额</td></tr><tr><td style="text-align:left;">9</td><td style="text-align:left;">DYNAINFO(12)</td><td style="text-align:left;">取得最新动态行情: 涨跌</td></tr><tr><td style="text-align:left;">10</td><td style="text-align:left;">DYNAINFO(13)</td><td style="text-align:left;">取得最新动态行情: 振幅</td></tr><tr><td style="text-align:left;">11</td><td style="text-align:left;">DYNAINFO(14)</td><td style="text-align:left;">取得最新动态行情: 涨幅</td></tr><tr><td style="text-align:left;">12</td><td style="text-align:left;">DYNAINFO(15)</td><td style="text-align:left;">取得最新动态行情: 委比</td></tr><tr><td style="text-align:left;">13</td><td style="text-align:left;">DYNAINFO(16)</td><td style="text-align:left;">取得最新动态行情: 委差</td></tr><tr><td style="text-align:left;">14</td><td style="text-align:left;">DYNAINFO(18)</td><td style="text-align:left;">取得最新动态行情: 委买</td></tr><tr><td style="text-align:left;">15</td><td style="text-align:left;">DYNAINFO(19)</td><td style="text-align:left;">取得最新动态行情: 委卖</td></tr><tr><td style="text-align:left;">16</td><td style="text-align:left;">DYNAINFO(20)</td><td style="text-align:left;">取得最新动态行情: 委买价</td></tr><tr><td style="text-align:left;">17</td><td style="text-align:left;">DYNAINFO(21)</td><td style="text-align:left;">取得最新动态行情: 委卖价</td></tr><tr><td style="text-align:left;">18</td><td style="text-align:left;">DYNAINFO(25)</td><td style="text-align:left;">取得最新动态行情: 买一量</td></tr><tr><td style="text-align:left;">19</td><td style="text-align:left;">DYNAINFO(26)</td><td style="text-align:left;">取得最新动态行情: 买二量</td></tr><tr><td style="text-align:left;">20</td><td style="text-align:left;">DYNAINFO(27)</td><td style="text-align:left;">取得最新动态行情: 买三量</td></tr><tr><td style="text-align:left;">21</td><td style="text-align:left;">DYNAINFO(28)</td><td style="text-align:left;">取得最新动态行情: 买一价</td></tr><tr><td style="text-align:left;">22</td><td style="text-align:left;">DYNAINFO(29)</td><td style="text-align:left;">取得最新动态行情: 买二价</td></tr><tr><td style="text-align:left;">23</td><td style="text-align:left;">DYNAINFO(30)</td><td style="text-align:left;">取得最新动态行情: 买三价</td></tr><tr><td style="text-align:left;">24</td><td style="text-align:left;">DYNAINFO(31)</td><td style="text-align:left;">取得最新动态行情: 卖一量</td></tr><tr><td style="text-align:left;">25</td><td style="text-align:left;">DYNAINFO(32)</td><td style="text-align:left;">取得最新动态行情: 卖二量</td></tr><tr><td style="text-align:left;">26</td><td style="text-align:left;">DYNAINFO(33)</td><td style="text-align:left;">取得最新动态行情: 卖三量</td></tr><tr><td style="text-align:left;">27</td><td style="text-align:left;">DYNAINFO(34)</td><td style="text-align:left;">取得最新动态行情: 卖一价</td></tr><tr><td style="text-align:left;">28</td><td style="text-align:left;">DYNAINFO(35)</td><td style="text-align:left;">取得最新动态行情: 卖二价</td></tr><tr><td style="text-align:left;">29</td><td style="text-align:left;">DYNAINFO(36)</td><td style="text-align:left;">取得最新动态行情: 卖三价</td></tr><tr><td style="text-align:left;">30</td><td style="text-align:left;">markettime</td><td style="text-align:left;">获取主图品种市场的最新时间：markettime;获取指定市场的最新时间：markettime(&#39;SH&#39;);</td></tr></tbody></table><h2 id="绘图函数" tabindex="-1"><a class="header-anchor" href="#绘图函数" aria-hidden="true">#</a> 绘图函数</h2><p><strong>BARSSET</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">绘制标记.</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">BARSSET(COND,PRICE,N,OFFSET),当 COND 条件满足时，在 PRICE 位置绘制标记。N 为所影响到的周期数。OFFSET为影响周期的偏移，0 为以中心点前后影响，负数为往前影响，正数为向后影响。该函数通常用在逻辑公式中。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">BARSSET( BARPOS=100,HIGH ,10 ,0);//以第100根k线位置，前后10个周期内绘制标记。</td></tr></tbody></table><p><strong>COLORRGB</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">将红，绿，蓝三基色混和成一个颜色值。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">COLORRGB(R,G,B)R,G,B 分别取值为 0－255。该函数仅用在 DRAWTEXT 等画线函数中 COLOR 参数指定颜色使用。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">DRAWTEXT(CLOSE/OPEN&gt;1.08,LOW,&#39;大阳线&#39;,COLORRGB(255,0,0));//将显示红色的大阳线文字。<br> 若用户需指定指标线颜色，请使用 COLOR00FFFF 等这种语法</td></tr></tbody></table><p><strong>DRAWTEXT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">在图形上显示文字。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">DRAWTEXT(COND,PRICE,TEXT[,COLOR,ALIGN]),当 COND 条件满足时,在 PRICE 位置书写文字 TEXT。COLOR(可选参数)文字颜色,ALIGN(可选参数)对齐方式 0 中对齐;1 左对齐;2 右对齐;3 图中;4 图上;5 图下。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">DRAWTEXT(CLOSE/OPEN&gt;1.08,LOW,&#39;大阳线&#39;);//表示当日涨幅大于 8%时在最低价位置显示&quot;大阳线&quot;字样</td></tr></tbody></table><p><strong>KLINE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">在图形上绘制 K 线.</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">KLINE(O,H,L,C,T)O,H,L,C 分别为开高低收T<br>为绘制类型,0 表示与主图 K 线画法相同,1 表示不影响坐标高低值,可用于叠加在其它指标上</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">例 1：KLINE(O,H,L,C,0);<br> 例 2：在 KDJ 公式中叠加 KLINE(O,H,L,C,1);</td></tr></tbody></table><p><strong>VERTLINE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">在图形上绘制垂直线。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">VERTLINE(COND,[PRICE1,PRICE2,COLOR,WIDTH,TYPE])<br>当 COND 条件满足时，在 PRICE1 和 PRICE2 之间画线。<br>PRICE1 和 PRICE2 均省略时表示在窗格高低之间画垂直线<br>COLOR(可选参数)为线颜色<br>WIDTH(可选参数)为线的宽度<br>TYPE(可选参数)为线的风格分别为：<br>VTSOLID 普通线<br>VTDASH 虚线<br>VTDOT 点线<br>VTDASHDOT 虚线和点交替<br>VTDASHDOTDOT 虚线和两点交替。<br>除了 VTSOLID 风格以外，其他风格必须保证 WIDTH 为 1 时才有效。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">VERTLINE(c&gt;o,10,20,colorred,1,VTDASH);//K线收阳，在10-20间使用1号粗细度画普通线</td></tr></tbody></table><p><strong>DRAWICON</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">在图形上绘制小图标。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">DRAWICON(COND,PRICE,TYPE[,ALIGN]),当 COND 条件满足时,在 PRICE 位置画TYPE 号图标。<br>ALIGN(可选参数)对齐方式 ,0 图标中对齐;1 图标上缘;2 图标中缘;3 图中;4图上;5 图下<br>例如：DRAWICON(CLOSE&gt;OPEN,LOW,1)表示当收阳时在最低价位置画 1 号图标。<br>绘制图标按照“符号”工具栏对应排列，如果要自定义绘制的图标，请在“自定义”工具栏操作里将对应的图标修改即可。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">DRAWICON(CLOSE&gt;OPEN,LOW,1);//当收阳时在最低价位置画1号图标</td></tr></tbody></table><p><strong>DRAWBMP</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">在图形上绘制位图。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">DRAWBMP(COND,PRICE,BMPFILE[,ALIGN]),当 COND 条件满足时,在 PRICE 位置画 BMPFILE 文件名指定的 BMP 位图，ALIGN(可选参数)对齐方式 ,0 图标中对齐;1 图标上缘;2 图标中缘;3 图中;4图上;5 图下<br>(初始路径与\DOCUMENT 目录的文档 *.STK 文件放在一起)。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">DRAWBMP(CLOSE&gt;OPEN,LOW,&#39;SUN&#39;);//表示当收阳时在最低价位置画 SUN.BMP 位图</td></tr></tbody></table><p><strong>DRAWNUMBER</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">在图形上显示数字。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">DRAWNUMBER(COND,PRICE,NUMBER,PRECISION[,COLOR,ALIGN])当 COND 条件满足时,在 PRICE 位置书写数字 NUMBER,PRECISION 为小数显示位数(取值范围 0-7)，其中 0-6 表示位数，7 表示自动显示位数。<br>COLOR(可选参数)为数字颜色。<br>ALIGN(可选参数)对齐方式 0 中对齐;1 左对齐;2 右对齐;3 图中;4 图上;5 图下。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">DRAWNUMBER(CLOSE/OPEN&gt;1.08,HIGH,(CLOSE-REF(C,1))/REF(C,1)*100,2);//表示当日涨幅大于 8%时在最高价位置显示涨幅(相对开盘价的百分比)。</td></tr></tbody></table><p><strong>VOLSTICK</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">将数据画成柱状线</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:left;">VOL,VOLSTICK;画成交量柱状线</td></tr></tbody></table><p><strong>STACKVOLSTICK</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">将数据画成叠加柱状线</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:left;">VOL,stackvolstick;画成交量柱状线</td></tr></tbody></table><h2 id="字符串函数" tabindex="-1"><a class="header-anchor" href="#字符串函数" aria-hidden="true">#</a> 字符串函数</h2><p><strong>MARKETNAME</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得当前品种的市场名称</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">MARKETNAME(),将返回当前品种的市场名称</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">MARKETNAME();//主图为沪市标的返回&quot;上证所&quot;;主图为深市标的返回&quot;深交所&quot;</td></tr></tbody></table><p><strong>INBLOCK</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">判断本股票是否板块成员</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">INBLOCK(S),若本股票是板块 S 的成员将返回 1，否则返回 0.</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">INBLOCK(&#39;工业板块&#39;);//若本股票属于工业板块则返回 1,不属于返回0</td></tr></tbody></table><p><strong>LOWERSTR</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">将字符串转换为小写。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">LOWERSTR(STR),将返回 STR 对应的小写字符串</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">LOWERSTR(&#39;EFGH&#39;);//将返回&quot;efgh&quot;</td></tr></tbody></table><p><strong>LTRIM</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">除去字符串开始空格</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">LTRIM(STR)</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">LTRIM(&#39; SH&#39;);//将返回 SH</td></tr></tbody></table><p><strong>MARKETLABEL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得当前品种的市场代码</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">MARKETLABEL(),将返回当前品种的市场代码</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">MARKETLABEL();//沪市标的返回&quot;SH&quot;,深市标的返回&quot;SZ&quot;</td></tr></tbody></table><p><strong>MARKETLABEL1</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得当前品种的市场代码。<br>较 MARKETLABEL,MARKETLABEL1 返回值更加精确</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">MARKETLABEL1(),将返回当前品种的市场代码</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">MARKETLABEL1();//上证 A 股返回&quot;SHZB&quot;,深证主板返回&quot;SZZB&quot;,深证中小板返回&quot;SZZX&quot;,深圳创业板返回&quot;SZCY&quot;,其他板块的返回值与 MARKETLABEL 函数相同。</td></tr></tbody></table><p><strong>NUMTOSTR</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">将数字转化为字符串，用户可以设定精度</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">NUMTOSTR(N,M),将 N 转化为字符串返回，精确到小数点后 M 位</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">NUMTOSTR(CLOSE,5)；//将返回收盘价对应的字符串，例如&quot;15.78000&quot;</td></tr></tbody></table><p><strong>RTRIM</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">除去字符串尾部空格</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">RTRIM(STR)</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">RTRIM(&#39;SH &#39;);//将返回 SH</td></tr></tbody></table><p><strong>STKLABEL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得品种代码</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STKLABEL()将返回当前品种的代码</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STKLABEL();//例如主图标的为浦发银行将返回600000</td></tr></tbody></table><p><strong>STKNAME</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得品种名称</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STKNAME(),将返回当前品种的名称</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STKNAME();//例如主图标的为浦发银行将返回&quot;浦发银行&quot;</td></tr></tbody></table><p><strong>STRCAT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">把一个字符串添加到另一个字符串中</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STRCAT(DES,STR),将 STR 字符串添加到 DES 字符串末尾</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STRCAT(&#39;ABC&#39;,&#39;DEF&#39;);//将返回&quot;ABCDEF&quot;</td></tr></tbody></table><p><strong>STRCMP</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">字符串比较</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STRCMP(STR1,STR2),若 STR1&gt;STR2 则返回 1，STR1&lt;STR2 返回-1，若STR1=STR2 返回 0</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STRCMP(&#39;ABCDEF&#39;,&#39;ABC&#39;);//返回1 表示&#39;ABCDEF&#39;&gt;&#39;ABC&#39;</td></tr></tbody></table><p><strong>STRFIND</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">在字符串中查找另一个字符串</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STRFIND(STR,S1,N),从字符串 STR 的第 N 个字符开始查找字符串 S1,返回找到的位置，若没有找到就返回 0</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STRFIND(&#39;ABCDEFGH&#39;,&#39;CDE&#39;,1);//将返回 3</td></tr></tbody></table><p><strong>STRICMP</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">忽略大小写比较字符串</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STRICMP(STR1,STR2),若 STR1&gt;STR2 则返回 1，STR1&lt;STR2 返回-1，若STR1=STR2返回 0</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STRCMP(&#39;ABCDEF&#39;,&#39;ABC&#39;);//返回 1表示&#39;ABCDEF&#39;&gt;&#39;ABC&#39;</td></tr></tbody></table><p><strong>STRINGTOFILE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">输出指定的字符串到一个指定的文件中<br>用户可以在公式中通过输出指定的字符串到文件来实现调试或者其他的目的.借此可以借助这个功能来完成监控公式运行的各种细节参数.该函数用法与DEBUGFILE2基本相同，唯一区别是该函数在写文件时会自动清空之前文件中写入的数据</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STRINGTOFILE(PATH,STR),PATH 为用户的本地计算机路径,STR 为用户指定输出的一个行文字</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STRINGTOFILE(&#39;D:TEST.TXT&#39;,&#39;当前资产为 1000&#39;);//将在公式的监控部分输出到 D:TEST.TXT 文件.<br>如果字符串输出中涉及到数字变量，可以使用 NUMTOSTR 函数转化成字符串后，然后再进行相加</td></tr></tbody></table><p><strong>STRINSERT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">从指定位置插入一个子字符串</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STRINSERT(STR,INDEX,STR1)，在 STR 字符串的第 INDEX 后方开始插入字符串STR1</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STRINSERT(&#39;ABCDEF&#39;,2,&#39;ZZZ&#39;)；//函数将返回&quot;ABZZZCDEF&quot;</td></tr></tbody></table><p><strong>STRLEFT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得字符串的左边部分</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STRLEFT(STR,N),返回字符串 STR 的左边 N 个字符</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STRLEFT(&#39;ABCDEF&#39;,3);//将返回&quot;ABC&quot;</td></tr></tbody></table><p><strong>STRLEN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求字符串的长度</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STRLEN(STR),将返回 STR 字符串的长度，由于系统采用 ANSI 字符编码，一个汉字等于 2 个字节</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STRLEN(&#39;ABCD&#39;);//将返回4</td></tr></tbody></table><p><strong>STRMID</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得字符串的中间部分</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STRMID(STR,N,M),返回字符串STR 的第N 个字符开始的长度为M 个字符的字符串</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STRMID(&#39;ABCDEF&#39;,3,3);//将返回&quot;CDE&quot;</td></tr></tbody></table><p><strong>STRNCMP</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">指定长度比较字符串</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STRNCMP(STR1,STR2,LEN)</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">VAR1:STRNCMP(STKNAME,&#39;ST&#39;,2)=0;// 若返回 1 表示该股为 ST 股</td></tr></tbody></table><p><strong>STRREMOVE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">从指定位置开始的地方删除一个或多个字符</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STRREMOVE(STR,INDEX,COUND)，在 STR 字符串的第 INDEX 地方开始删除 COUND个字符</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STRREMOVE(&#39;ABCDEF&#39;,2,2)函数将返回&quot;ABEF&quot;</td></tr></tbody></table><p><strong>STRREPLACE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">用一个字符替换另一个字符</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STRREPLACE(STR,STROLD,STRNEW),将 STR 字符串中的 STROLD 替换为 STRNEW<br>在替换之后,该字符串有可能增长或缩短；那是因为STRNEW和STROLD的长度不需要是相等的.</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STRREPLACE(&#39;ABCDEFG&#39;,&#39;BCD&#39;,&#39;ZZZ&#39;);//函数将返回&quot;AZZZEFG&quot;</td></tr></tbody></table><p><strong>STRRIGHT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得字符串的右边部分</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STRRIGHT(STR,N),返回字符串 STR 的右边 N 个字符</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STRRIGHT(&#39;ABCDEF&#39;,3)得到&quot;DEF&quot;</td></tr></tbody></table><p><strong>STRTONUM</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">将字符串转化为数字</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STRTONUM(STR),将 STR 转化为数字返回</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STRTONUM(&#39;12.5&#39;);//将返回数值 12.5</td></tr></tbody></table><p><strong>STRTRIMLEFT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">整理字符串左边</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STRTRIMLEFT(STR,STR1),将一群特定的字符 STR1 从字符串 STR 的开始处删除</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">TRTRIMLEFT(&#39; ABC&#39;,&#39; &#39;);//函数将返回&quot;ABC&quot;</td></tr></tbody></table><p><strong>STRTRIMRIGHT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">整理字符串右边</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STRTRIMLEFT(STR,STR1),将一群特定的字符 STR1 从字符串 STR 的末尾处删除</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STRTRIMRIGHT(&#39;ABC &#39;,&#39; &#39;);//函数将返回&quot;ABC&quot;</td></tr></tbody></table><p><strong>UPPERSTR</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">将字符串转换为大写</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">UPPERSTR(STR),将返回 STR 对应的大写字符串</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">UPPERSTR(&#39;abcd&#39;);//将返回&quot;ABCD&quot;</td></tr></tbody></table><h2 id="引用函数" tabindex="-1"><a class="header-anchor" href="#引用函数" aria-hidden="true">#</a> 引用函数</h2><p><strong>BARSCOUNT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求有效周期数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">BARSCOUNT(X)第一个有效数据到当前的天数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">BARSCOUNT(CLOSE);//取得上市以来总交易日数</td></tr></tbody></table><p><strong>BACKSET</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">将满足条件时当前位置到若干周期前的数据设为 1 ，条件不满足返回0</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">BACKSET(X,N),若 X 非 0,则将当前位置到 N 周期前的数值设为 1</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">BACKSET(CLOSE&gt;OPEN,2);<br>若收阳则将该周期及前一周期数值设为 1,否则返回 0</td></tr></tbody></table><p><strong>BARSLAST</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">上一次条件成立到当前的周期数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">BARSLAST(X):上一次X不为0到现在的天数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">BARSLAST(CLOSE/REF(CLOSE,1)&gt;=1.1);//表示上一个涨停板到当前的周期数<br>如果没有符合条件的周期，函数将返回0</td></tr></tbody></table><p><strong>BARSSINCE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">第一个条件成立到当前的周期数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">BARSSINCE(X):第一次X不为0到现在的天数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">BARSSINCE(HIGH&gt;10);//表示股价超过10元时到当前的周期数<br>如果没有符合条件的周期，函数将返回0</td></tr></tbody></table><p><strong>BARSSINCEN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">N 个周期内第一个条件成立到当前的周期数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">BARSSINCEN(X,N):N 周期内第一次 X 不为 0 到现在的周期数,N 大于或等于 2</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">BARSSINCEN(HIGH&gt;10,N);//表示 N 个周期内的股价超过 10 元时到当前的周期数如果没有符合条件的周期，函数将返回0</td></tr></tbody></table><p><strong>COUNT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">统计满足条件的周期数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">COUNT(X,N),统计 N 周期中满足 X 条件的周期数,若 N=0 则从第一个有效值开始</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">COUNT(CLOSE&gt;OPEN,20);//表示统计 20 周期内收阳的周期数</td></tr></tbody></table><p><strong>CALLSTOCK</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">引用同期的其他证券数据</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">CALLSTOCK(CODE,TYPE[,CYC,N]),引用指定品种代码为 CODE,周期为 CYC(可选)若不填或者为-1 表示使用当前周期,类型为 TYPE 的数据<br>N 为左右偏移周期个数（可选）0 表示引用当前数据，&lt;0 为引用之前数据，&gt;0为引用之后数据。<br>其中 TYPE 的值可为 VTOPEN(开盘) VTHIGH(最高) VTLOW(最低) VTCLOSE(收盘)<br>VTVOL(成交量) VTAMOUNT(成交额) vtOPENINT(持仓量) VTADVANCE(涨数,大盘有效) VTDECLINE(跌数,大盘有效)以及外部数据和万德数据<br>如果找不到同期数据，那么将返回最近的一个。<br>CYC 范围为 0-19，分别表示<br>0:分笔成交、1:1 分钟、2:5 分钟、3:15 分钟、4:30 分钟、5:60 分钟<br>6:日、7:周、8:月、9:年、10:多日、11:多分钟、12:多秒<br>13:多小时、14:季度线、15:半年线、16:节气线、17:3 分钟、18:10 分钟、19:多笔线</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">CALLSTOCK(&#39;SH600000&#39;,VTCLOSE,6,-1);//表示引用昨日SH市场的 600000 的日线收盘价<br>CALLSTOCK(&#39;SH600000&#39;,VTOPEN)表示引用 SH 市场的 600000的日开盘价，使用当前周期<br>引用数据时，需要实现确认被引用品种周期数据齐全，再首次使用或者在不确定时，请手工进行数据补充工作</td></tr></tbody></table><p><strong>CURRBARSCOUNT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求到最后交易日的周期数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">CURRBARSCOUNT 求到最后交易日的周期数</td></tr></tbody></table><p><strong>DMA</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求动态移动平均</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">DMA(X,A),求 X 的动态移动平均。<br>算法: 若 Y=DMA(X,A)<br>则 Y=A*X+(1-A)*Y&#39;,其中 Y&#39;表示上一周期 Y 值,A 必须小于 1。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">DMA(CLOSE,VOL/CAPITAL());//表示求以换手率作平滑因子的平均价</td></tr></tbody></table><p><strong>DRAWNULL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得一个无效数字，不输出值</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:left;">IF(CLOSE&gt;REF(CLOSE,1),CLOSE,DRAWNULL);//当前周期收盘价小于上一周期收盘价时不输出值</td></tr></tbody></table><p><strong>EMA</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求指数平滑移动平均</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">EMA(X,N),求 X 的 N 日指数平滑移动平均。算法：若 Y=EMA(X,N)<br>则 Y=[2*X+(N-1)*Y&#39;]/(N+1),其中 Y&#39;表示上一周期 Y 值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">EMA(CLOSE,30);//表示求 30 日指数平滑均价</td></tr></tbody></table><p><strong>FILTER</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">过滤连续出现的信号</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">FILTER(X,N):X 满足条件后，删除其后 N 周期内的数据置为 0</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">FILTER(CLOSE&gt;OPEN,5);//查找阳线，5 天内再次出现的阳线不被记录在内</td></tr></tbody></table><p><strong>HHV</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求最高值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">HHV(X,N),求 N 周期内 X 最高值,N=0 则从第一个有效值开始</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">HHV(HIGH,30);//表示求 30 日最高价</td></tr></tbody></table><p><strong>HHvbRS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求上一高点到当前的周期数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">HHvbRS(X,N):求 N 周期内 X 最高值到当前周期数，N=0 表示从第一个有效值开始统计</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">HHvbRS(HIGH,0);//求得历史新高到到当前的周期数</td></tr></tbody></table><p><strong>HOD</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求高值名次</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">HOD(X,N):求当前 X 数据是 N 周期内的第几个高值,N=0 则从第一个有效值开始</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">HOD(HIGH,20);//返回当前最高价是20个周期内的第几个高价</td></tr></tbody></table><p><strong>IMA</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求指数权重移动平均</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">IMA(X,N,S)求 X 的 N 日 S 系数权重的指数移动平均，S 如果小于 100 表示远期权重大于近期权重，大于 100 表示近期的权重大于远期权重，等于 100 就相当于 MA</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">IMA(CLOSE,10,120);//表示求收盘价 10 日的 120%指数权重移动平均</td></tr></tbody></table><p><strong>LLV</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求最低值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">LLV(X,N),求 N 周期内 X 最低值,N=0 则从第一个有效值开始</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">LLV(LOW,0);//表示求历史最低价</td></tr></tbody></table><p><strong>LLvbRS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求上一低点到当前的周期数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">LLvbRS(X,N):求 N 周期内 X 最低值到当前周期数，N=0 表示从第一个有效值开始统计</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">LLvbRS(HIGH,20);//求得 20 个周期内最低点到当前的周期数</td></tr></tbody></table><p><strong>LOD</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求低值名次</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">LOD(X,N):求当前 X 数据是 N 周期内的第几个低值,N=0 则从第一个有效值开始</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">LOD(LOW,20);//返回当前最低价是 20 个周期内的第几个低价</td></tr></tbody></table><p><strong>MA</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求简单移动平均</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">MA(X,N),求 X 的 N 日移动平均值。算法：(X1+X2+X3+...+XN)/N</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">MA(CLOSE,10);//表示求 10 日均价</td></tr></tbody></table><p><strong>MEDIAN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取若干指定周期的中位数据</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">MEDIAN(X,N),取 N 周期 X 的中数，如果 N 是奇数，取排完序的 X 中间一个元素；如果偶数，取中间两个的平均值返回</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">MEDIAN(CLOSE,3);//表示取近3个周期收盘价排序后的中间数</td></tr></tbody></table><p><strong>NEWHBARS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">在历史上所有比当前数值高的数值序列中，离当前第 N 个近的数字到当前的周期数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">NEWHBARS(X,N):求高于当前周期 X 的第 N 个 x 的距离</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">NEWHBARS(HIGH,1);//表示高于当前周期 h 的上一个 h 距离当前的周期数，即，今天的 h，创了多少个周期以来的新高</td></tr></tbody></table><p><strong>NEWLBARS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">在历史上所有比当前数值低的数值序列中，离当前第 N 个近的数字到当前的周期数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">NEWLBARS(X,N):求低于当前周期 X 的第 N 个 x 的距离</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">NEWLBARS(LOW,1);//表示低于当前周期 l 的上一个 l 距离当前的周期数，即，今天的 l，创了多少个周期以来的新低</td></tr></tbody></table><p><strong>REF</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">引用若干周期前的数据</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">REF(X,A),引用 A 周期前的 X 值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">REF(CLOSE,1);//表示上一周期的收盘价，在日线上就是昨收</td></tr></tbody></table><p><strong>REFDATE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">引用自 1900 年以来指定日期的数据</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">REFDATE(X,DATE[,TIME]),引用 DATE 日期 TIME （可省略）的 X 值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">REFDATE(CLOSE,20011208);//表示 2001 年 12 月 08 日的收盘价;<br>REFDATE(CLOSE,20011208, 133030);//表示 2001 年 12 月 08 日 13:30:30 的收盘价<br>TIME 参数可省略使用，省略时间一般用在日线及其以上周期使用，对于日线以下周期则一般需要带时间参数。<br>注意：对于逐 K 线运行模式，X 值不可以引用到未来数据，但是序列模式则无</td></tr><tr><td style="text-align:center;">此限</td><td style="text-align:left;"></td></tr></tbody></table><p><strong>REFX</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">引用若干周期后的数据</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">REFX(X,A),引用 A 周期后的 X 值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">REFX(CLOSE,1);//表示后一周期的收盘价，在日线上就是明收</td></tr></tbody></table><p><strong>RET</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">按时间引用若干周期前的数据</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">RET(X,A),引用 A 周期时间前的 X 值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">RET(CLOSE,10);//在日线上表示引用 10 天前的收盘价</td></tr></tbody></table><p><strong>SFILTER</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">过滤连续出现的信号</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SFILTER(X,COND):X 满足条件后，将其后所有周期内的数据置为 0,直到 COND条件满足为止</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">SFILTER(CLOSE&gt;OPEN,CLOSE&lt;OPEN);//查找阳线，再次出现的阳线不被记录在内,直到出现阴线后再次出现阳线为止</td></tr></tbody></table><p><strong>SMA</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求移动平均</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SMA(X,N,M),求 X 的 N 日移动平均，M 为权重。<br>算法: 若 Y=SMA(X,N,M)<br>则 Y=[M*X+(N-M)*Y&#39;)/N,其中 Y&#39;表示上一周期 Y 值,N 必须大于 M</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">SMA(CLOSE,30,1);//表示求 30 日移动平均价</td></tr></tbody></table><p><strong>STKINDI</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">引用任意品种任意周期的任意指标输出</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STKINDI(STKLABEL,INDINAME,CO,PERIOD[,m,n])<br>STKLABEL 指定品种代码，如为空表示当前品种<br>INDINAME 为指标公式调用<br>CO 为坐标轴类型 0 交易日坐标 1 自然日 2 交易交易时间<br>PERIOD 为周期类型，有效值范围为(0-19)，依次表示:<br>0:分笔成交、1:1 分钟、2:5 分钟、3:15 分钟、4:30 分钟、5:60 分钟、6:日、7:周、8:月、9:年、10:多日、11:多分钟、12:多秒、13:多小时、14:季度线、15:半年线、16:节气线、17:3 分钟、18:10 分钟、19:多笔线<br>m 为左右偏移周期个数（可选），0 表示引用当前数据，小于 0 为引用之前数据，大于 0 为引用之后数据<br>n 为 0,1,2,3,4 表示复权数据类型,0 为不复权,1 为前复权,2 为后复权,3 为等比前复权,4 为等比后复权</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STKINDI(&#39;1A0001&#39;,&#39;MA.MA1&#39;,0,DATAPERIOD);<br>计算 1A0001 的当前周期 MA 指标的 MA1 指标线<br>STKINDI(&#39;&#39;,&#39;RSI.RSI1&#39;,0,6);<br>计算当前品种的日线周期 RSI 指标的 RST1 指标线<br>STKINDI(&#39;SH600000&#39;,&#39;RSI&#39;,0,6,-1);<br>引用昨日 SH 市场 600000 品种的日线周期 RSI 指标最后—行输出并且使用公式的默认参数<br>若参数为数字变量，那么需要有个字符串转换的过程<br>s:=5;<br>m:=NUMTOSTR(s,0);//NUMTOSTR 函数将数字转换到字符串，再带入变量中<br>vola:stkindi(&#39;if10&#39;,&#39;ATR.ATR&#39;,0,6,-1);//计算 IF10 合约的日线周期指标ATR 的 ATR 指标线，传递参数 m 值为 5。<br>第 2 个参数&#39;&#39;里的是文本，由三部分组成：&#39;ATR.ATR(&#39;和 m 和&#39;)&#39;,这三部分由两个连接符号&amp;连接起来，实现对数值参数的文本传输。引用数据时，需要实现确认被引用品种周期数据齐全，再首次使用或者在不确定时，请手工进行数据补充工作</td></tr></tbody></table><p><strong>SMA</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求总和</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SUM(X,N),统计 N 周期中 X 的总和,N=0 则从第一个有效值开始</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">SUM(VOL,0);//表示统计从上市第一天以来的成交量总和</td></tr></tbody></table><p><strong>SUMBARS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">向前累加到指定值到现在的周期数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SUMBARS(X,A);将 X 向前累加直到大于等于 A,返回这个区间的周期数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">SUMBARS(CLOSE,200);//求收盘价累加大于200所用的周期数</td></tr></tbody></table><p><strong>TMA</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求递归移动平均</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">TMA(X,N,M),求 X 的递归移动平均，N、M 为权重</td></tr><tr><td style="text-align:center;">算法</td><td style="text-align:left;">若 Y=TMA(X,N,M) 则 Y=(N<em>Y&#39;+M</em>X), 其中 Y&#39;表示上一周期 Y 值。初值为 M*X</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">MA(CLOSE,0.9,0.1);//表示求 X 的递归移动平均</td></tr></tbody></table><p><strong>TODAYBAR</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求当日数据周期的数量</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">TODAYBAR,得到当日从开盘以来到现在的周期数量</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">TODAYBAR;//若在1分钟周期返回20，表示当日1分钟K线已生成20个周期</td></tr></tbody></table><p><strong>TODAYBAR</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求真实波幅</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">TR,求真实波幅</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ATR:=MA(TR,10);//表示求真实波幅的 10 周期均值</td></tr></tbody></table><p><strong>TRMA</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">三角移动平均</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">TRMA(X,N)求 X 在 N 周期内的三角移动平均<br>三角移动平均计算方法:第1 种可能先算(奇数+1)/2 周期移动平均,得出值再算这个值的(奇数+1)/2 周期的移动平均.<br>第2 种可能先算偶数/2 周期移动平均,得出值再算这个值的(偶数/2+1)周期的移动平均，<br>也就是先判断一下 N 是奇数还是偶数，然后再选对应的计算式</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">TRMA(CLOSE,10);//求收盘价的 10 周期三角移动平均</td></tr></tbody></table><p><strong>WMA</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求加权移动平均</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">WMA(X,N),求 X 的加权移动平均</td></tr><tr><td style="text-align:center;">算法</td><td style="text-align:left;">若 Y=WMA(X,N) 则<br>Y=(N*X0+(N-1)*X1+(N-2)<em>X2)+...+1</em>XN)/(N+(N-1)+(N-2)+...+1)<br>X0 表示本周期值，X1 表示上一周期值...</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">WMA(CLOSE,20);//表示求 20 周期加权均价</td></tr></tbody></table><p><strong>gettreasury10y</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取十年期国债无风险利率</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">gettreasury10y(date,type),取十年期国债无风险利率</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">gettreasury10y(20170306,1);//取2017年3月5日的中债1年期收益率</td></tr></tbody></table><p><strong>getfindata</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">获取财务数据</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">表格名称CAPITALSTRUCTURE(股本结构)、PERSHAREINDEX(主要指标)、ASHAREINCOME(利润表)、ASHARECASHFLOW(现金流量表)、ASHAREBALANCESHEET(资产负债表)</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">getfindata(&#39;CAPITALSTRUCTURE&#39;,&#39;total_capital&#39;);//取总股本</td></tr></tbody></table><p><strong>getlonghubang</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">获取龙虎榜数据</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">getlonghubang(&#39;字段名&#39;,&#39;买卖方向&#39;,席位排行);<br>字段名:上榜日期,上榜原因,成交金额,交易营业部名称,买入金额,买入金额占总成交比例,卖出金额,卖出金额占总成交比例,净额<br>买卖方向:B或S<br>席位:1-5</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">getlonghubang(&#39;交易营业部名称&#39;,&#39;B&#39;,1);//取买一席位交易营业部名称</td></tr></tbody></table><p><strong>gettop10shareholder</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">获取十大股东数据</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">gettop10shareholder(&#39;类型名&#39;,&#39;字段名&#39;,排行);类型名和字段名中文或英文均可<br>类型名:流通股东(flow_holder),股东(holder)<br>字段名:股东名称(shareholder_name),股东类型(shareholder_type),持股数量(shareholder_quantity),变动原因(change_reason),持股比例(shareholder_ratio),股份性质(share_nature),持股排名(shareholder_rank)<br>排行:1-10</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">gettop10shareholder(&#39;flow_holder&#39;,&#39;shareholder_name&#39;,1);//获取第一大股东的名称</td></tr></tbody></table><h2 id="控制函数-1" tabindex="-1"><a class="header-anchor" href="#控制函数-1" aria-hidden="true">#</a> 控制函数</h2><p><strong>AND</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">逻辑与运算</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">A AND B 或 A &amp;&amp; B<br>表示条件 A 与条件 B 同时成立</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">COND:CLOSE&gt;OPEN AND HOLDING=0 ;//阳线并且持仓为0</td></tr></tbody></table><p><strong>BEGIN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">把多条语句看作一条语句</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">语法:BEGIN...END</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">IF CLOSE&gt;OPEN THEN<br>BEGIN<br> AA:=1;<br>END//若该周期收盘，将AA赋值为1</td></tr></tbody></table><p><strong>BREAK</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">跳出循环</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">语法:BREAK;</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">if ISLASTBAR()=1 then BEGIN<br> For i=1 TO 10 DO BEGIN<br> a:=a+1; <br>if i=5 then BREAK;<br> END<br>END//最后一根k上时，当A=5时，退出循环</td></tr></tbody></table><p><strong>DO</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">执行语句</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">FOR VAR=N1 TO N2 DO EXPR;<br>WHILE COND DO EXPR</td></tr></tbody></table><p><strong>EXIT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">终止公式执行.注意:逐 K 线模式下运行时,EXIT 的使用不当会导致比如 HHV,MA,等统计性质的函数计算出现失误,建议这些函数都要放在 EXIT 退出语句的前面保证每个周期都能执行到.</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">语法:EXIT;</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">if AA:=1 then begin <br> EXIT <br>end//若AA等于1，停止公式运行</td></tr></tbody></table><p><strong>FOR</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">循环语句</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">FOR...TO...DO...<br>FOR...DOWNTO...DO...</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">FOR VAR=N1 TO N2 DO EXPR;<br>从 VAR=N1 开始到 VAR=N2 开始循环执行 EXPR 语句，每执行一次 VAR 加 1<br>FOR VAR=N1 DOWNTO N2 DO EXPR2;<br>从 VAR=N1 开始到 VAR=N2 开始循环执行 EXPR 语句，每执行一次 VAR 减 1<br>注意:逐 K 线计算模式时，请尽量不要在 FOR 循环控制语句中使用 MA,HHV,LLV等带有序列变量的统计类函数,<br>虽然能通过编译,但是会运行不正常,应该把他们放在语句的外面计算</td></tr></tbody></table><p><strong>GLOBALVARIABLE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">申明并初始化超全局变量</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">GLOBALVARIABLE 除了不支持数组外其他使用均与 VARIABLE 普通全局变量相同，<br>唯一不同之处在与 GLOBALVARIABLE 超全局变量在不会每次从头刷新指标数据时重新被刷新计算，而是始终会记住最后一次被赋予的值。<br>超全局变量一般会在客户停止后台程式化交易或者关闭框架图表后销毁重置。</td></tr></tbody></table><p><strong>IF</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">根据条件求不同的值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">IF(X,A,B)若 X 不为 0 则返回 A,否则返回 B</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">IF(CLOSE&gt;OPEN,HIGH,LOW);//表示该周期收阳则返回最高值，否则返回最低值</td></tr></tbody></table><p><strong>INPUT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">申明并设置参数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">INPUT:PNAME1(DFT,MIN,MAX,STEP),PNAME2(DFT,MIN,MAX,STEP)...;<br>PNAME 表示参数名, DFT 表示缺省值<br>MIN 表示最小值,MAX 表示最大值<br>STEP 表示优化步长,除 DEFAULT 外都可省略</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">INPUT:N(5), M(10,1,100,2)<br> 表示定义参数 N,缺省值为 5<br>定义参数 M,缺省值为 10,最小值为 1,最大值为 100,优化步长为 2;</td></tr></tbody></table><p><strong>OR</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">逻辑或运算</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">A OR B 或 A</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">COND:CLOSE&gt;OPEN OR HOLDING=0 ;//阳线或者持仓为0</td></tr></tbody></table><p><strong>REPEAT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">循环语句</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">语法:REPEAT EXPR UNTIL COND<br>循环执行语句 EXPR 直到满足 COND 条件的时候才中止<br>注意:逐 K 线计算模式时，请尽量不要在 REPEAT 条件控制语句中使用MA,HHV,LLV 等带有序列变量的统计类函数,<br>虽然能通过编译,但是会运行不正常,应该把他们放在语句的外面计算</td></tr></tbody></table><p><strong>VARIABLE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">申明并初始化变量；variable 为全局变量申明语句，一般用在逐 K 线计算模式下声明一个全局变量或者在序列模式和逐 K 线模式下声明一个内部数组。序列模式下variable 申明的序列变量会被强制转换为常数，故与普通的常数变量是没有区别的，因此序列模式下的序列变量不要使用 variable 进行申明。</th></tr></thead><tbody><tr><td style="text-align:center;">语法</td><td style="text-align:left;">VARIABLE:VARNAME1=INITVALUE1,VARNAME2=INITVALUE2...;</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">VARIABLE:X=1,Y=CLOSE,ARR[10]=0,SARR[5]=&#39;STR&#39;;<br>表示定义常数变量 X 并初始化为 1,<br>申明序列变量 Y 并初始化为收盘价,<br>申明含 10 个浮点数的数组并全部初始化为 0<br>申明含 5 个字符串的数组并都初始化为&#39;STR&#39;</td></tr></tbody></table><p><strong>WHILE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">循环语句</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">WHILE COND DO EXPR<br>当满足 COND 条件的时候，循环执行语句 EXPR<br>注意:逐K 线计算模式时，请尽量不要在WHILE 条件控制语句中使用MA,HHV,LLV等带有序列变量的统计类函数,<br>虽然能通过编译,但是会运行不正常,应该把他们放在语句的外面计算</td></tr></tbody></table><h2 id="指标函数" tabindex="-1"><a class="header-anchor" href="#指标函数" aria-hidden="true">#</a> 指标函数</h2><p><strong>SAR</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">抛物转向</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SAR(N,S,M),N 为计算周期,S 为步长,M 为步长的极限值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">SAR(10,2,20);//表示计算 10 日抛物转向，步长为 2%，极限值为 20%</td></tr></tbody></table><p><strong>SARTURN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">抛物转向点</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SARTURN(N,S,M);N 为计算周期,S 为步长,M 为极值,若发生向上转向则返回 1，若发生向下转向则返回-1，否则为 0<br>其用法与 SAR 函数相同</td></tr></tbody></table><h2 id="统计函数" tabindex="-1"><a class="header-anchor" href="#统计函数" aria-hidden="true">#</a> 统计函数</h2><p><strong>BETA2</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">指定序列的贝塔系数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">BETA2(A1,A2,N);求 A1,A2,N 周期的贝塔系数，该系数表明 A1 每变动 1%,则A2 将变动 V%</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">BETA2(INDEXC,CLOSE,5);// 表示大盘收盘价与该品种的 5 周期贝塔系数</td></tr></tbody></table><p><strong>COVAR</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求 2 个序列的协方差</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">COVAR(X1,X2,N) 为 X1 与 X2 的 N 周期的协方差</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">COVAR(CLOSE,INDEXC,8);// 表示收盘价与大盘指数之间的 8 周期的协方差</td></tr></tbody></table><p><strong>MODE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">数据集中出现最多的值用法 返回在某一数组或数据</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">返回在某一数组或数据区域中出现频率最多的数值。同 MEDIAN 一样，MODE 也是一个位置测量函数。<br>MODE(array,N); array：序列变量或数组； N： 周期范围。<br>如果数据集合中不含有重复的数据，则 MODE 数返回错误值 N/A。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">MODE(array,N);//求数据集 array 中 N 周期内出现频率最多的数值</td></tr></tbody></table><p><strong>DEVSQ</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">数据偏差平方和</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">DEVSQ(X,N);//X：数值表达式，N：周期数</td></tr></tbody></table><p><strong>PEARSON</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回 Pearson（皮尔生）乘积矩相关系数 r，这是一个范围在 -1.0 到 1.0 之间（包括 -1.0 和 1.0 在内）的无量纲指数，反映了两个数据集合之间的线性相关程度。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">PEARSON(A,B,N),计算 A,B 序列的 N 周期乘积矩相关系数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">PEARSON(L,H,10);//表示最低价与最高价的 10 周期乘积矩相关系数</td></tr></tbody></table><p><strong>INTERCEPT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">利用现有的 x 值与 y 值计算直线与 y 轴的截距。截距为穿过已知的 known_x&#39;s和 known_y&#39;s 数据点的线性回归线与 y 轴的交点。当自变量为 0（零）时，使用INTERCEPT 函数可以决定因变量的值。例如，当所有的数据点都是在室温或更高的温度下取得的，可以用 INTERCEPT 函数预测在 0°C 时金属的电阻</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">INTERCEPT(Y,X,N),求序列 Y,X 的线性回归线截距,Y 为因变的观察值或数据集合,X 为自变的观察值或数据集合</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">INTERCEPT(L,H,5);//表示计算最低价和最高价的 5 周期线性回归线截距</td></tr></tbody></table><p><strong>KURT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回数据集的峰值。峰值反映与正态分布相比某一分布的尖锐度或平坦度。正峰值表示相对尖锐的分布。负峰值表示相对平坦的分布。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">KURT(X,N),计算数据集 X 的 N 周期峰值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">KURT(C,10);//表示收盘价的 10 周期峰值</td></tr></tbody></table><p><strong>BINOMDIST</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">一元二项式分布的概率值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">返回一元二项式分布的概率值。函数 BINOMDIST 适用于固定次数的独立试验，KURT(C,10),表示收盘价的 10 周期峰值当试验的结果只包含成功或失败二种情况，且当成功的概率在实验期间固定不变。例如，函数 BINOMDIST 可以计算三个婴儿中两个是男孩的概率。<br>BINOMDIST(A,B,P,F),A 为试验成功的次数,B 为独立试验的次数,P 为每次试验中成功的概率,为一逻辑值，用于确定函数的形式。如果 F 为 TRUE，函数BINOMDIST 返回累积分布函数，即至多 A 次成功的概率；如果为 FALSE，返回概率密度函数，即 A 次成功的概率</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">BINOMDIST(6,10,0.5,FALSE);//10 次试验成功 6 次的概率为(0.205078)</td></tr></tbody></table><p><strong>EXPONDIST</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回指数分布。使用函数 EXPONDIST 可以建立事件之间的时间间隔模型，例如，在计算银行自动提款机支付一次现金所花费的时间时，可通过函数 EXPONDIST 来确定这一过程最长持续一分钟的发生概率</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">EXPONDIST(A,B,F),A 为函数的数值,B 为参数值,F 为一逻辑值，指定指数函数的形式。如果 F 为 TRUE，函数 EXPONDIST 返回累积分布函数；如果 F 为 FALSE，返回概率密度函数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">EXPONDIST(0.2,10,TRUE);//返回累积分布函数<br>EXPONDIST(0.2,10,FALSE);//返回概率密度函数</td></tr></tbody></table><p><strong>FISHER</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">Fisher 变换</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">返回点 x 的 Fisher 变换。该变换生成一个正态分布而非偏斜的函数。使用此函数可以完成相关系数的假设检验。<br>FISHER(x)<br>X 为一个数字，在该点进行变换。<br>说明：<br>如果 x 为非数值型，函数 FISHER 返回错误值 #VALUE!。<br>如果 x ≤ -1 或 x ≥ 1，函数 FISHER 返回错误值 #NUM!。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">FISHER(0.75);//在点 0.75 进行 Fisher 变换的函数值(0.972955)</td></tr></tbody></table><p><strong>FISHERINV</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">反 Fisher 变换</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">返回 Fisher 变换的反函数值。使用此变换可以分析数据区域或数组之间的相关性。如果 y = FISHER(x)，则 FISHERINV(y) = x。<br>FISHERINV(y)<br>Y 为一个数值，在该点进行反变换。<br>说明：<br>如果 y 为非数值型，函数 FISHERINV 返回错误值 #VALUE!</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">FISHERINV(0.972955);//在点 0.972955 进行 Fisher 变换的反函数值(0.75)</td></tr></tbody></table><p><strong>HYPGEOMDIST</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回超几何分布。给定样本容量、样本总体容量和样本总体中成功的次数，函数HYPGEOMDIST 返回样本取得给定成功次数的概率。<br>使用函数 HYPGEOMDIST 可以解决有限总体的问题，其中每个观察值或者为成功或者为失败，且给定样本容量的每一个子集有相等的发生概率</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">HYPGEOMDIST(A,B,K,D),A 样本中成功的次数,B 样本容量,K 样本总体中成功的次数,D 样本总体的容量</td></tr></tbody></table><p><strong>FTEST</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">F 检验的结果</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">返回 F 检验的结果。F 检验返回的是当数组 1 和数组 2 的方差无明显差异时的单尾概率。可以使用此函数来判断两个样本的方差是否不同。例如，给定公立和私立学校的测试成绩，可以检验各学校间测试成绩的差别程度。</td></tr><tr><td style="text-align:center;">语法</td><td style="text-align:left;">FTEST(array1,array2,N)<br>Array1 第一个数组或数据区域。<br>Array2 第二个数组或数据区域。<br>N 数组数据周期数量</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">FTEST(C,H,10);//返回收盘价和最高价 10 周期内的检验结果</td></tr></tbody></table><p><strong>LARGE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">数据集中第 k 个最大值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">返回数据集中第 K 个最大值。使用此函数可以根据相对标准来选择数值。例如，可以使用函数 LARGE 得到第一名、第二名或第三名的得分</td></tr><tr><td style="text-align:center;">语法</td><td style="text-align:left;">LARGE(ARRAY,N,K)<br>ARRAY 为需要从中选择第 K 个最大值的数组或数据区域。<br>N 为数组的计算数据周期数量<br>K 为返回值在数组或数据单元格区域中的位置（从大到小排）。<br>说明<br>如果数组为空，函数 LARGE 返回错误值 #NUM!。<br>如果 K ≤ 0 或 K 大于数据点的个数，函数 LARGE 返回错误值 #NUM!。如<br>果区域中数据点的个数为 N，则函数 LARGE(ARRAY,1) 返回最大值，函数LARGE(ARRAY,N) 返回最小值。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">LARGE(C,10,3);//求收盘价的 10 周期内的第三个最大值</td></tr></tbody></table><p><strong>FORCAST</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">线性回归预测值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">FORCAST(X,N)为 X 的 N 周期线性回归预测值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">FORCAST(CLOSE,10);//表示求 10 周期线性回归预测本周期收盘价</td></tr></tbody></table><p><strong>DRL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">计算回归偏离度</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">DRL(X,N);得到 X 的 N 周期回归偏离度</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">DRL(C,10);//表示求收盘价的 10 周期回归偏离度</td></tr></tbody></table><p><strong>FORCAST2</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">曲线回归预测值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">FORCAST2(X,N)为 X 的 N 周期曲线(方程：y=a<em>x</em>x+b*x+c)回归预测值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">FORCAST2(CLOSE,10);//表示求 10 周期收盘价曲线回归预测本周期的值</td></tr></tbody></table><p><strong>DRL2</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">曲线回归偏离度</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">DRL2(X,N),得到X的N周期曲线回归偏离度</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">DRL2(C,10);//表示求收盘价的 10 周期曲线回归偏离度的值（%）</td></tr></tbody></table><p><strong>NOLOT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">交易家数取指定市场分类中、有效交易家数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">NOLOT(MARKET,D)MARKET为市场名称,D为分类序号（1指数;2A股;3B股;4基金;5债券;6权证）</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">NOLOT(&#39;SH&#39;,2);//表示取上海 A 股的总交易家数<br>使用该函数前，如果是在开盘以后才接入，那么请补充沪深股市分笔成交以后，刷新扩展统计数据</td></tr></tbody></table><p><strong>PERCENTILE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回区域中数值的第 K 个百分点的值。可以使用此函数来建立接受阈值。例如，可以确定得分排名在第 90 个百分点之上的检测侯选人。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">PERCENTILE(ARRAY,N,K)<br>ARRAY 为定义相对位置的数组或数据区域。N 数组的数据周期数据量<br>K 0 到 1 之间的百分点值，包含 0 和 1。<br>说明<br>如果 ARRAY 为空或其数据点超过 8,191 个，函数 PERCENTILE 返回错误值#NUM!。<br>如果 K 为非数字型，函数 PERCENTILE 返回错误值 #VALUE!。<br>如果 K &lt; 0 或 K &gt; 1，函数 PERCENTILE 返回错误值 #NUM!。<br>如果 K 不是 1/(N-1) 的倍数，函数 PERCENTILE 使用插值法来确定第 K 个百分点的值。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">若 ARRAY={1,3,2,4},N=4,K=0.3,上面列表中的数据在第 30 个百分点的值(1.9)</td></tr></tbody></table><p><strong>PERCENTRANK</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回特定数值在一个数据集中的百分比排位。此函数可用于查看特定数据在数据集中所处的位置。例如，可以使用函数 PERCENTRANK 计算某个特定的能力测试得分在所有的能力测试得分中的位置。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">PERCENTRANK(ARRAY,N,X,SIGNIFICANCE)<br>ARRAY 为定义相对位置的数组或数字区域。N 为数组的周期数量大小；X 为数组中需要得到其排位的值，SIGNIFICANCE 表示返回的百分数值的有效位数。说明 ：如果数组为空，函数 PERCENTRANK 返回错误值 #NUM!。 如果 SIGNIFICANE &lt;<br>1，函数 PERCENTRANK 返回错误值 #NUM!。如果数组里没有与 X 相匹配的值，函数PERCENTRANK 将进行插值以返回正确的百分比排位。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ARRAY={13,12,11,8,4,3,2,1,1,1},N=10,X=2,SIGNIFICANCE=3,2 在上面数据列表中的百分比排位（0.333)，因为该数据集中小于 2 的值有 3 个，而大于 2 的值有 6 个，因此为 3/(3+6)=0.333）</td></tr></tbody></table><p><strong>PERMUT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回从给定数目的对象集合中选取的若干对象的排列数。排列为有内部顺序的对象或事件的任意集合或子集。排列与组合不同，组合的内部顺序无意义。此函数可用于彩票抽奖的概率计算</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">PERMUT(A,B),A 表示对象个数的整数,B 表示每个排列中对象个数的整数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">PERMUT(100,3);//在上述条件下所有可能的排列数量(970200)</td></tr></tbody></table><p><strong>POISSON</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回泊松分布。泊松分布通常用于预测一段时间内事件发生的次数，比如一分钟内通过收费站的轿车的数量。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">POISSON(X,B,F),X 事件数,B 期望值,F 为一逻辑值，确定所返回的概率分布形式。如果 F 为 TRUE，函数 POISSON 返回泊松累积分布概率，即，随机事件发生的次数在 0 到 x 之间（包含 0 和 1）；如果为 FALSE，则返回泊松概率密度函数，即，随机事件发生的次数恰好为 x。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">POISSON(0.2,10,TRUE);//返回泊松累积分布概率<br>POISSON(0.2,10,FALSE);//返回泊松概率密度函数</td></tr></tbody></table><p><strong>QUARTILE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回数据集的四分位数。四分位数通常用于在销售额和测量数据中对总体进行分组。例如，可以使用函数 QUARTILE 求得总体中前 25% 的收入值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">QUARTILE(ARRAY,N,QUART)<br>ARRAY 为需要求得四分位数值的数组或数字型单元格区域。<br>N 为数组数据周期数量<br>QUART 决定返回哪一个四分位值。<br>说明<br>如果数组为空，函数 QUARTILE 返回错误值 #NUM!。<br>如果 QUART 不为整数，将被截尾取整。<br>如果 QUART &lt; 0 或 QUART &gt; 4，函数 QUARTILE 返回错误值 #NUM!。<br>当 QUART 分别等于 0、2 和 4 时，函数 MIN、MEDIAN 和 MAX 返回的值与函数 QUARTILE 返回的值相同。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ARRAY={1,2,4,7,8,9,10,12},N=8,QUART=1,上述数据的第一个四分位数（第 25个百分点值）(3.5)</td></tr></tbody></table><p><strong>FORCAST2</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">曲线回归预测值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">FORCAST2(X,N)为 X 的 N 周期曲线(方程：y=a<em>x</em>x+b*x+c)回归预测值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">FORCAST2(CLOSE,10);//表示求 10 周期收盘价曲线回归预测本周期的值</td></tr></tbody></table><p><strong>RSQ</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回根据 known_y&#39;s 和 known_x&#39;s 中数据点计算得出的 Pearson 乘积矩相关系数的平方。有关详细信息，请参阅函数 REARSON。R 平方值可以解释为 y 方差与 x 方差的比例</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">RSQ(A,B,N),计算 A,B 序列的 N 周期乘积矩相关系数的平方</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">RSQ(L,H,10);//表示最低价与最高价的 10 周期乘积矩相关系数的平方</td></tr></tbody></table><p><strong>SKEW</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回分布的偏斜度。偏斜度反映以平均值为中心的分布的不对称程度。正偏斜度表示不对称部分的分布更趋向正值。负偏斜度表示不对称部分的分布更趋向负值。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SKEW(X,N),表示求X在N个周期的分布的偏斜度</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">SKEW(close,10);//求收盘价在10个周期的分布的偏斜度</td></tr></tbody></table><p><strong>SLOPE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">线性回归斜率</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SLOPE(X,N)为 X 的 N 周期线性回归线的斜率</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">SLOPE(CLOSE,10);//表示求 10 周期线性回归线的斜率</td></tr></tbody></table><p><strong>SMALL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回数据集中第 K 个最小值。使用此函数可以返回数据集中特定位置上的数值。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SMALL(ARRAY,N,K)<br>ARRAY 为需要找到第 K 个最小值的数组或数字型数据区域。<br>N 为数组周期数量。<br>K 为返回的数据在数组或数据区域里的位置（从小到大）。<br>说明<br>如果 ARRAY 为空，函数 SMALL 返回错误值 #NUM!。<br>如果 K ≤ 0 或 K 超过了数据点个数，函数 SMALL 返回错误值 #NUM!。<br>如果 N 为数组中的数据点个数，则 SMALL(ARRAY,1) 等于最小值，SMALL(ARRAY,N) 等于最大值。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">SMALL(C,10,2);//返回收盘价的 10 周期内第 2 个最小值</td></tr></tbody></table><p><strong>STANDARDIZE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回正态化数值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STANDARDIZE(A,B,S),A 为需要进行正态化的数值,B 分布的算术平均值,S 为分布的标准偏差,返回以 B 为平均值，以 S 为标准偏差的分布的正态化数值.</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STANDARDIZE(42,40,1.5);//符合上述条件的 42 的正态化数值(1.333333)</td></tr></tbody></table><p><strong>STD</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">估算标准差</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STD(X,N)为 X 的 N 日估算标准差</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STD(close,10);//为收盘价的10日估算标准差</td></tr></tbody></table><p><strong>STDP</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">总体标准差</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STDP(X,N)为 X 的 N 日总体标准差</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STDP(close,10);//计算close 的 10 日总体标准差</td></tr></tbody></table><p><strong>STEYX</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回通过线性回归法计算每个 x 的 y 预测值时所产生的标准误差。标准误差用来度量根据单个 x 变量计算出的 y 预测值的误差量。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STEYX(Y,X,N),计算 Y,X 序列变量的线性回归法预测标准误差.</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">STEYX(L,H,10);//表示最低价与最高价的 10 周期线性回归法预测标准误差</td></tr></tbody></table><p><strong>TRIMMEAN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回数据集的内部平均值。函数 TRIMMEAN 先从数据集的头部和尾部除去一定百分比的数据点，然后再求平均值。当希望在分析中剔除一部分数据的计算时，可以使用此函数。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">TRIMMEAN(ARRAY,N,PERCENT)<br>ARRAY 为需要进行整理并求平均值的数组或数值区域。<br>N 为数组数据周期数量<br>PERCENT 为计算时所要除去的数据点的比例，例如，如果 PERCENT = 0.2，在 20 个数据点的集合中，就要除去 4 个数据点(20 X 0.2)：头部除去 2 个，尾部除去 2 个。<br>说明<br>如果 PERCENT &lt; 0 或 PERCENT &gt; 1，函数 TRIMMEAN 返回错误值 #NUM!。<br>函数 TRIMMEAN 将除去的数据点数目向下舍入为最接近的 2 的倍数。如果PERCENT = 0.1，30 个数据点的 10% 等于 3 个数据点。函数 TRIMMEAN 将对称地在数据集的头部和尾部各除去一个数据。</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">TRIMMEAN(C,20,0.2);//从计算中除去 20%的 20 周期收盘价内部平均值</td></tr></tbody></table><p><strong>VAR</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">估算样本方差</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">VAR(X,N)为 X 的 N 日估算样本方差.</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">VAR(close,10);//计算收盘价的10日估算样本方差</td></tr></tbody></table><p><strong>VARP</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">总体样本方差</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">VARP(X,N)为 X 的 N 日总体样本方差</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">VARP(close,10);//计算收盘价的10日总体样本方差</td></tr></tbody></table><p><strong>WEIBULL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回韦伯分布。使用此函数可以进行可靠性分析，比如计算设备的平均故障时间</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">WEIBULL(A,B,D,F),A 为参数值,B 为分布参数,D 为分布参数,F 为指明函数的形式,TRUE 为韦伯累积分布,FALSE 为韦伯概率密度</td></tr></tbody></table><p><strong>AVEDEV</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">平均绝对偏差</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">AVEDEV(X,N)</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">AVEDEV(close,10);//计算收盘价的 10 日平均绝对偏差</td></tr></tbody></table><p><strong>DELIVERYINTERVAL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取当前品种在当前 K 线上，距离最近交割日的交易日数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">DELIVERYINTERVAL()</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">DELIVERYINTERVAL();//主图为股指期货，返回5表示距离交割日还有5个交易日</td></tr></tbody></table><h2 id="时间函数" tabindex="-1"><a class="header-anchor" href="#时间函数" aria-hidden="true">#</a> 时间函数</h2><p><strong>BARSTATUS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">函数返回数据位置状态</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">1 表示第 1 根 K 线，2 表示最后 1 根 K 线，0 表示中间的 K 线</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">BARSTATUS();</td></tr></tbody></table><p><strong>BARPOS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">第一个有效数据到当前的周期数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">BARPOS（X）;x:变量名</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">BARSCOUNT(MA（C，60）);//返回第一个MA60有效值到当前的周期数。(即k线图第60根k线位置开始)</td></tr></tbody></table><p><strong>CURRENTDATE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">计算时的当前日期</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">CURRENTDATE 函数返回计算时的日期,有效值范围为(101-1991231),表示1900/01/01-2099/12/31<br>注意：该函数返回常数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">CURRENTDATE;//返回当前日期</td></tr></tbody></table><p><strong>CURRENTTIME</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">计算当前计算机时间</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">CURRENTTIME<br>函数返回计算时的时间(时分秒),有效值范围为(000000-235959)<br>注意：该函数返回常数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">CURRENTTIME;//返回当前时间</td></tr></tbody></table><p><strong>DATE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期年月日的数值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">DATE()<br>函数返回有效值范围为(19000101-20991231),表示 19000101-20991231</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">DATE();//返回当前周期年月日</td></tr></tbody></table><p><strong>DATEDIFF</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得日期之间的时间间隔天数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">DATEDIFF(DATE1,DATE2)<br>DATE1,DATE2 为序列变量或常数，格式与 DATE 同，有效值范围为(101-1991231),<br>表示 19000101-20991231 返回 DATE1、DATE2 两个日期之间的相差的天数，如果 DATE1 晚于 DATE2，则 DATEDIFF 函数返回负数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">DATEDIFF(LSOLARTERMDATE(1),DATE);//表示求当年小寒到当前周期相差的天数</td></tr></tbody></table><p><strong>DATEPOS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取指定日期的数据序号</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">DATEPOS(DATE),DATE 日期格式为一字符串格式，比如是标准日期时间格式，并只能是常数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">DATEPOS(&#39;2012-04-17 10:38:00&#39;);//求 2012-04-17 10:38:00 日期时间的数据对应图表上数据的序号</td></tr></tbody></table><p><strong>DAY</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期的日期</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">DAY()<br>函数返回有效值范围为(1-31)</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">DATE();//返回10表示该周期为10号</td></tr></tbody></table><p><strong>DAYOFWEEK</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得指定日期的星期数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">DAYOFWEEK(D)，D 为指定的日期<br>函数返回有效值范围为(0-6)</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">DAYOFWEEK(DATE);//表示当前周期是星期几</td></tr></tbody></table><p><strong>DAYS1970</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期从 1970 以来的天数。<br>返回自从 1970 年 1 月 1 日以来的天数，例如在 1971 年 1 月 1 日返回 365。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">DAYS1970</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">aa:DAYS1970;//当前周期位置距离1970年的天数</td></tr></tbody></table><p><strong>HOUR</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期的小时数。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">HOUR()<br>函数返回有效值范围为(0-23)，对于日线及更长周期此函数无效</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">HOUR();//返回15表示该周期在下午3点</td></tr></tbody></table><p><strong>MINUTE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期的分钟数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">MINUTE()<br>函数返回有效值范围为(0-59)，对于日线及更长周期此函数无效</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">MINUTE();//返回15表示该周期在15分钟</td></tr></tbody></table><p><strong>MONTH</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期的月份</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">MONTH()<br>函数返回有效值范围为(1-12)</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">MONTH();//返回8表示该周期在8月份</td></tr></tbody></table><p><strong>OPENMINUTES</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期的月份</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">OPENMINUTES(TIME)<br>返回已开盘分钟数(0-总开盘分钟数),开盘前的都为 1,收盘后都为总开盘分钟数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">OPENMINUTES(CURRENTTIME);//在日线上可得到现在已开盘分钟数<br>OPENMINUTES(TIME);//在分钟线上可得到当时已开盘分钟数</td></tr></tbody></table><p><strong>T0TOTIME</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得从 0 点开始 X 秒后的时间值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">T0TOTIME(X)</td></tr></tbody></table><p><strong>TIME</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期的时分秒</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">TIME()<br>函数返回有效值范围为(000000-235959)，对于日线及更长周期此函数无效.<br>该函数返回序列变量</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">TIME();//返回145000表示该周期在14点50分</td></tr></tbody></table><p><strong>TIME0</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期从当日 0 点以来的秒数。<br>返回自从当日 0 点以来的秒数，对于日线以上的分析周期返回 0</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">TIME0</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">TIME0;//返回2000表示该周期在0点以来有2000秒</td></tr></tbody></table><p><strong>TIMETOT0</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得时间 X 距离当日 0 点的秒数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">TIMETOT0(X);X需指定时间</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">TIMETOT0(140000);//返回14点距离当日0点以来的秒数</td></tr></tbody></table><p><strong>WEEKDAY</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期的星期数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">WEEKDAY()<br>函数返回有效值范围为(0-6)</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">WEEKDAY();//返回2表示该周期为星期二</td></tr></tbody></table><p><strong>YEAR</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期的年份</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">YEAR()<br>函数返回有效值范围为(1900-2099)</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">YEAR();//返回2022表示该周期为2022年</td></tr></tbody></table><h2 id="数学函数" tabindex="-1"><a class="header-anchor" href="#数学函数" aria-hidden="true">#</a> 数学函数</h2><p><strong>ABS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求绝对值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ABS(X)返回 X 的绝对值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ABS(-34)返回 34</td></tr></tbody></table><p><strong>ACOS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">反余弦值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ACOS(X)返回 X 的反余弦值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">Acos(-1);//返回3.1415926</td></tr></tbody></table><p><strong>ASIN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">反正弦值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ASIN(X)返回 X 的反正弦值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ASIN(1);//求1的反正弦值</td></tr></tbody></table><p><strong>ATAN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">反正切值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ATAN(X)返回 X 的反正切值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ATAN(15.5);//求15.5的反正切值</td></tr></tbody></table><p><strong>CEILING</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">向数值增大方向舍入</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">CEILING(A)返回沿 A 数值增大方向最接近的整数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">CEILING(12.3);//求得 13<br>CEILING(-3.5);//求得-3</td></tr></tbody></table><p><strong>COMBIN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">计算从给定数目的对象集合中提取若干对象的组合数。利用函数 COMBIN 可以确定一组对象所有可能的组合数。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">COMBIN(A,B),A 为对象的总数量,B 为每一组合中对象的数量</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">COMBIN(8,2);//从八个候选人中提取两个候选人的组合数(28)</td></tr></tbody></table><p><strong>COS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">余弦值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">COS(X)返回 X 的余弦值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">COS(-1.87);//返回0.294759</td></tr></tbody></table><p><strong>EXP</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">指数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">EXP(X)为 E 的 X 次幂</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">EXP(CLOSE);//返回 E 的 CLOSE 次幂</td></tr></tbody></table><p><strong>FLOOR</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">向数值减小方向舍入</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">FLOOR(A)返回沿 A 数值减小方向最接近的整数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">FLOOR(12.3);//求得 12,FLOOR(-3.5)求得-4</td></tr></tbody></table><p><strong>FRACPART</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得数据的小数部分</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">FRACPART(X)返回数值的小数部分</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">FRACPART(12.3);//求得 0.3,FRACPART(-3.5)求得-0.5</td></tr></tbody></table><p><strong>INTPART</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">绝对值减小取整，即取得数据的整数部分</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">INTPART(A)返回沿 A 绝对值减小方向最接近的整数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">INTPART(12.3);//求得 12,INTPART(-3.5)求得-3</td></tr></tbody></table><p><strong>LN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求自然对数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">LN(X)以 E 为底的对数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">LN(CLOSE);//求收盘价的对数</td></tr></tbody></table><p><strong>LOG</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求以 10 为底的对数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">LOG(X)取得 X 的对数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">LOG(100);//等于 2</td></tr></tbody></table><p><strong>MAX</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求最大值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">MAX(A,B)返回 A 和 B 中的较大值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">MAX(CLOSE-OPEN,0);//表示若收盘价大于开盘价返回它们的差值，否则返回 0</td></tr></tbody></table><p><strong>MIN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求最小值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">MIN(A,B)返回 A 和 B 中的较小值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">MIN(CLOSE,OPEN);//返回开盘价和收盘价中的较小值</td></tr></tbody></table><p><strong>MOD</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求模运算</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">MOD(A,B)返回 A 对 B 求模</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">MOD(26,10);//返回 6</td></tr></tbody></table><p><strong>POW</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">乘幂</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">POW(A,B)返回 A 的 B 次幂</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">POW(CLOSE,3);//求得收盘价的 3 次方</td></tr></tbody></table><p><strong>RAND</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">随机整数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">RAND(N)<br>返回一个范围在 1-N 的随机整数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">CLOSE*(RAND(10)/10+0.4);<br>输出收盘价乘以[0.5-1.4]的随机系数</td></tr></tbody></table><p><strong>REVERSE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求相反数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">REVERSE(X)返回-X</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">REVERSE(CLOSE);//返回-CLOSE</td></tr></tbody></table><p><strong>ROUND</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">四舍五入为整数,显示时不带小数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ROUND(X)将 X 四舍五入为整数</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ROUND(3.3);//求得 3<br>ROUND(3.5);//求得 4<br>ROUND(-3.5);//求得-4</td></tr></tbody></table><p><strong>ROUNDS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">四舍五入整理小数到指定位数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ROUNDS(A,B) 表示整理数字 A 的小数点位数到 B。该函数可用以做浮点数的精确相等判断</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ROUNDS(12.345,2);//将返回 12.35</td></tr></tbody></table><p><strong>SGN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">求符号值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SGN(X)，当 X&gt;0,X=0,X&lt;0 分别返回 1,0,-1</td></tr></tbody></table><p><strong>SIN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">正弦值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SIN(X)返回 X 的正弦值</td></tr></tbody></table><p><strong>SQRT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">开平方</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SQRT(X)为 X 的平方根</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">SQRT(CLOSE);//收盘价的平方根</td></tr></tbody></table><p><strong>TAN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">正切值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">TAN(X)返回 X 的正切值</td></tr></tbody></table><h2 id="行情函数" tabindex="-1"><a class="header-anchor" href="#行情函数" aria-hidden="true">#</a> 行情函数</h2><p><strong>CLOSE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期收盘价</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">CLOSE</td></tr></tbody></table><p><strong>C</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期收盘价，与 CLOSE 等价</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">c</td></tr></tbody></table><p><strong>HIGH</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期最高价</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">HIGH</td></tr></tbody></table><p><strong>H</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期最高价，与 HIGH 等价</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">H</td></tr></tbody></table><p><strong>LOW</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期最低价</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">LOW</td></tr></tbody></table><p><strong>L</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期最低价</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">LOW</td></tr></tbody></table><p><strong>AMOUNT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期原始成交额</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">AMOUNT</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">AMOUNT;//返回当前k线位置的成交额</td></tr></tbody></table><p><strong>OAMOUNT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期原始成交额(未复权)</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">OAMOUNT</td></tr></tbody></table><p><strong>OCLOSE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期原始收盘价(未复权)</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">OCLOSE</td></tr></tbody></table><p><strong>OHIGH</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期原始最高价(未复权)</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">OHIGH</td></tr></tbody></table><p><strong>OLOW</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期原始最低价(未复权)</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">OLOW</td></tr></tbody></table><p><strong>OOPEN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期原始开盘价(未复权)</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">OOPEN</td></tr></tbody></table><p><strong>OPEN</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期开盘价</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">OPEN</td></tr></tbody></table><p><strong>O</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期开盘价，与开盘价等价</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">O</td></tr></tbody></table><p><strong>OVOL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期原始成交量(未复权)</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">OVOL</td></tr></tbody></table><p><strong>VOL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期成交量</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">VOL</td></tr></tbody></table><p><strong>V</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期成交量，与 VOL 等价。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">V</td></tr></tbody></table><p><strong>OPENA</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期开盘成交额</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">OPENA</td></tr></tbody></table><p><strong>OPENV</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期开盘成交量</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">OPENV</td></tr></tbody></table><p><strong>OPENINT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期持仓量</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">OPENINT</td></tr></tbody></table><p><strong>ASKPRICE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期的委卖价</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ASKPRICE,个股品种在分笔周期上有效</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">MA(ASKPRICE,10);//获取10笔周期范围的平均委卖价</td></tr></tbody></table><p><strong>BIDPRICE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期的委买价</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">BIDPRICE,个股品种在分笔周期上有效</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">MA(BIDPRICE,10);//获取10笔周期范围的平均委买价</td></tr></tbody></table><p><strong>ASKVOL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期的委卖量</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ASKVOL,个股品种在分笔周期上有效</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">MA(ASKVOL,10);//获取10笔周期范围的平均委卖量</td></tr></tbody></table><p><strong>BIDVOL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该周期的委买量</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">BIDVOL,个股品种在分笔周期上有效</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">MA(BIDVOL,10);//获取10笔周期范围的平均委买量</td></tr></tbody></table><p><strong>INDEXA</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得同期大盘的成交额</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">INDEXA</td></tr></tbody></table><p><strong>INDEXC</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得同期大盘的收盘价</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">INDEXC</td></tr></tbody></table><p><strong>INDEXH</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得同期大盘的最高价</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">INDEXH</td></tr></tbody></table><p><strong>INDEXL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得同期大盘的最低价</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">INDEXL</td></tr></tbody></table><p><strong>INDEXO</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得同期大盘的开盘价</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">INDEXO</td></tr></tbody></table><p><strong>INDEXV</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得同期大盘的成交量</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">INDEXV</td></tr></tbody></table><p><strong>IOPV</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得ETF的基金份额参考净值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">IOPV，该函数仅对ETF基金产品合约有效</td></tr></tbody></table><p><strong>BVOL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得外盘成交量</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">BVOL;//取当日外盘成交量</td></tr></tbody></table><p><strong>SVOL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得内盘成交量</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SVOL;//取当日内盘成交量</td></tr></tbody></table><p><strong>CAPITAL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">流通盘大小</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">CAPITAL()</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">CAPITAL();//返回当前主图代码的流通盘，单位为手，主图为指数返回0</td></tr></tbody></table><p><strong>SUSPEND</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">是否停牌</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SUSPEND()，无参数时默认返回后一个交易日是否停牌，参数为-1 返回前一个交易日是否停牌，参数为日期返回指定日期是否停牌<br>返回值为 1 时，为停牌，为 0 时为非停牌</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">SUSPEND(20220906);//返回2022年9月6日是否停牌</td></tr></tbody></table><h2 id="扩展数据" tabindex="-1"><a class="header-anchor" href="#扩展数据" aria-hidden="true">#</a> 扩展数据</h2><p><strong>EXTDATA</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">获取指定周期的扩展数据</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">EXTDATA(NAME, STOCK, TIME)<br>其中 NAME 是扩展数据的名字， STOCK 表示品种，TIME 表示相对当前周期的偏移值，0 表示当前周期</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">X:= EXTDATA(&#39;ZZZ&#39;, &#39;SZ600000&#39;, 0);//则 X 表示 600000在当前周期对应的扩展数据ZZZ中的值，股票市场须用大写字母</td></tr></tbody></table><p><strong>EXTDATARANGE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">获取扩展数据中满足指定条件的股票列表</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">EXTDATARANGE(NAME, TIME, CONDITION)<br>NAME 表示扩展数据的名字，TIME 表示相对当前周期的偏移值，0 表示当前周期，CONDITION 为条件字符串</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">LIST := EXTDATARANGE(&#39;ZZZ&#39;, 0, &#39;ZZZ == 10&#39;);// 则 LIST为当前周期，ZZZ 的值等于 10 的股票代码的集合</td></tr></tbody></table><p><strong>EXTDATAMATCH</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">判断该周期当前品种的扩展数据是否满足指定条件</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">EXTDATAMATCH(NAME, TIME, CONDITION)<br>表示当前品种在名为 NAME 的扩展数据中的 TIME 周期的值是否满足 CONDITION条件</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">X:=EXTDATARANGE(&#39;ZZZ&#39;,0,&#39;ZZZ==10&#39;);//则X表示当前品种当前周期ZZZ的值是否等于10,若等于10,则X=1,否则X=0</td></tr></tbody></table><p><strong>EXTDATARANK</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">判断当前品种的扩展数据在所有品种中的排名，按扩展数据值从大到小排</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">EXTDATARANK(NAME, TIME)<br>表示当前品种在名为 NAME 的扩展数据中的 TIME 周期的值在所有品种中的排名</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">X:=EXTDATARANK(&#39;ZZZ&#39;,0,&#39;SZ000001&#39;) ;//表示当前品种(&#39;SZ000001&#39;)当前周期 ZZZ 的值在 ZZZ 对应的股票集合中的排名</td></tr></tbody></table><p><strong>EXTDATABIGGER</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回扩展数据中比某个值大的股票数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">EXTDATABIGGER(NAME, TIME, VALUE)<br>表示当前品种在名为 NAME 的扩展数据中的 TIME 周期的值在所有品种中的排名</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">X := EXTDATABIGGER(&#39;ZZZ&#39;,0, 10);// 表示扩展数据当前周期 ZZZ 的值比 10 大的数的个数</td></tr></tbody></table><p><strong>EXTRANKTOVALUE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回扩展数据中排名为某一位置对应的数值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">EXTRANKTOVALUE(NAME, TIME, RANK)<br>表示当前品种在名为 NAME 的扩展数据中的 TIME 周期排名为 RANK 的对应数值</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">X := EXTRANKTOVALUE(&#39;ZZZ&#39;, 0,10);// 表示扩展数据 ZZZ当前周期排名为 10 的股票对应的值</td></tr></tbody></table><h2 id="组合模型" tabindex="-1"><a class="header-anchor" href="#组合模型" aria-hidden="true">#</a> 组合模型</h2><p><strong>SETGROUPMAXHOLDING</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">设置组合模型的最大持仓</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SETGROUPMAXHOLDING(50)表示最多同时持有 50 支股票的仓位</td></tr></tbody></table><p><strong>SETGROUPMODE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">组合模型运行模式</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SETGROUPMODE(MODE)<br>MODE 的取值为0或1，0 表示纯脚本运行的模型，1 表示在 C++中控制买卖逻辑的运行方式，默认为 0</td></tr></tbody></table><p><strong>GETSTOCKINFO</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">获取个股的买卖点信息</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">STOCKINFO := GETSTOCKINFO(STOCK，1); 表示取股票代码为 STOCK 的股票下一周期的买卖点信息，STOCK 为股票名称，1 为周期偏移量（取当前为 0，向前取为负数，向后取为正数）<br>返回值是一个结构体，该结构体有三个属性：BUY, SELL, PRICE;<br>STOCKINFO.BUY &gt; 0 表示该周期出现了买点<br>STOCKINFO.SELL &gt; 0 表示该周期出现了卖点<br>STOCKINFO.PRICE 表示该周期该个股的收盘价，可以用于计算买入价和卖出价<br>STOCKINFO.HOLDING 表示该周期该个股的持仓，可用于判断买卖点<br>STOCKINFO.SUSPEND 表示该周期该个股是否停盘，STOCKINFO.SUSPEND=1 表示停盘，STOCKINFO.SUSPEND=0 表示未停盘</td></tr></tbody></table><p><strong>GETSTOCKINFOBYINDEX</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">获取个股的买卖点信息</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">用法和 GETSTOCKINFO 一样</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">GETSTOCKINFOBYINDEX(STOCKID，0);//表示取股票代码为 STOCKID 的股票的当前周期的买卖点信息</td></tr></tbody></table><p><strong>ISSTOCKINHOLDING</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">查询当前股票是否有持仓</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ISSTOCKINHOLDING(STOCK);表示股票代码为 STOCK 的股票是否在当前的持仓组合中。TRUE 表示在，FALSE 表示不在</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ISSTOCKINHOLDING(&#39;SZ000001&#39;)表示当前持仓中是否有平安银行</td></tr></tbody></table><p><strong>ISSTOCKINHOLDINGBYINDEX</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">查询当前股票是否有持仓</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">用法和 ISSTOCKINHOLDING 一样</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ISSTOCKINHOLDING(STOCKID);// 表示股票代码为 STOCKID 的股票是否在当前的持仓组合中。TRUE 表示在，FALSE 表示不在。</td></tr></tbody></table><p><strong>GETHOLDINGINFO</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">获取个股的持仓信息</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:left;">HOLDING = GETHOLDINGINFO(STOCK);//表示获取当前持仓中，STOCK 所对应的股票的持仓信息，返回值是一个结构体，该结构体有五个属性：HOLDING, BUYPRICE,BUYDATE, PROFIT, PRICE, HOLDINGPERIODS;<br>HOLDING.HOLDING 表示持仓手数<br>HOLDING.BUYPRICE 表示买入价格<br>HOLDING.BUYDATE 表示买入的时间点<br>HOLDING.PROFIT 表示从买入到当前的利润<br>HOLDING.PRICE 表示当前周期的收盘价<br>HOLDING.HOLDINGPERIODS 表示从买入到当前周期的周期数</td></tr></tbody></table><p><strong>GETHOLDINGINFOBYINDEX</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">获取个股的持仓信息</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">用法和 GETHOLDINGINFO 一样</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">HOLDING = GETHOLDINGINFOBYINDEX(STOCKID);//表示获取当前持仓中，STOCK所对应的股票的持仓信息</td></tr></tbody></table><p><strong>GROUPBUY</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">组合模型买入</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:left;">GROUPBUY(STOCK);//表示在组合模型中买入股票 STOCK，该操作会将该股票记入组合模型的持仓中，并将股票加入该周期的买入面板中</td></tr></tbody></table><p><strong>GROUPBUYBYINDEX</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">组合模型买入</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">用法和 GROUPBUY 一样</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">GROUPBUYINDEX(STOCK);//表示在组合模型中买入股票 STOCK</td></tr></tbody></table><p><strong>GROUPSELL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">组合模型卖出</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">GROUPSELL(STOCK)表示在组合模型中卖出股票 STOCK，该操作会从组合模型的持仓中删除该股票，并将股票加入该周期的卖出面板中。<br>GROUPSELL 返回一个 BOOL 变量，表示卖出是否成功，比如在股票停牌时，是无法卖出的</td></tr></tbody></table><p><strong>GROUPSELLBYINDEX</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">组合模型卖出</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">用法和 GROUPSELL 一样</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">GROUPSELLBYINDEX(STOCKID);//表示在组合模型中卖出股票 STOCKID</td></tr></tbody></table><p><strong>GROUPPOSSIBLEBUY</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">组合模型计算买入备选</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">GROUPPOSSIBLEBUY(STOCKID)表示将 STOCKID 加入组合模型该周期中的买入备选面板中，每周期买入的股票是买入备选股票集的一个子集</td></tr></tbody></table><p><strong>GROUPPOSSIBLEBUYBYINDEX</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">组合模型计算买入备选</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">用法和 GROUPPOSSIBLEBUY 一样</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">GROUPPOSSIBLEBUYBYINDEX(STOCKID);//表示将STOCKID 加入组合模型该周期中的买入备选面板中</td></tr></tbody></table><p><strong>GROUPPOSSIBLESELL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">组合模型计算卖出备选</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">GROUPPOSSIBLESELL(STOCK)表示将STOCK 加入组合模型该周期中的卖出备选面板中，每周期卖出的股票是卖出备选股票集的一个子集</td></tr></tbody></table><p><strong>GROUPPOSSIBLESELLBYINDEX</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">组合模型计算卖出备选</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">用法和 GROUPPOSSIBLESELL 一样</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">GROUPPOSSIBLESELLBYINDEX(STOCKID);//表示将 STOCKID 加入组合模型该周期中的卖出备选面板中</td></tr></tbody></table><p><strong>INDYNAMICBASKET</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">是否在动态股票篮子中</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">INDYNAMICBASKET(STOCKID)表示 STOCKID 是否在动态股票篮子中，TRUE 表示在，FALSE 表示不在。</td></tr></tbody></table><p><strong>SETGROUPINDEX</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">当组合模型的运行模式为 C++模式时，设置这个参数，可以在买入备选中的股票数大于可能的最大持仓时，将买入备选中的股票根据扩展数据的排名排序，并买入排名靠前的股票。</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">组合模型中有下面的代码时<br>SETGROUPMAXHOLDING(50);<br>SETGROUPMODE(1);<br>SETGROUPINDEX(&#39;RISE&#39;);<br>则当某个周期持仓中已经有了 40 支股票，并且还有 30 支股票出现了买点时，组合模型会根据 RISE 中的排名信息，将买入备选中的 30 支股票进行排序，并买入排名靠前的 10 支股票</td></tr></tbody></table><p><strong>GETHOLDINGPROFIT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">获取组合模型当前周期持仓的浮动赢亏</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">X := GETHOLDINGPROFIT(); 则 X 表示当前周期组合模型持仓的浮动赢亏</td></tr></tbody></table><h2 id="组合模型交易函数" tabindex="-1"><a class="header-anchor" href="#组合模型交易函数" aria-hidden="true">#</a> 组合模型交易函数</h2><p><strong>ORDER</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">通过网络端口向指定的接口单发送交易信号</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ORDER 的语法格式为 ORDER(OPERATION, CHANNEL, ADDR);<br>OPERATION 表示交易的类型，CHANNEL 为指定的接口单通道号，ADDR 为可选参数，不填表示使用系统默认的地址连接量化投研平台，可以指定多个量化投研平台中的接口单地址，多个地址间用逗号隔开</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ORDER(3, 1, &#39;192.168.1.128:5000, 192.168.1.129:5000&#39;); 表示向192.168.1.128, 192.168.1.129 这两台机器上的 1 号接口单发送开空信号</td></tr></tbody></table><p><strong>PASSORDER</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">通过函数交易发送交易信号</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">PASSORDER 的语法格式为 PASSORDER(OPTYPE, ORDERTYPE , ACCOUNTID,ORDERCODE, PRTYPE, PRICE, VOLUME[,strategyName])<br>数据类型：OPTYPE,ORDERTYPE,PRTYPE,PRICE,VOLUME 是数字类型;ACCOUNTID,ORDERCODE 是字符串类型<br>（1）最少填七个参数<br>（2）其中[strategyName] 自定义策略名不是必填<br>（3）OPTYPE(操作类型):<br>OPTYPE 参数内容说明<br>期货六键:<br>0/开多<br>1/平昨多<br>2/平今多<br>3/开空<br>4/平昨空<br>5/平今空<br>期货四键:<br>6/平多,优先平今<br>7/平多,优先平昨<br>8/平空,优先平今<br>9/平空,优先平昨<br>期货两键:<br>10/卖出,如有多仓,优先平仓,优先平今,如有余量,再开空<br>11/卖出,如有多仓,优先平仓,优先平昨,如有余量,再开空<br>12/买入,如有空仓,优先平仓,优先平今,如有余量,再开多<br>13/买入,如有空仓,优先平仓,优先平昨,如有余量,再开多<br>14/买入,不优先平仓<br>15/卖出,不优先平仓<br>股票买卖:<br>23/股票买入<br>24/股票卖出<br>融资融券:<br>27/融资买入<br>28/融券卖出<br>29/买券还券<br>30/直接还券<br>31/卖券还款<br>32/直接还款<br>组合交易:<br>25/组合买入<br>26/组合卖出<br>37/卖出投资组合<br>40/期货组合开多<br>43/期货组合开空<br>46/期货组合平多,优先平今<br>47/期货组合平多,优先平昨<br>48/期货组合平空,优先平今<br>49/期货组合平空,优先平昨<br>（4）ORDERTYPE(下单类型):<br>参数详细说明<br>11:单股、单账号、普通 、默认 方式下单,兼容以前的 11 模式<br>1101:单股、单账号、普通、股/手 方式下单(同 11)<br>1102:单股、单账号、普通、金额（元）方式下单(该方式只支持股票下单)<br>1113:单股、单账号、总资产、比例(0~1)方式下单<br>1123:单股、单账号、可用、比例(0~1)方式下单<br>12:单股、账号组(无权重)、普通 、默认 方式下单,兼容以前的 12 模式<br>1201:单股、账号组(无权重)、普通、股/手 方式下单(同 12)<br>1202:单股、账号组(无权重)、普通、金额（元）方式下单(该方式只支持股票下单)<br>1213:单股、账号组(无权重)、总资产、比例(0~1)方式下单<br>1223:单股、账号组(无权重)、可用、比例(0~1)方式下单<br>21:组合、单账号、普通 、默认方式下单，兼容以前的 21 模式<br>2101:组合、单账号、普通、按组合股票数量 方式下单,对应 VOLUME 填篮子份数(同 21)<br>2102:组合、单账号、普通、按组合股票权重 方式下单,对应 VOLUME 填金额(元)<br>2103:组合、单账号、普通、按账号可用方式下单,对应VOLUME 填比例(0~1)(该方式只支持股票组合)<br>22:组合、账号组(无权重)、普通 、默认方式下单，兼容以前的 22 模式<br>2201:组合、账号组(无权重)、普通、按组合股票数量 方式下单,对应 VOLUME填篮子份数(同 22)<br>2202:组合、账号组(无权重)、普通、按组合股票权重 方式下单,对应 VOLUME填金额(元)<br>2203:组合、账号组(无权重)、普通、按账号可用方式下单,对应 VOLUME 填比例(0~1)(该方式只支持股票组合)<br>2331:组合、套利、合约价值自动套利、按组合股票数量 方式下单,对应VOLUME 填篮子份数<br>2332:组合、套利、按合约价值自动套利、按组合股票权重 方式下单,对应VOLUME 填金额(元)<br>2333:组合、套利、按合约价值自动套利、按账号可用方式下单,对应 VOLUME填比例(0~1)<br>组合套利对 ACCOUNTID 参数的约定:accountID :=<br>&#39;stockAccountID,futureAccountID&#39;<br>组合套利对 ORDERCODE 参数的约定:orderCode :=&#39;basketName,futureName&#39;<br>对 PRICE 参数的约定为套利比例(0~1)<br>融资融券只支持 ORDERTYPE:11,1101,1102,12,1201,1202<br>（5） ACCOUNTID(账号 ID):下单的账号 ID 或 账号组名;组合套利时用逗号隔开股票账号和期货账号<br>（6） ORDERCODE(下单代码):<br>两种情况:单股或单期货、港股,则该参数填合约代码;组合交易,则该参数填篮子名称,组合套利时用逗号隔开篮子名称和期货合约名<br>（7） PRTYPE(下单选价类型):<br>4 卖 1 价,5 最新价,6 买 1 价,12 市价,13 挂单价,14 对手价,11(指定价)模型价<br>（8） PRICE(下单价格):当 PRTYPE 是模型价(指定价)11 时 PRICE 有效,其它情况下 PRICE 无效(注意:组合套利时该参数作套利比例)<br>（9） VOLUME:下单数量(股 OR 手)、组合份数、资金比例(0~1)</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">PASSORDER(23,1101,&#39;6000000201&#39;,&#39;SH600000&#39;,5, -1, 100); 表示发送账号6000000201 以最新价买入 100 股 SH600000 的信号；<br>PASSORDER(25,2333,&#39;6000000201,037429&#39;,&#39;stockbasket,IF1703&#39;,5, 1,0.5);表示以最新价买入账号 6000000201 的 50%的可用资金的一篮子股票stockbasket,并以 100%的套利比例在期货账号 037429 下开空单 IF1703</td></tr></tbody></table><p><strong>TACCOUNT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">获取指定账号的可用资金</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">TACCOUNT(1, &#39;37500001&#39;);<br>1 表示是期货账号，2 为普通股票账号，3 为信用账号，37500001 是账号 ID，返回可用资金；</td></tr></tbody></table><p><strong>HOLDING</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">得到当前帐户持仓量,多仓返回正数空仓返回负数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">HOLDING(AccountID , MarketID, StockID, Direction);<br>AccountID, MarketID, StockID 为字符串；Direction 为整型（1 多，2 空）</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">例 1: ho:=holding(&#39;037055&#39;,&#39;IF&#39;,&#39;IF06&#39;,2); //IF06 做空持仓<br>例 2: ho:=holding(&#39;6000000255&#39;,&#39;SH&#39;,&#39;600000&#39;,1) //股票 600000 持仓</td></tr></tbody></table><p><strong>HOLDINGS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取某资金帐号对应的持仓</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">holdings(Account);表示获取帐号 Account 的持仓</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">统计某个账号所有品种做多方向的持仓<br>xxx := holdings(&#39;037055&#39;);<br>loh := 0;<br>for x in xxx do begin<br>if x.direction = 48 then<br>loh:= loh + x.volume;<br>end<br>longhold:loh;<br>xxx 为一个 positiondetail 结构体，含有如下项：<br>exchangeid 证券市场,交易所代码<br>exchangename 市场名字<br>productid 品种代码<br>productname 品种名称<br>instrumentid 证券代码,合约代码<br>instrumentname 证券名称,合约名称<br>hedgeflag 投保<br>direction 买卖<br>opendate 成交日期<br>tradeid 最初开仓位的成交<br>volume 持仓量 当前拥股<br>openprice 开仓价<br>tradingday 交易日<br>margin 使用的保证金 历史的直接用 ctp 的，新的自己用成本价<em>存量</em>系数算 股票不需要<br>opencost 开仓成本 等于股票的成本价<em>第一次建仓的量，后续减持不影响，不算手续费 股票不需要<br>settlementprice /结算价 对于股票的当前价<br>closevolume 平仓量 等于股票已经卖掉的 股票不需要<br>closeamount 平仓额 等于股票每次卖出的量</em>卖出价<em>合约乘数（股票为 1）的累加 股票不需要<br>dloatprofit 浮动盈亏 当前量</em>（当前价-开仓价）<em>合约乘数（股票为 1）<br>closeprofit 平仓盈亏 平仓额 - 开仓价</em>平仓量*合约乘数（股票为 1）股票不需要<br>marketvalue 市值 合约价值<br>positioncost 持仓成本 股票不需要<br>positionprofit 持仓盈亏 股票不需要<br>lastsettlementprice 最新结算价 股票不需要<br>instrumentvalue 合约价值 股票不需要<br>istoday 是否今仓<br>xttag 量化投研平台标签<br>stockholder 股东账号<br>frozenvolume 期货不用这个字段，冻结数量<br>canusevolume 期货不用这个字段，股票的可用数量<br>onroadvolume 期货不用这个字段，股票的在途数量<br>yesterdayvolume 期货不用这个字段，股票的股份余额<br>lastprice 结算价 对于股票的当前价<br>profitrate 持仓盈亏比例<br>futuretradetype 成交类型<br>expiredate 到期日，逆回购用<br>comtradeid 套利成交 Id<br>legid 组合 Id<br>totalcost 自定义累计成本 股票信用用到<br>singlecost 自定义单股成本 股票信用用到<br>coveredvolume 用于个股期权<br>sideflag 用于个股期权，标记 &#39;0&#39; - 权利，&#39;1&#39; - 义务，&#39;2&#39; - &#39;备兑&#39;<br>referencerate 汇率,目前用于港股通<br>structfundvol 分级基金可用（可分拆或可合并）<br>redemptionvolume 分级基金可赎回量<br></td></tr></tbody></table><p><strong>ORDERING（不生效）</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回当前委托数量</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ordering(AccountID , MarketID, StockID, Direction, [strategyName]);<br>AccountID, MarketID, StockID 为字符串；Direction 为整型(1 buy，2sell),strategyName 自义定策略名,为字符串</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">例 1: ho:=ordering(&#39;037055&#39;,&#39;IF&#39;,&#39;IF06&#39;,2);<br>例 2: ho:=ordering(&#39;6000000255&#39;,&#39;SZ&#39;,&#39;000001&#39;,1)<br>例 3: ho:=ordering(&#39;6000000255&#39;,&#39;SZ&#39;,&#39;000001&#39;,1, &#39;策略 1&#39;)</td></tr></tbody></table><p><strong>ORDERINGS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取某资金账号对应的委托信息</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">orderings(AccountID, [strategyName]);</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">统计某账号买入的所有的当天委托量<br>xxx := orderings(&#39;037055&#39;);<br>loo := 0;<br>for x in xxx do begin<br>if x.direction = 48 then<br>loo:= loo + x.volumetotaloriginal;<br>end<br>longorder:loo<br>xxx 为一个 orderdetail 结构体，含有如下项：<br>exchangeid 证券市场,交易所代码<br>exchangename 市场名字<br>productid 品种代码<br>productname 品种名称<br>instrumentid 证券代码,合约代码<br>instrumentname 证券名称,合约名称<br>sessionid<br>frontid 前端 id<br>orderref 下单引用 等于股票的内部委托号<br>orderpricetype 类型，例如市价单 限价单<br>direction 期货多空 股票买卖<br>offsetflag 期货开平，股票买卖其实就是开平<br>hedgeflag 投保<br>limitprice 限价单的限价，就是报价<br>volumetotaloriginal 最初委托量<br>ordersubmitstatus 提交状态<br>ordersysid 委托号<br>orderstatus 委托状态<br>volumetraded 已成交量<br>volumetotal 当前总委托量 股票不需要总委托量<br>errorid<br>errormsg 状态信息<br>taskid<br>frozenmargin 冻结保证金<br>frozencommission 冻结手续费<br>insertdate 日期<br>inserttime 时间<br>xttag 量化投研平台标签<br>tradeprice 成交均价<br>cancelamount 已撤数量<br>optname 展示委托属性的中文<br>tradeamount 成交额 期货=均价<em>量</em>合约乘数<br>entrusttype 委托类别<br>cancelinfo 废单原因<br>undercode 标的证券<br>covereflag 备兑标记 &#39;0&#39; - 非备兑，&#39;1&#39; - 备兑<br>orderpricermb 委托价格 人民币 用于港股通<br>tradeamountrmb 成交金额 人民币用于港股通<br>referencerate 参考汇率 用于港股通<br></td></tr></tbody></table><p><strong>DEAL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回某个时间内的成交数量</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">deal(AccountID , MarketID, StockID, Direction,[strategyName]);<br>或 deal(AccountID , MarketID, StockID, Direction, Senconds,[strategyName]);<br>AccountID, MarketID, StockID 为字符串；Direction 为整型（1 多，2 空）,Senconds 为整型，表示多少秒内;strategyName 自义定策略名,为字符串<br></td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">例 1：de:=deal(&#39;037055&#39;,&#39;IF&#39;,&#39;IF06&#39;,2);//返回当天 IF06 的 sell 的成交数量<br></td></tr></tbody></table><p><strong>DEALS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回资金账号的成交信息</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">deals(AccountID,[strategyName]);</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">返回某账号当天 buy 的成交量<br>xxx := deals(&#39;037055&#39;);<br>dea:= 0;<br>for x in xxx do begin<br>if x.direction = 48 then<br>dea:= dea + x.volume;<br>end<br>longdeal:dea<br>xxx 为一个 dealdetail 结构体，含有如下项：<br>exchangeid 证券市场,交易所代码<br>exchangename 市场名字<br>productid 品种代码<br>productname 品种名称<br>instrumentid 证券代码,合约代码<br>instrumentname 证券名称,合约名称<br>tradeid 成交编号<br>orderref 下单引用 等于股票的内部委托号<br>ordersysid 委托号<br>direction 买卖 股票不需要<br>offsetflag 开平 股票的买卖<br>hedgeflag 投保 股票不需要<br>price 成交均价<br>volume 成交量 期货单位手 股票做到股<br>tradedate 成交日期<br>tradetime 成交时间<br>comssion 手续费<br>tradeamount 成交额 期货=均价<em>量</em>合约乘数<br>taskid<br>xttag 量化投研平台标签<br>orderpricetype 类型，例如市价单 限价单<br>optname 展示委托属性的中文<br>entrusttype 委托类别<br>futuretradetype 成交类型<br>realoffsetflag 实际开平,主要是区分平今和平昨<br>coveredflag 备兑标记 &#39;0&#39; - 非备兑，&#39;1&#39; - 备兑<br>closetodayvolume 平今量, 不显示<br>orderpricermb 委托价格 人民币 用于港股通<br>pricermb 目前用于港股通<br>tradeamountrmb 目前用于港股通<br>referencerate 汇率,目前用于港股通<br>xttrade 是否是量化投研平台交易<br></td></tr></tbody></table><p><strong>LOADBASKET（返回结果和定义不符）</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">读取导入指定定路径下的指定的交易篮子</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">loadbasket(dir,filename,iscover) {filename 格式支持：xls、csv}<br>iscover:遇到同名篮子操作: 0 取消导入, 1 覆盖, 2 合并</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">retv:=loadbasket(&#39;c:/test/&#39;,&#39;stockbasket.csv&#39;,1)//该路径下存在对应文件返回 0，否则返回-1<br>或<br>retv:=loadbasket(&#39;c:\test\&#39;,&#39;stockbasket.csv&#39;,1)//该路径下存在对应文件返回 0，否则返回-1</td></tr></tbody></table><p><strong>CANCEL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">针对委托号进行撤单</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">CANCEL(AA)表示委托号为“AA”的委托</td></tr></tbody></table><p><strong>STOPPRICE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取个股,期货,期权涨停价,跌停价</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">stopprice(select)或 stopprice(select , market, stockCode);<br>其中 select 为整型（1 跌停价,2 涨停价）,market, stockCode 为字符串.</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">例 1：dd:=stopprice(1);//返回当前股票的跌停价<br>例 2：dd:=stopprice(1,&#39;IF&#39;,&#39;IF06&#39;,);//指定 IF06,返回 IF06 的跌停价</td></tr></tbody></table><p><strong>Contractmultiplier</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">函数返回期货合约的乘数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">contractmultiplier(&#39;&#39;) //取当前图合约的乘数<br>contractmultiplier(contract)<br>contract 为合约代码，支持变量赋值<br></td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">contract:=&#39;cu06&#39;;<br>contract:=&#39;cu06&#39;;</td></tr></tbody></table><h2 id="系统函数" tabindex="-1"><a class="header-anchor" href="#系统函数" aria-hidden="true">#</a> 系统函数</h2><p><strong>PRINTOUT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">把变量输出到文件</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">PRINTOUT(X,Y)</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">//模型名是“新建模型 1”<br>X : CLOSE;<br>Y : HIGH;<br>PRINTOUT(X,Y);//在安装目录的 BIN 子目录下生成名为：新建模型 1.OUT</td></tr></tbody></table><p><strong>ISEQUALV</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">判断两个数是否相等</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ISEQUALV（X，Y）判断X和Y是否相等，相等返回 1，否则返回 0</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ISEQUALV(2,2);//返回 1</td></tr></tbody></table><p><strong>ISGREATER</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">判断是否大于</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ISGREATER（A,B）,如果 A 大于 B 返回 1，否则返回 0</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ISGREATER(5,4);//返回 1</td></tr></tbody></table><p><strong>ISGREATEREQUAL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">判断是否大于等于</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ISGREATEREQUAL（A,B）,如果 A 大于等于 B 返回 1，否则返回 0</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ISGREATEREQUAL(1,1);//返回 1</td></tr></tbody></table><p><strong>ISLESSEQUAL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">判断是否小于等于</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ISLESSEQUAL（A,B），如果 A 小于等于 B 返回 1，否则返回 0</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ISLESSEQUAL(2,1);//返回 0</td></tr></tbody></table><p><strong>ISVALID</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">判断是否为有效数据</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ISVALID(X)判断X是否是有效数据。有效数据时返回1,否则返回0</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ISVALID(2/0);//返回 0</td></tr></tbody></table><p><strong>NOSORTED</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">对集合中的元素不进行排序，在不计算排名的情况下使用</th></tr></thead><tbody><tr><td style="text-align:center;">示例</td><td style="text-align:left;">NOSORTED($ZZZ);//表示对股票篮子 ZZZ 不排序</td></tr></tbody></table><p><strong>EXIST</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">判断是否存在下标中</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">EXIST(SELLMMM[], SELLRANK)</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">EXIST(SELLMMM[], SELLRANK);//如果 SELLMMM 下标存在 SELLRANK 返回 1，否则返回 0</td></tr></tbody></table><p><strong>HOLDINGORNOT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">判断是否存在集合或数组中</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">HOLDINGORNOT(A[],B);//如果 A 中存在 B 返回 1，或者返回 0</td></tr></tbody></table><p><strong>TOHOLD</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">把股票加入到一个集合中</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">TOHOLD(POSITION,STOCKID);//表示把股票 STOCKID 加入到 POSITION 中</td></tr></tbody></table><p><strong>TOABANDON</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">把股票从集合中删除</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">TOABANDON(POSITION,STOCKID);//表示把股票 STOCKID 从 POSITION 中删除</td></tr></tbody></table><p><strong>SETDATAALIGNMODE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">当模型引用了多个品种的数据时，该函数设置数据对齐的方式，该函数有 1 个参数，取值说明如下：<br>0：当前 K线所有品种的数据到齐后才开始计算 <br>1：当前 K 线只要主图品种的数据到了后就开始计算</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SETDATAALIGNMODE（1）;//当前K线只要主图品种的数据到了后就开始计算</td></tr></tbody></table><p><strong>SENDMAIL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">发送邮件，该函数有 7 个参数，取值说明如下：<br>SERVERNAME smtp 或 pop 服务器地址USERNAME<br>发 送 邮 箱 地 址<br>PASSWORD 发 送 邮 箱 登 陆 密 码<br>RECVNAME 接 收 者 姓 名<br>RECVADDR 接 收 者 邮 箱 地 址<br>SUBJECT 标题<br>CONTENT 内容</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SENDMAIL(&#39;smtp.thinktrader.net&#39;,&#39;zhangsan@thinktrader.net&#39;,&#39;123456&#39;,&#39;lisi&#39;,&#39;lisi@thinktrader.net&#39;,&#39;say hello&#39;,&#39;Hello,lisi&#39;)</td></tr></tbody></table><h2 id="附加函数" tabindex="-1"><a class="header-anchor" href="#附加函数" aria-hidden="true">#</a> 附加函数</h2><p><strong>CONST</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取常数值</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">CONST(A)返回 A 的常数值</td></tr></tbody></table><p><strong>ISBUYORDER</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该成交是否为主动性买单</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ISBUYORDER()仅用于分笔图</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ISBUYORDER();//当本笔成交为主动性买盘时,返回1,否则为0</td></tr></tbody></table><p><strong>ISSELLORDER</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">取得该成交是否为主动性卖单</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">ISSELLORDER()仅用于分笔图</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">ISSELLORDER();//当本笔成交为主动性卖盘时,返回1,否则为0</td></tr></tbody></table><p><strong>BUYVOL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">主动性买单量</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">BUYVOL()仅用于分笔图,非主动性买单返回 0</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">BUYVOL();//当本笔成交为主动性买盘时,其数值等于成交量,否则为0</td></tr></tbody></table><p><strong>SELLVOL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">主动性卖单量</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">SELLVOL()仅用于分笔图，非主动性卖单返回 0</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">SELLVOL();//当本笔成交为主动性卖盘时,其数值等于成交量,否则为0</td></tr></tbody></table><p><strong>UPNDAY</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回是否连涨周期数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">UPNDAY(X,N)判断X是否连续N周期上涨</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">upclose:=UPNDAY(close,2);//判断是否收盘价连续两周期上涨<br>ma5:=MA(CLOSE,5);<br>UPma5:UPNDAY(ma5,5);//判断5日均线是否连续五周期上涨</td></tr></tbody></table><p><strong>DOWNNDAY</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回是否连跌周期数</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">DOWNNDAY(X,N)判断X是否连续N周期下跌</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">DOWNclose:=DOWNNDAY(close,2);//判断是否收盘价连续两周期下跌<br>ma5:=MA(CLOSE,5);<br>DOWNma5:DOWNNDAY(ma5,5);//判断5日均线是否连续五周期下跌</td></tr></tbody></table><p><strong>NDAY</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">判断是否多周期一直有某式成立</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">NDAY(X,N)判断在N个周期内X一直满足</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">NDAY(close&gt;open,2);//判断是否连续两周期收盘价大于开盘价</td></tr></tbody></table><p><strong>BUYSELLVOLS</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">获取当前标的品种总买、总卖量</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">BUYSELLVOLS(MODE)MODE为0或1,0代表获取总卖,1代表获取总买。Level-2专用</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">BUYSELLVOLS(0);//获取当前标的品种总卖量<br>BUYSELLVOLS(1);//获取当前标的品种总买量</td></tr></tbody></table><p><strong>GETOPENDATE</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">获取当前标的品种总买、总卖量</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">GETOPENDATE(S)获取股票S上市日期,S为股票代码与交易所代码组合代码,如&#39;SH600000&#39;,当S为空,取当前主界面显示的交易所及合约代码.，返回值为YYYYMMDD</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">GETOPENDATE(&#39;&#39;);//获取当前主图标的上市日期<br>BUYSELLVOLS(&#39;SH600000&#39;);//获取SH600000上市日期</td></tr></tbody></table><p><strong>GETOPENAMOUNT</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">获取当前主界面显示的合约代码集合竞价的成交额</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">GETOPENAMOUNT()</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">GETOPENAMOUNT();//获取主图标的集合竞价的成交额</td></tr></tbody></table><p><strong>GETOPENVOL</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">获取当前主界面显示的合约代码集合竞价的成交量(手)</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">GETOPENVOL()</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">GETOPENVOL();//获取主图标的集合竞价的成交量</td></tr></tbody></table><p><strong>TICKVOLDISTRIBUTION</strong></p><table><thead><tr><th style="text-align:center;">释义</th><th style="text-align:left;">返回固定时间范围内成交量分布中超过某个占比对应的最优 VOL</th></tr></thead><tbody><tr><td style="text-align:center;">用法</td><td style="text-align:left;">TICKVOLDISTRIBUTION(seconds,ratio,direction),seconds:秒数, ratio:总笔数占比(0~1],direction:0 all,1 buy,2 sell</td></tr><tr><td style="text-align:center;">示例</td><td style="text-align:left;">TICKVOLDISTRIBUTION(120,0.4,1);//主动性买盘 120 秒内占总笔数 40%的最优vol值</td></tr></tbody></table></div></div><!--[--><!--]--></div>

<nav class="page-nav" data-v-3c904194><p class="inner"><span class="prev"><a href="../VBA/operating_mode.html" class="" aria-label="运行机制"><!--[--><!--]--> 运行机制 <!--[--><!--]--></a></span><span class="next"><a href="../VBA/code_examples.html" class="" aria-label="完整示例"><!--[--><!--]--> 完整示例 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>

  <div class="toFixedCopy wxFixed" style="text-align: center"><a href="https://work.weixin.qq.com/ca/cawcde1dc261ca71f1" target="_blank" rel="noopener noreferrer">联系微信获取权限<br><img src="../assets/联系客户经理.png" alt="微信扫码联系客服" title="点击联系客服" style="width:150px;"></a></div></body>
</html>
