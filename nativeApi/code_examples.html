
<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.67">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    
	<title>完整实例 </title><meta name="description" content="QMT说明, QMT-Python-API, QMT用户手册。">
    <link rel="preload" href="../assets/style-8436f03b.css" as="style"><link rel="stylesheet" href="../assets/style-8436f03b.css">
    <link rel="modulepreload" href="../assets/app-99722cb8.js"><link rel="modulepreload" href="../assets/code_examples.html-37f2c141.js"><link rel="modulepreload" href="../assets/code_examples.html-f1708e88.js"><link rel="prefetch" href="../assets/index.html-93a0007d.js" as="script"><link rel="prefetch" href="../assets/basic_syntax.html-e393df56.js" as="script"><link rel="prefetch" href="../assets/check_sheet.html-a405c8a3.js" as="script"><link rel="prefetch" href="../assets/code_examples.html-985b4984.js" as="script"><link rel="prefetch" href="../assets/control_statement.html-bf992bd7.js" as="script"><link rel="prefetch" href="../assets/operating_mode.html-a2f39c1a.js" as="script"><link rel="prefetch" href="../assets/start_now.html-1be21f8a.js" as="script"><link rel="prefetch" href="../assets/system_function.html-49a65798.js" as="script"><link rel="prefetch" href="../assets/index.html-179668eb.js" as="script"><link rel="prefetch" href="../assets/bond.html-d9c1be0d.js" as="script"><link rel="prefetch" href="../assets/floorfunds.html-8810bed2.js" as="script"><link rel="prefetch" href="../assets/future.html-8c1c26b7.js" as="script"><link rel="prefetch" href="../assets/indexes.html-ec6ecef0.js" as="script"><link rel="prefetch" href="../assets/industry.html-cffc4e77.js" as="script"><link rel="prefetch" href="../assets/option.html-1d25e189.js" as="script"><link rel="prefetch" href="../assets/question_answer.html-bed5ae76.js" as="script"><link rel="prefetch" href="../assets/stock.html-035c3630.js" as="script"><link rel="prefetch" href="../assets/python调用VBA.html-e92f2331.js" as="script"><link rel="prefetch" href="../assets/全市场涨跌幅度统计.html-b8ba35f1.js" as="script"><link rel="prefetch" href="../assets/全市场资金流向.html-3bd359eb.js" as="script"><link rel="prefetch" href="../assets/北向资金.html-c14449da.js" as="script"><link rel="prefetch" href="../assets/南向资金.html-ed8f1d67.js" as="script"><link rel="prefetch" href="../assets/外盘_内盘.html-f9f023d3.js" as="script"><link rel="prefetch" href="../assets/多空对比.html-a634bb69.js" as="script"><link rel="prefetch" href="../assets/委买价_委卖价_委买量_委卖量.html-e791f06d.js" as="script"><link rel="prefetch" href="../assets/总市值.html-54cae4e7.js" as="script"><link rel="prefetch" href="../assets/总股本_涨停_跌停.html-9495eb6a.js" as="script"><link rel="prefetch" href="../assets/换手.html-396e0a2d.js" as="script"><link rel="prefetch" href="../assets/最新_今开_最高_最低_总额_总手_交易状态.html-1ae0fd22.js" as="script"><link rel="prefetch" href="../assets/注册资本.html-061f0b8d.js" as="script"><link rel="prefetch" href="../assets/流通盘.html-26dbb5b3.js" as="script"><link rel="prefetch" href="../assets/涨跌_涨幅.html-c4201ae4.js" as="script"><link rel="prefetch" href="../assets/涨跌家数变化.html-a30316a7.js" as="script"><link rel="prefetch" href="../assets/规模风向标.html-d7dc3f5e.js" as="script"><link rel="prefetch" href="../assets/量比.html-ca6f9a2e.js" as="script"><link rel="prefetch" href="../assets/rookie.html-df76d0ad.js" as="script"><link rel="prefetch" href="../assets/download_xtquant.html-337a4246.js" as="script"><link rel="prefetch" href="../assets/question_function.html-92b003d3.js" as="script"><link rel="prefetch" href="../assets/start_now.html-b45a357d.js" as="script"><link rel="prefetch" href="../assets/xtdata.html-97c855c0.js" as="script"><link rel="prefetch" href="../assets/xttrader.html-cb4abe04.js" as="script"><link rel="prefetch" href="../assets/callback_function.html-4153be6c.js" as="script"><link rel="prefetch" href="../assets/code_examples.html-c1ae1001.js" as="script"><link rel="prefetch" href="../assets/data_function.html-2411bf01.js" as="script"><link rel="prefetch" href="../assets/data_structure.html-a96a202d.js" as="script"><link rel="prefetch" href="../assets/drawing_function.html-dee669df.js" as="script"><link rel="prefetch" href="../assets/enum_constants.html-2c1f6dcc.js" as="script"><link rel="prefetch" href="../assets/interface_operation.html-47a2cf15.js" as="script"><link rel="prefetch" href="../assets/question_answer.html-4f12deae.js" as="script"><link rel="prefetch" href="../assets/quote_function.html-827e9fb8.js" as="script"><link rel="prefetch" href="../assets/related_instructions.html-9b630c20.js" as="script"><link rel="prefetch" href="../assets/start_now.html-79f8f415.js" as="script"><link rel="prefetch" href="../assets/system_function.html-03a1dc3a.js" as="script"><link rel="prefetch" href="../assets/trading_function.html-3c0f4ee8.js" as="script"><link rel="prefetch" href="../assets/user_attention.html-e0d27a96.js" as="script"><link rel="prefetch" href="../assets/variable_convention.html-17caf0d6.js" as="script"><link rel="prefetch" href="../assets/JoinQuant2QMT.html-38cb9974.js" as="script"><link rel="prefetch" href="../assets/index.html-22b6b31a.js" as="script"><link rel="prefetch" href="../assets/daoru_daochu.html-c8cace75.js" as="script"><link rel="prefetch" href="../assets/hangqing_setting.html-1a9570b3.js" as="script"><link rel="prefetch" href="../assets/ty_add_indicator.html-1f2f4b0a.js" as="script"><link rel="prefetch" href="../assets/ty_backtest_strategy.html-270aeeab.js" as="script"><link rel="prefetch" href="../assets/ty_code_review_backtest.html-200ceddd.js" as="script"><link rel="prefetch" href="../assets/ty_content.html-bac1ad25.js" as="script"><link rel="prefetch" href="../assets/ty_data_download.html-351b4a4f.js" as="script"><link rel="prefetch" href="../assets/ty_data_interface.html-2e32a98a.js" as="script"><link rel="prefetch" href="../assets/ty_direct_connect.html-f8b10f83.js" as="script"><link rel="prefetch" href="../assets/ty_factor_data.html-1746bcaa.js" as="script"><link rel="prefetch" href="../assets/ty_linux_xtquant_data.html-44bf60fb.js" as="script"><link rel="prefetch" href="../assets/ty_native_python.html-8028f714.js" as="script"><link rel="prefetch" href="../assets/ty_register_install.html-0d2c078f.js" as="script"><link rel="prefetch" href="../assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="../assets/index.html-23445d95.js" as="script"><link rel="prefetch" href="../assets/basic_syntax.html-5af886ee.js" as="script"><link rel="prefetch" href="../assets/check_sheet.html-5184a806.js" as="script"><link rel="prefetch" href="../assets/code_examples.html-aa1deec9.js" as="script"><link rel="prefetch" href="../assets/control_statement.html-3b20a2b9.js" as="script"><link rel="prefetch" href="../assets/operating_mode.html-fd0ec393.js" as="script"><link rel="prefetch" href="../assets/start_now.html-bdc1834b.js" as="script"><link rel="prefetch" href="../assets/system_function.html-4f0942d4.js" as="script"><link rel="prefetch" href="../assets/index.html-a0cb365e.js" as="script"><link rel="prefetch" href="../assets/bond.html-7a63f47e.js" as="script"><link rel="prefetch" href="../assets/floorfunds.html-9746e82a.js" as="script"><link rel="prefetch" href="../assets/future.html-dff59680.js" as="script"><link rel="prefetch" href="../assets/indexes.html-f0ffc2ed.js" as="script"><link rel="prefetch" href="../assets/industry.html-6c37727a.js" as="script"><link rel="prefetch" href="../assets/option.html-bc239cdd.js" as="script"><link rel="prefetch" href="../assets/question_answer.html-eb13f2ba.js" as="script"><link rel="prefetch" href="../assets/stock.html-5b93fe23.js" as="script"><link rel="prefetch" href="../assets/python调用VBA.html-f3232163.js" as="script"><link rel="prefetch" href="../assets/全市场涨跌幅度统计.html-0615d22a.js" as="script"><link rel="prefetch" href="../assets/全市场资金流向.html-0e599d6b.js" as="script"><link rel="prefetch" href="../assets/北向资金.html-dabcf598.js" as="script"><link rel="prefetch" href="../assets/南向资金.html-dbd875ea.js" as="script"><link rel="prefetch" href="../assets/外盘_内盘.html-5f883999.js" as="script"><link rel="prefetch" href="../assets/多空对比.html-11c1c488.js" as="script"><link rel="prefetch" href="../assets/委买价_委卖价_委买量_委卖量.html-0df576f7.js" as="script"><link rel="prefetch" href="../assets/总市值.html-e1af9791.js" as="script"><link rel="prefetch" href="../assets/总股本_涨停_跌停.html-41245f1b.js" as="script"><link rel="prefetch" href="../assets/换手.html-2811be82.js" as="script"><link rel="prefetch" href="../assets/最新_今开_最高_最低_总额_总手_交易状态.html-b756ceca.js" as="script"><link rel="prefetch" href="../assets/注册资本.html-049b932e.js" as="script"><link rel="prefetch" href="../assets/流通盘.html-e48d17b3.js" as="script"><link rel="prefetch" href="../assets/涨跌_涨幅.html-c49f09e7.js" as="script"><link rel="prefetch" href="../assets/涨跌家数变化.html-b0a2702d.js" as="script"><link rel="prefetch" href="../assets/规模风向标.html-8caa0565.js" as="script"><link rel="prefetch" href="../assets/量比.html-13e416e5.js" as="script"><link rel="prefetch" href="../assets/rookie.html-e305c3cb.js" as="script"><link rel="prefetch" href="../assets/download_xtquant.html-7a7ee88f.js" as="script"><link rel="prefetch" href="../assets/question_function.html-437cccea.js" as="script"><link rel="prefetch" href="../assets/start_now.html-01155b75.js" as="script"><link rel="prefetch" href="../assets/xtdata.html-1e0a07b7.js" as="script"><link rel="prefetch" href="../assets/xttrader.html-ed1b1fe5.js" as="script"><link rel="prefetch" href="../assets/callback_function.html-a1ef7560.js" as="script"><link rel="prefetch" href="../assets/code_examples.html-8a240771.js" as="script"><link rel="prefetch" href="../assets/data_function.html-94c8c7e6.js" as="script"><link rel="prefetch" href="../assets/data_structure.html-47f36229.js" as="script"><link rel="prefetch" href="../assets/drawing_function.html-ad741397.js" as="script"><link rel="prefetch" href="../assets/enum_constants.html-6a4d27a4.js" as="script"><link rel="prefetch" href="../assets/interface_operation.html-9b7579d2.js" as="script"><link rel="prefetch" href="../assets/question_answer.html-15175a6b.js" as="script"><link rel="prefetch" href="../assets/quote_function.html-86d4ef78.js" as="script"><link rel="prefetch" href="../assets/related_instructions.html-b4f87603.js" as="script"><link rel="prefetch" href="../assets/start_now.html-d25bd7fe.js" as="script"><link rel="prefetch" href="../assets/system_function.html-b5032370.js" as="script"><link rel="prefetch" href="../assets/trading_function.html-51206dd7.js" as="script"><link rel="prefetch" href="../assets/user_attention.html-d2df5640.js" as="script"><link rel="prefetch" href="../assets/variable_convention.html-8bcc5c5f.js" as="script"><link rel="prefetch" href="../assets/JoinQuant2QMT.html-5a5867f6.js" as="script"><link rel="prefetch" href="../assets/index.html-925d7c12.js" as="script"><link rel="prefetch" href="../assets/daoru_daochu.html-9feb8edf.js" as="script"><link rel="prefetch" href="../assets/hangqing_setting.html-6f4f36fa.js" as="script"><link rel="prefetch" href="../assets/ty_add_indicator.html-ab4dcef5.js" as="script"><link rel="prefetch" href="../assets/ty_backtest_strategy.html-3da9fb3c.js" as="script"><link rel="prefetch" href="../assets/ty_code_review_backtest.html-bc72c419.js" as="script"><link rel="prefetch" href="../assets/ty_content.html-93b129b3.js" as="script"><link rel="prefetch" href="../assets/ty_data_download.html-6381aec1.js" as="script"><link rel="prefetch" href="../assets/ty_data_interface.html-2a716790.js" as="script"><link rel="prefetch" href="../assets/ty_direct_connect.html-b63051ab.js" as="script"><link rel="prefetch" href="../assets/ty_factor_data.html-5f08c397.js" as="script"><link rel="prefetch" href="../assets/ty_linux_xtquant_data.html-bf571773.js" as="script"><link rel="prefetch" href="../assets/ty_native_python.html-264f76d4.js" as="script"><link rel="prefetch" href="../assets/ty_register_install.html-cfe8e155.js" as="script"><link rel="prefetch" href="../assets/404.html-a36e0f1a.js" as="script"><link rel="prefetch" href="../assets/SearchBox-a1914cb6.js" as="script"><link rel="prefetch" href="../assets/auto-6adc87e8.js" as="script"><link rel="prefetch" href="../assets/index-2bf332f6.js" as="script"><link rel="prefetch" href="../assets/flowchart-c441f34d.js" as="script"><link rel="prefetch" href="../assets/SignPanel-39d95e93.js" as="script"><link rel="prefetch" href="../assets/SignPanel-39d95e93.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[-->
	
	<div class="sidebar-mask"></div><!--[--><aside class="sidebar">
	
	<ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">原生Python <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="../nativeApi/start_now.html" class="sidebar-item" aria-label="快速开始"><!--[--><!--]--> 快速开始 <!--[--><!--]--></a><!----></li><li><a href="../nativeApi/xtdata.html" class="sidebar-item" aria-label="XtQuant.XtData 行情模块"><!--[--><!--]--> XtQuant.XtData 行情模块 <!--[--><!--]--></a><!----></li><li><a href="../nativeApi/xttrader.html" class="sidebar-item" aria-label="XtQuant.Xttrade 交易模块"><!--[--><!--]--> XtQuant.Xttrade 交易模块 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../nativeApi/code_examples.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="完整实例"><!--[--><!--]--> 完整实例 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="../nativeApi/code_examples.html#行情示例" class="router-link-active router-link-exact-active sidebar-item" aria-label="行情示例"><!--[--><!--]--> 行情示例 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="../nativeApi/code_examples.html#获取行情示例" class="router-link-active router-link-exact-active sidebar-item" aria-label="获取行情示例"><!--[--><!--]--> 获取行情示例 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../nativeApi/code_examples.html#链接vip服务器" class="router-link-active router-link-exact-active sidebar-item" aria-label="链接VIP服务器"><!--[--><!--]--> 链接VIP服务器 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../nativeApi/code_examples.html#连接指定服务器" class="router-link-active router-link-exact-active sidebar-item" aria-label="连接指定服务器"><!--[--><!--]--> 连接指定服务器 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../nativeApi/code_examples.html#订阅全推数据-下载历史数据" class="router-link-active router-link-exact-active sidebar-item" aria-label="订阅全推数据/下载历史数据"><!--[--><!--]--> 订阅全推数据/下载历史数据 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../nativeApi/code_examples.html#获取对手价" class="router-link-active router-link-exact-active sidebar-item" aria-label="获取对手价"><!--[--><!--]--> 获取对手价 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../nativeApi/code_examples.html#获取5档盘口行情" class="router-link-active router-link-exact-active sidebar-item" aria-label="获取5档盘口行情"><!--[--><!--]--> 获取5档盘口行情 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../nativeApi/code_examples.html#复权计算方式" class="router-link-active router-link-exact-active sidebar-item" aria-label="复权计算方式"><!--[--><!--]--> 复权计算方式 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../nativeApi/code_examples.html#根据商品期货期权代码获取对应的商品期货合约代码" class="router-link-active router-link-exact-active sidebar-item" aria-label="根据商品期货期权代码获取对应的商品期货合约代码"><!--[--><!--]--> 根据商品期货期权代码获取对应的商品期货合约代码 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../nativeApi/code_examples.html#根据指数代码-返回对应的期货合约" class="router-link-active router-link-exact-active sidebar-item" aria-label="根据指数代码，返回对应的期货合约"><!--[--><!--]--> 根据指数代码，返回对应的期货合约 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="../nativeApi/code_examples.html#交易示例" class="router-link-active router-link-exact-active sidebar-item" aria-label="交易示例"><!--[--><!--]--> 交易示例 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="../nativeApi/code_examples.html#order-stock-async-下单" class="router-link-active router-link-exact-active sidebar-item" aria-label="order_stock_async - 下单"><!--[--><!--]--> order_stock_async - 下单 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../nativeApi/code_examples.html#交易接口重连" class="router-link-active router-link-exact-active sidebar-item" aria-label="交易接口重连"><!--[--><!--]--> 交易接口重连 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="../nativeApi/code_examples.html#信用账号执行还款" class="router-link-active router-link-exact-active sidebar-item" aria-label="信用账号执行还款"><!--[--><!--]--> 信用账号执行还款 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a href="../nativeApi/question_function.html" class="sidebar-item" aria-label="常见问题"><!--[--><!--]--> 常见问题 <!--[--><!--]--></a><!----></li>
	
	<!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page" data-v-3c904194><!--[--><!--]--><div class="theme-default-contents" data-v-3c904194><!----><!--[--><!--]--><div class="theme-default-content" data-v-3c904194><div data-v-3c904194><h2 id="行情示例" tabindex="-1"><a class="header-anchor" href="#行情示例" aria-hidden="true">#</a> 行情示例</h2><h3 id="获取行情示例" tabindex="-1"><a class="header-anchor" href="#获取行情示例" aria-hidden="true">#</a> 获取行情示例</h3><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-6-0" aria-selected="true">新手示例</button></div><!--[--><div class="vp-tab active" id="tab-6-0" role="tabpanel" aria-expanded="true"><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#6272A4;"># 用前须知</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">## xtdata提供和MiniQmt的交互接口，本质是和MiniQmt建立连接，由MiniQmt处理行情数据请求，再把结果回传返回到python层。使用的行情服务器以及能获取到的行情数据和MiniQmt是一致的，要检查数据或者切换连接时直接操作MiniQmt即可。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">## 对于数据获取接口，使用时需要先确保MiniQmt已有所需要的数据，如果不足可以通过补充数据接口补充，再调用数据获取接口获取。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">## 对于订阅接口，直接设置数据回调，数据到来时会由回调返回。订阅接收到的数据一般会保存下来，同种数据不需要再单独补充。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 代码讲解</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 从本地python导入xtquant库，如果出现报错则说明安装失败</span></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> xtdata</span></span>
<span class="line"><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> time</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 设定一个标的列表</span></span>
<span class="line"><span style="color:#F8F8F2;">code_list </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> [</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">000001.SZ</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">]</span></span>
<span class="line"><span style="color:#6272A4;"># 设定获取数据的周期</span></span>
<span class="line"><span style="color:#F8F8F2;">period </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">1d</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 下载标的行情数据</span></span>
<span class="line"><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;">## 为了方便用户进行数据管理，xtquant的大部分历史数据都是以压缩形式存储在本地的</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;">## 比如行情数据，需要通过download_history_data下载，财务数据需要通过</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;">## 所以在取历史数据之前，我们需要调用数据下载接口，将数据下载到本地</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> i </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> code_list:</span></span>
<span class="line"><span style="color:#F8F8F2;">        xtdata.download_history_data(i,</span><span style="color:#FFB86C;font-style:italic;">period</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">period,</span><span style="color:#FFB86C;font-style:italic;">incrementally</span><span style="color:#FF79C6;">=</span><span style="color:#BD93F9;">True</span><span style="color:#F8F8F2;">) </span><span style="color:#6272A4;"># 增量下载行情数据（开高低收,等等）到本地</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span></span>
<span class="line"><span style="color:#F8F8F2;">    xtdata.download_financial_data(code_list) </span><span style="color:#6272A4;"># 下载财务数据到本地</span></span>
<span class="line"><span style="color:#F8F8F2;">    xtdata.download_sector_data() </span><span style="color:#6272A4;"># 下载板块数据到本地</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 更多数据的下载方式可以通过数据字典查询</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 读取本地历史行情数据</span></span>
<span class="line"><span style="color:#F8F8F2;">history_data </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdata.get_market_data_ex([],code_list,</span><span style="color:#FFB86C;font-style:italic;">period</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">period,</span><span style="color:#FFB86C;font-style:italic;">count</span><span style="color:#FF79C6;">=-</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(history_data)</span></span>
<span class="line"><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 如果需要盘中的实时行情，需要向服务器进行订阅后才能获取</span></span>
<span class="line"><span style="color:#6272A4;"># 订阅后，get_market_data函数于get_market_data_ex函数将会自动拼接本地历史行情与服务器实时行情</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 向服务器订阅数据</span></span>
<span class="line"><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> i </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> code_list:</span></span>
<span class="line"><span style="color:#F8F8F2;">    xtdata.subscribe_quote(i,</span><span style="color:#FFB86C;font-style:italic;">period</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">period,</span><span style="color:#FFB86C;font-style:italic;">count</span><span style="color:#FF79C6;">=-</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">) </span><span style="color:#6272A4;"># 设置count = -1来取到当天所有实时行情</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 等待订阅完成</span></span>
<span class="line"><span style="color:#F8F8F2;">time.sleep(</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 获取订阅后的行情</span></span>
<span class="line"><span style="color:#F8F8F2;">kline_data </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdata.get_market_data_ex([],code_list,</span><span style="color:#FFB86C;font-style:italic;">period</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">period)</span></span>
<span class="line"><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(kline_data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 获取订阅后的行情，并以固定间隔进行刷新,预期会循环打印10次</span></span>
<span class="line"><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> i </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">range</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">10</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 这边做演示，就用for来循环了，实际使用中可以用while True</span></span>
<span class="line"><span style="color:#F8F8F2;">    kline_data </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdata.get_market_data_ex([],code_list,</span><span style="color:#FFB86C;font-style:italic;">period</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">period)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(kline_data)</span></span>
<span class="line"><span style="color:#F8F8F2;">    time.sleep(</span><span style="color:#BD93F9;">3</span><span style="color:#F8F8F2;">) </span><span style="color:#6272A4;"># 三秒后再次获取行情</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 如果不想用固定间隔触发，可以以用订阅后的回调来执行</span></span>
<span class="line"><span style="color:#6272A4;"># 这种模式下当订阅的callback回调函数将会异步的执行，每当订阅的标的tick发生变化更新，callback回调函数就会被调用一次</span></span>
<span class="line"><span style="color:#6272A4;"># 本地已有的数据不会触发callback</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span></span>
<span class="line"><span style="color:#6272A4;"># 定义的回测函数</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;">## 回调函数中，data是本次触发回调的数据，只有一条</span></span>
<span class="line"><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">f</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">data</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># print(data)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span></span>
<span class="line"><span style="color:#F8F8F2;">    code_list </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;font-style:italic;">list</span><span style="color:#F8F8F2;">(data.keys())    </span><span style="color:#6272A4;"># 获取到本次触发的标的代码</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    kline_in_callabck </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdata.get_market_data_ex([],code_list,</span><span style="color:#FFB86C;font-style:italic;">period</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> period)    </span><span style="color:#6272A4;"># 在回调中获取klines数据</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(kline_in_callabck)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> i </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> code_list:</span></span>
<span class="line"><span style="color:#F8F8F2;">    xtdata.subscribe_quote(i,</span><span style="color:#FFB86C;font-style:italic;">period</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">period,</span><span style="color:#FFB86C;font-style:italic;">count</span><span style="color:#FF79C6;">=-</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">,</span><span style="color:#FFB86C;font-style:italic;">callback</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">f) </span><span style="color:#6272A4;"># 订阅时设定回调函数</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 使用回调时，必须要同时使用xtdata.run()来阻塞程序，否则程序运行到最后一行就直接结束退出了。</span></span>
<span class="line"><span style="color:#F8F8F2;">xtdata.run()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--]--></div><h3 id="链接vip服务器" tabindex="-1"><a class="header-anchor" href="#链接vip服务器" aria-hidden="true">#</a> 链接VIP服务器</h3><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-14-0" aria-selected="true">python</button></div><!--[--><div class="vp-tab active" id="tab-14-0" role="tabpanel" aria-expanded="true"><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#6272A4;"># 导入 xtdatacenter 模块</span></span>
<span class="line"><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">Python 版本：</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">, sys.version)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> time</span></span>
<span class="line"><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> pandas </span><span style="color:#FF79C6;">as</span><span style="color:#F8F8F2;"> pd</span></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> xtdatacenter </span><span style="color:#FF79C6;">as</span><span style="color:#F8F8F2;"> xtdc</span></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> xtdata</span></span>
<span class="line"><span style="color:#6272A4;">&#39;&#39;&#39;  </span></span>
<span class="line"><span style="color:#6272A4;">设置用于登录行情服务的token，此接口应该先于 init_quote 调用</span></span>
<span class="line"><span style="color:#6272A4;">&#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">xtdc.set_token(</span><span style="color:#E9F284;">&#39;&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">&#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#6272A4;">设置连接池,使服务器只在连接池内优选</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">建议将VIP服务器设为连接池</span></span>
<span class="line"><span style="color:#6272A4;">&#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">addr_list </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> [</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">115.231.218.73:55310</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">115.231.218.79:55310</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">218.16.123.11:55310</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">218.16.123.27:55310</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">    ]</span></span>
<span class="line"><span style="color:#F8F8F2;">xtdc.set_allow_optmize_address(addr_list)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">xtdc.set_kline_mirror_enabled(</span><span style="color:#BD93F9;">True</span><span style="color:#F8F8F2;">) </span><span style="color:#6272A4;"># 开启K线全推功能(vip),以获取全市场实时K线数据</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">初始化</span></span>
<span class="line"><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">xtdc.init()</span></span>
<span class="line"><span style="color:#6272A4;">## 监听端口</span></span>
<span class="line"><span style="color:#F8F8F2;">port </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdc.listen(</span><span style="color:#FFB86C;font-style:italic;">port</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">58621</span><span style="color:#F8F8F2;">) </span><span style="color:#6272A4;"># 指定固定端口进行连接</span></span>
<span class="line"><span style="color:#6272A4;"># port = xtdc.listen(port = (58620, 58630)) 通过指定port范围，可以让xtdc在范围内自动寻找可用端口</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">xtdata.connect(</span><span style="color:#FFB86C;font-style:italic;">port</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;">port)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">-----连接上了------</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(xtdata.data_dir)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">servers </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdata.get_quote_server_status()</span></span>
<span class="line"><span style="color:#6272A4;"># print(servers)</span></span>
<span class="line"><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> k, v </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> servers.items():</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(k, v)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">xtdata.run()</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--]--></div><h3 id="连接指定服务器" tabindex="-1"><a class="header-anchor" href="#连接指定服务器" aria-hidden="true">#</a> 连接指定服务器</h3><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-22-0" aria-selected="true">python</button></div><!--[--><div class="vp-tab active" id="tab-22-0" role="tabpanel" aria-expanded="true"><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> time</span></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> xtdata</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">#用token方式连接，不需要账号密码</span></span>
<span class="line"><span style="color:#6272A4;">#其他连接方式，需要账号密码</span></span>
<span class="line"><span style="color:#F8F8F2;">info </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> {</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">ip</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">: </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">218.16.123.122</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">port</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">: </span><span style="color:#BD93F9;">55300</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">username</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">: </span><span style="color:#E9F284;">&#39;&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">pwd</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">: </span><span style="color:#E9F284;">&#39;&#39;</span><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">connect_success </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span></span>
<span class="line"><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">func</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">d</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">    ip </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> d.get(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">ip</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">    port </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> d.get(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">port</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">    status </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> d.get(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">status</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">disconnected</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">global</span><span style="color:#F8F8F2;"> connect_success</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> ip </span><span style="color:#FF79C6;">==</span><span style="color:#F8F8F2;"> info[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">ip</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">and</span><span style="color:#F8F8F2;"> port </span><span style="color:#FF79C6;">==</span><span style="color:#F8F8F2;"> info[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">port</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">]:</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> status </span><span style="color:#FF79C6;">==</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">connected</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">            connect_success </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">else</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">            connect_success </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 注册连接回调信息</span></span>
<span class="line"><span style="color:#F8F8F2;">xtdata.watch_quote_server_status(func)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 行情连接</span></span>
<span class="line"><span style="color:#F8F8F2;">qs </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdata.QuoteServer(info)</span></span>
<span class="line"><span style="color:#F8F8F2;">qs.connect()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 等待连接状态</span></span>
<span class="line"><span style="color:#FF79C6;">while</span><span style="color:#F8F8F2;"> connect_success </span><span style="color:#FF79C6;">==</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">    time.sleep(</span><span style="color:#BD93F9;">0.3</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> connect_success </span><span style="color:#FF79C6;">==</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">连接失败</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--]--></div><h3 id="订阅全推数据-下载历史数据" tabindex="-1"><a class="header-anchor" href="#订阅全推数据-下载历史数据" aria-hidden="true">#</a> 订阅全推数据/下载历史数据</h3><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-30-0" aria-selected="true">python</button></div><!--[--><div class="vp-tab active" id="tab-30-0" role="tabpanel" aria-expanded="true"><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#6272A4;"># coding:utf-8</span></span>
<span class="line"><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> time</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> xtdata</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">code </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">600000.SH</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">#取全推数据</span></span>
<span class="line"><span style="color:#F8F8F2;">full_tick </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdata.get_full_tick([code])</span></span>
<span class="line"><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">全推数据 日线最新值</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, full_tick)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">#下载历史数据 下载接口本身不返回数据</span></span>
<span class="line"><span style="color:#F8F8F2;">xtdata.download_history_data(code, </span><span style="color:#FFB86C;font-style:italic;">period</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">1m</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">start_time</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">20230701</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">#订阅最新行情</span></span>
<span class="line"><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">callback_func</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">data</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">回调触发</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">xtdata.subscribe_quote(code, </span><span style="color:#FFB86C;font-style:italic;">period</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">1m</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">count</span><span style="color:#FF79C6;">=-</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">callback</span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> callback_func)</span></span>
<span class="line"><span style="color:#F8F8F2;">data </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdata.get_market_data([</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">close</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">], [code], </span><span style="color:#FFB86C;font-style:italic;">period</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">1m</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">start_time</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">20230701</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">一次性取数据</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">#死循环 阻塞主线程退出</span></span>
<span class="line"><span style="color:#F8F8F2;">xtdata.run()</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p></div><!--]--></div><h3 id="获取对手价" tabindex="-1"><a class="header-anchor" href="#获取对手价" aria-hidden="true">#</a> 获取对手价</h3><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-41-0" aria-selected="true">python</button><button type="button" class="vp-tab-nav" role="tab" aria-controls="tab-41-1" aria-selected="false">返回值</button></div><!--[--><div class="vp-tab active" id="tab-41-0" role="tabpanel" aria-expanded="true"><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#6272A4;"># 以卖出为例</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> pandas </span><span style="color:#FF79C6;">as</span><span style="color:#F8F8F2;"> pd</span></span>
<span class="line"><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> numpy </span><span style="color:#FF79C6;">as</span><span style="color:#F8F8F2;"> np</span></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> xtdata</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">to_do_trade_list </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> [</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">000001.SZ</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">]</span></span>
<span class="line"><span style="color:#F8F8F2;">tick </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdata.get_full_tick(to_do_trade_list)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 取买一价为对手价，若买一价为0，说明已经跌停，则取最新价</span></span>
<span class="line"><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> i </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> tick:</span></span>
<span class="line"><span style="color:#F8F8F2;">    fix_price </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> tick[i][</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">bidPrice</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">][</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> tick[i][</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">bidPrice</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">][</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">!=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">else</span><span style="color:#F8F8F2;"> tick[i][</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">lastPrice</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">]</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(fix_price)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><div class="vp-tab" id="tab-41-1" role="tabpanel" aria-expanded="false"><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#BD93F9;">10.01</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><!--]--></div><h3 id="获取5档盘口行情" tabindex="-1"><a class="header-anchor" href="#获取5档盘口行情" aria-hidden="true">#</a> 获取5档盘口行情</h3>

<div class="custom-container tip"><p class="custom-container-title">提示</p><ol><li>该数据为VIP数据</li></ol></div>

<div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-61-0" aria-selected="true">示例</button><button type="button" class="vp-tab-nav" role="tab" aria-controls="tab-61-1" aria-selected="false">五档返回值</button></div><!--[--><div class="vp-tab active" id="tab-61-0" role="tabpanel" aria-expanded="true"><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> xtdata</span></span>
<span class="line"><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> time</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">symbol_list </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> [</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">rb2405.SF</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">,</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">ec2404.INE</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">] </span><span style="color:#6272A4;"># 五档行情支持上期所，上期能源</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">period </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">l2quote</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#6272A4;"># 获取5档盘口tick</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> symbol </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> symbol_list:</span></span>
<span class="line"><span style="color:#F8F8F2;">    xtdata.subscribe_quote(symbol,</span><span style="color:#FFB86C;font-style:italic;">period</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> period,</span><span style="color:#FFB86C;font-style:italic;">count</span><span style="color:#FF79C6;">=-</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">time.sleep(</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">data </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdata.get_market_data_ex([</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">askPrice</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">,</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">bidPrice</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">],symbol_list,</span><span style="color:#FFB86C;font-style:italic;">period</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> period,</span><span style="color:#FFB86C;font-style:italic;">count</span><span style="color:#FF79C6;">=-</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(data)</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><div class="vp-tab" id="tab-61-1" role="tabpanel" aria-expanded="false"><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">{</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">ec2404.INE</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">:                                                          askPrice  \</span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115085900</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2300.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2300.2</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2304.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2306.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2310.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115090000</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2266.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2280.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2280.9</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2285.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2287.9</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115090001</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2261.6000000000004</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2262.0000000000005</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2262...</span><span style="color:#F8F8F2;">.   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115090001</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2253.4</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2253.5</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2253.6</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2254.6</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2255.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115090002</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2244.6</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2246.6</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2246.7999999999997</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2248.8999...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">                                                           </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140227</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2138.3</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2138.6000000000004</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2138.700000000000...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140228</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2138.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2138.3</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2138.6000000000004</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2138.7000...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140228</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2137.7999999999997</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2137.8999999999996</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2137...</span><span style="color:#F8F8F2;">.   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140229</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2137.2999999999997</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2137.7999999999997</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2137...</span><span style="color:#F8F8F2;">.   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140229</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2136.4</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2137.1</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2137.7999999999997</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2137.8999...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#F8F8F2;">                                                          bidPrice  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115085900</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2288.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2280.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2266.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2265.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2262.1</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115090000</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2222.1</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2222.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2220.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2219.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2216.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115090001</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2227.0000000000005</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2226.8000000000006</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2226...</span><span style="color:#F8F8F2;">.  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115090001</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2230.2000000000003</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2230.0000000000005</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2229...</span><span style="color:#F8F8F2;">.  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115090002</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2233.2000000000003</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2223.4</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2222.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2220.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">                                                           </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140227</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2137.1</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2135.2999999999997</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2134.999999999999...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140228</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2137.1</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2135.2999999999997</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2134.999999999999...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140228</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2137.1</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2135.2999999999997</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2134.999999999999...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140229</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2137.1</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2135.2999999999997</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2134.999999999999...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140229</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">2135.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2134.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2132.4</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2132.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2131.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#F8F8F2;"> [</span><span style="color:#BD93F9;">15942</span><span style="color:#F8F8F2;"> rows x </span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;"> columns],</span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">rb2405.SF</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">:                                                          askPrice  \</span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240112205900</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3906.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3907.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3908.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3909.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3910.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240112210000</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3904.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3905.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3906.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3907.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3908.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240112210001</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3905.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3906.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3907.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3908.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3909.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240112210001</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3905.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3906.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3907.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3908.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3909.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240112210002</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3905.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3906.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3907.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3908.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3909.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">                                                           </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140227</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3911.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3912.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3913.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3914.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3915.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140227</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3911.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3912.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3913.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3914.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3915.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140228</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3911.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3912.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3913.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3914.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3915.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140228</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3911.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3912.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3913.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3914.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3915.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140229</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3911.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3912.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3913.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3914.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3915.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">   </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#F8F8F2;">                                                          bidPrice  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240112205900</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3905.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3904.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3903.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3902.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3901.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240112210000</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3903.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3902.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3901.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3900.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3899.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240112210001</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3904.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3903.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3902.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3901.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3900.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240112210001</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3904.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3903.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3902.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3901.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3900.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240112210002</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3904.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3903.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3902.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3901.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3900.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">                                                           </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140227</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3910.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3909.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3908.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3907.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3906.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140227</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3910.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3909.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3908.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3907.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3906.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140228</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3910.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3909.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3908.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3907.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3906.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140228</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3910.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3909.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3908.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3907.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3906.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">20240115140229</span><span style="color:#F8F8F2;">  [</span><span style="color:#BD93F9;">3910.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3909.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3908.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3907.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3906.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0.0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">...</span><span style="color:#F8F8F2;">  </span></span>
<span class="line"><span style="color:#F8F8F2;"> </span></span>
<span class="line"><span style="color:#F8F8F2;"> [</span><span style="color:#BD93F9;">35329</span><span style="color:#F8F8F2;"> rows x </span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;"> columns]}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--]--></div><h3 id="复权计算方式" tabindex="-1"><a class="header-anchor" href="#复权计算方式" aria-hidden="true">#</a> 复权计算方式</h3><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-72-0" aria-selected="true">python</button></div><!--[--><div class="vp-tab active" id="tab-72-0" role="tabpanel" aria-expanded="true"><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#6272A4;">#coding:utf-8</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> numpy </span><span style="color:#FF79C6;">as</span><span style="color:#F8F8F2;"> np</span></span>
<span class="line"><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> pandas </span><span style="color:#FF79C6;">as</span><span style="color:#F8F8F2;"> pd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> xtdata</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">#def gen_divid_ratio(quote_datas, divid_datas):</span></span>
<span class="line"><span style="color:#6272A4;">#    drl = []</span></span>
<span class="line"><span style="color:#6272A4;">#    for qi in range(len(quote_datas)):</span></span>
<span class="line"><span style="color:#6272A4;">#        q = quote_datas.iloc[qi]</span></span>
<span class="line"><span style="color:#6272A4;">#        dr = 1.0</span></span>
<span class="line"><span style="color:#6272A4;">#        for di in range(len(divid_datas)):</span></span>
<span class="line"><span style="color:#6272A4;">#            d = divid_datas.iloc[di]</span></span>
<span class="line"><span style="color:#6272A4;">#            if d.name &lt;= q.name:</span></span>
<span class="line"><span style="color:#6272A4;">#                dr *= d[&#39;dr&#39;]</span></span>
<span class="line"><span style="color:#6272A4;">#        drl.append(dr)</span></span>
<span class="line"><span style="color:#6272A4;">#    return pd.DataFrame(drl, index = quote_datas.index, columns = quote_datas.columns)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">gen_divid_ratio</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">quote_datas</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">divid_datas</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">    drl </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> []</span></span>
<span class="line"><span style="color:#F8F8F2;">    dr </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1.0</span></span>
<span class="line"><span style="color:#F8F8F2;">    qi </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span></span>
<span class="line"><span style="color:#F8F8F2;">    qdl </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">len</span><span style="color:#F8F8F2;">(quote_datas)</span></span>
<span class="line"><span style="color:#F8F8F2;">    di </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span></span>
<span class="line"><span style="color:#F8F8F2;">    ddl </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">len</span><span style="color:#F8F8F2;">(divid_datas)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">while</span><span style="color:#F8F8F2;"> qi </span><span style="color:#FF79C6;">&lt;</span><span style="color:#F8F8F2;"> qdl </span><span style="color:#FF79C6;">and</span><span style="color:#F8F8F2;"> di </span><span style="color:#FF79C6;">&lt;</span><span style="color:#F8F8F2;"> ddl:</span></span>
<span class="line"><span style="color:#F8F8F2;">        qd </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> quote_datas.iloc[qi]</span></span>
<span class="line"><span style="color:#F8F8F2;">        dd </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> divid_datas.iloc[di]</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> qd.name </span><span style="color:#FF79C6;">&gt;=</span><span style="color:#F8F8F2;"> dd.name:</span></span>
<span class="line"><span style="color:#F8F8F2;">            dr </span><span style="color:#FF79C6;">*=</span><span style="color:#F8F8F2;"> dd[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">dr</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">]</span></span>
<span class="line"><span style="color:#F8F8F2;">            di </span><span style="color:#FF79C6;">+=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> qd.name </span><span style="color:#FF79C6;">&lt;=</span><span style="color:#F8F8F2;"> dd.name:</span></span>
<span class="line"><span style="color:#F8F8F2;">            drl.append(dr)</span></span>
<span class="line"><span style="color:#F8F8F2;">            qi </span><span style="color:#FF79C6;">+=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">while</span><span style="color:#F8F8F2;"> qi </span><span style="color:#FF79C6;">&lt;</span><span style="color:#F8F8F2;"> qdl:</span></span>
<span class="line"><span style="color:#F8F8F2;">        drl.append(dr)</span></span>
<span class="line"><span style="color:#F8F8F2;">        qi </span><span style="color:#FF79C6;">+=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> pd.DataFrame(drl, </span><span style="color:#FFB86C;font-style:italic;">index</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> quote_datas.index, </span><span style="color:#FFB86C;font-style:italic;">columns</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> quote_datas.columns)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">process_forward_ratio</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">quote_datas</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">divid_datas</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">    drl </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> gen_divid_ratio(quote_datas, divid_datas)</span></span>
<span class="line"><span style="color:#F8F8F2;">    drlf </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> drl </span><span style="color:#FF79C6;">/</span><span style="color:#F8F8F2;"> drl.iloc[</span><span style="color:#FF79C6;">-</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">]</span></span>
<span class="line"><span style="color:#F8F8F2;">    result </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> (quote_datas </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> drlf).apply(</span><span style="color:#FF79C6;">lambda</span><span style="color:#F8F8F2;"> </span><span style="color:#FFB86C;font-style:italic;">x</span><span style="color:#F8F8F2;">: </span><span style="color:#8BE9FD;">round</span><span style="color:#F8F8F2;">(x, </span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;">))</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> result</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">process_backward_ratio</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">quote_datas</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">divid_datas</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">    drl </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> gen_divid_ratio(quote_datas, divid_datas)</span></span>
<span class="line"><span style="color:#F8F8F2;">    result </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> (quote_datas </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> drl).apply(</span><span style="color:#FF79C6;">lambda</span><span style="color:#F8F8F2;"> </span><span style="color:#FFB86C;font-style:italic;">x</span><span style="color:#F8F8F2;">: </span><span style="color:#8BE9FD;">round</span><span style="color:#F8F8F2;">(x, </span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;">))</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> result</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">process_forward</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">quote_datas1</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">divid_datas</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">    quote_datas </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> quote_datas1.copy()</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">calc_front</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">v</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">d</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">round</span><span style="color:#F8F8F2;">(</span></span>
<span class="line"><span style="color:#F8F8F2;">            (v </span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;"> d[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">interest</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">+</span><span style="color:#F8F8F2;"> d[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">allotPrice</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> d[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">allotNum</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">])</span></span>
<span class="line"><span style="color:#F8F8F2;">            </span><span style="color:#FF79C6;">/</span><span style="color:#F8F8F2;"> (</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">+</span><span style="color:#F8F8F2;"> d[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">allotNum</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">+</span><span style="color:#F8F8F2;"> d[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">stockBonus</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">+</span><span style="color:#F8F8F2;"> d[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">stockGift</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">])</span></span>
<span class="line"><span style="color:#F8F8F2;">            , </span><span style="color:#BD93F9;">2</span></span>
<span class="line"><span style="color:#F8F8F2;">        )</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> qi </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">range</span><span style="color:#F8F8F2;">(</span><span style="color:#8BE9FD;">len</span><span style="color:#F8F8F2;">(quote_datas)):</span></span>
<span class="line"><span style="color:#F8F8F2;">        q </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> quote_datas.iloc[qi]</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> di </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">range</span><span style="color:#F8F8F2;">(</span><span style="color:#8BE9FD;">len</span><span style="color:#F8F8F2;">(divid_datas)):</span></span>
<span class="line"><span style="color:#F8F8F2;">            d </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> divid_datas.iloc[di]</span></span>
<span class="line"><span style="color:#F8F8F2;">            </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> d.name </span><span style="color:#FF79C6;">&lt;=</span><span style="color:#F8F8F2;"> q.name:</span></span>
<span class="line"><span style="color:#F8F8F2;">                </span><span style="color:#FF79C6;">continue</span></span>
<span class="line"><span style="color:#F8F8F2;">            q.iloc[</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> calc_front(q.iloc[</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">], d)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> quote_datas</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">process_backward</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">quote_datas1</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">divid_datas</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">    quote_datas </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> quote_datas1.copy()</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">calc_front</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">v</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">d</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">round</span><span style="color:#F8F8F2;">(</span></span>
<span class="line"><span style="color:#F8F8F2;">            (v </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> (</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">+</span><span style="color:#F8F8F2;"> d[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">stockGift</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">+</span><span style="color:#F8F8F2;"> d[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">stockBonus</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">+</span><span style="color:#F8F8F2;"> d[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">allotNum</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">])</span></span>
<span class="line"><span style="color:#F8F8F2;">            </span><span style="color:#FF79C6;">+</span><span style="color:#F8F8F2;"> d[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">interest</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;"> d[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">allotNum</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> d[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">allotPrice</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">])</span></span>
<span class="line"><span style="color:#F8F8F2;">            , </span><span style="color:#BD93F9;">2</span></span>
<span class="line"><span style="color:#F8F8F2;">        )</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> qi </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">range</span><span style="color:#F8F8F2;">(</span><span style="color:#8BE9FD;">len</span><span style="color:#F8F8F2;">(quote_datas)):</span></span>
<span class="line"><span style="color:#F8F8F2;">        q </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> quote_datas.iloc[qi]</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> di </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">range</span><span style="color:#F8F8F2;">(</span><span style="color:#8BE9FD;">len</span><span style="color:#F8F8F2;">(divid_datas)):</span></span>
<span class="line"><span style="color:#F8F8F2;">            d </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> divid_datas.iloc[di]</span></span>
<span class="line"><span style="color:#F8F8F2;">            </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> d.name </span><span style="color:#FF79C6;">&gt;</span><span style="color:#F8F8F2;"> q.name:</span></span>
<span class="line"><span style="color:#F8F8F2;">                </span><span style="color:#FF79C6;">continue</span></span>
<span class="line"><span style="color:#F8F8F2;">            q.iloc[</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> calc_front(q.iloc[</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">], d)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> quote_datas</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">#--------------------------------</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">s </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">002594.SZ</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">#xtdata.download_history_data(s, &#39;1d&#39;, &#39;20100101&#39;, &#39;&#39;)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">dd </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdata.get_divid_factors(s)</span></span>
<span class="line"><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(dd)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">#复权计算用于处理价格字段</span></span>
<span class="line"><span style="color:#F8F8F2;">field_list </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> [</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">open</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">high</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">low</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">close</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">]</span></span>
<span class="line"><span style="color:#F8F8F2;">datas_ori </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdata.get_market_data(field_list, [s], </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">1d</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">dividend_type</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">none</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">close</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">].T</span></span>
<span class="line"><span style="color:#6272A4;">#print(datas_ori)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">#等比前复权</span></span>
<span class="line"><span style="color:#F8F8F2;">datas_forward_ratio </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> process_forward_ratio(datas_ori, dd)</span></span>
<span class="line"><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">datas_forward_ratio</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, datas_forward_ratio)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">#等比后复权</span></span>
<span class="line"><span style="color:#F8F8F2;">datas_backward_ratio </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> process_backward_ratio(datas_ori, dd)</span></span>
<span class="line"><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">datas_backward_ratio</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, datas_backward_ratio)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">#前复权</span></span>
<span class="line"><span style="color:#F8F8F2;">datas_forward </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> process_forward(datas_ori, dd)</span></span>
<span class="line"><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">datas_forward</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, datas_forward)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">#后复权</span></span>
<span class="line"><span style="color:#F8F8F2;">datas_backward </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> process_backward(datas_ori, dd)</span></span>
<span class="line"><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">datas_backward</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, datas_backward)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p></div><!--]--></div><h3 id="根据商品期货期权代码获取对应的商品期货合约代码" tabindex="-1"><a class="header-anchor" href="#根据商品期货期权代码获取对应的商品期货合约代码" aria-hidden="true">#</a> 根据商品期货期权代码获取对应的商品期货合约代码</h3><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-83-0" aria-selected="true">python</button><button type="button" class="vp-tab-nav" role="tab" aria-controls="tab-83-1" aria-selected="false">返回值</button></div><!--[--><div class="vp-tab active" id="tab-83-0" role="tabpanel" aria-expanded="true"><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> xtdata</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">get_option_underline_code</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">code</span><span style="color:#FF79C6;">:</span><span style="color:#8BE9FD;font-style:italic;">str</span><span style="color:#F8F8F2;">) </span><span style="color:#FF79C6;">-&gt;</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;font-style:italic;">str</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">    注意：该函数不适用于股指期货期权与ETF期权</span></span>
<span class="line"><span style="color:#6272A4;">    Todo: 根据商品期权代码获取对应的具体商品期货合约</span></span>
<span class="line"><span style="color:#6272A4;">    Args:</span></span>
<span class="line"><span style="color:#6272A4;">        code:str 期权代码</span></span>
<span class="line"><span style="color:#6272A4;">    Return:</span></span>
<span class="line"><span style="color:#6272A4;">        对应的期货合约代码</span></span>
<span class="line"><span style="color:#6272A4;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">    Exchange_dict </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">SHFE</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">:</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">SF</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">CZCE</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">:</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">ZF</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">DCE</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">:</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">DF</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">INE</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">:</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">INE</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">GFEX</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">:</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">GF</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> code.split(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">.</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">)[</span><span style="color:#FF79C6;">-</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">not</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> [v </span><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> k,v </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> Exchange_dict.items()]:</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">raise</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;font-style:italic;">KeyError</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">此函数不支持该交易所合约</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">    info </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdata.get_option_detail_data(code)</span></span>
<span class="line"><span style="color:#F8F8F2;">    underline_code </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> info[</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">OptUndlCode</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">+</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">.</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">+</span><span style="color:#F8F8F2;"> Exchange_dict[info[</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">OptUndlMarket</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">]]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> underline_code</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">__name__</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">==</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">__main__</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    symbol_code </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> get_option_underline_code(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">sc2403C465.INE</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">) </span><span style="color:#6272A4;"># 获取期权合约&#39;sc2403C465.INE&#39;对应的期货合约代码</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(symbol_code)</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><div class="vp-tab" id="tab-83-1" role="tabpanel" aria-expanded="false"><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">sc2403.INE</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p></p></div><!--]--></div><h3 id="根据指数代码-返回对应的期货合约" tabindex="-1"><a class="header-anchor" href="#根据指数代码-返回对应的期货合约" aria-hidden="true">#</a> 根据指数代码，返回对应的期货合约</h3><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-97-0" aria-selected="true">python</button><button type="button" class="vp-tab-nav" role="tab" aria-controls="tab-97-1" aria-selected="false">返回值</button></div><!--[--><div class="vp-tab active" id="tab-97-0" role="tabpanel" aria-expanded="true"><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> xtdata</span></span>
<span class="line"><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> re</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">get_financial_futures_code_from_index</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">index_code</span><span style="color:#FF79C6;">:</span><span style="color:#8BE9FD;font-style:italic;">str</span><span style="color:#F8F8F2;">) </span><span style="color:#FF79C6;">-&gt;</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;font-style:italic;">list</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">    ToDo:传入指数代码，返回对应的期货合约（当前）</span></span>
<span class="line"><span style="color:#6272A4;">    Args:</span></span>
<span class="line"><span style="color:#6272A4;">        index_code:指数代码，如&quot;000300.SH&quot;,&quot;000905.SH&quot;</span></span>
<span class="line"><span style="color:#6272A4;">    Retuen:</span></span>
<span class="line"><span style="color:#6272A4;">        list: 对应期货合约列表</span></span>
<span class="line"><span style="color:#6272A4;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">    financial_futures </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdata.get_stock_list_in_sector(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">中金所</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">    future_list </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> []</span></span>
<span class="line"><span style="color:#F8F8F2;">    pattern </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">r</span><span style="color:#FF5555;">&#39;</span><span style="color:#8BE9FD;font-style:italic;">^</span><span style="color:#BD93F9;">[a-zA-Z]</span><span style="color:#FF79C6;">{1,2}</span><span style="color:#8BE9FD;font-style:italic;">\d</span><span style="color:#FF79C6;">{3,4}\.</span><span style="color:#BD93F9;">[A-Z]</span><span style="color:#FF79C6;">{2}</span><span style="color:#8BE9FD;font-style:italic;">$</span><span style="color:#FF5555;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> i </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> financial_futures:</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> re.match(pattern,i):</span></span>
<span class="line"><span style="color:#F8F8F2;">            future_list.append(i)</span></span>
<span class="line"><span style="color:#F8F8F2;">    ls </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> []</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> i </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> future_list:</span></span>
<span class="line"><span style="color:#F8F8F2;">        _info </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdata._get_instrument_detail(i)</span></span>
<span class="line"><span style="color:#F8F8F2;">        _index_code </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> _info[</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">ExtendInfo</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">][</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">OptUndlCode</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">+</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">.</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">+</span><span style="color:#F8F8F2;"> _info[</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">ExtendInfo</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">][</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">OptUndlMarket</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">]</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> _index_code </span><span style="color:#FF79C6;">==</span><span style="color:#F8F8F2;"> index_code:</span></span>
<span class="line"><span style="color:#F8F8F2;">            ls.append(i)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> ls</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">__name__</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">==</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">__main__</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">    ls </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> get_financial_futures_code_from_index(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">000905.SH</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(ls)</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><div class="vp-tab" id="tab-97-1" role="tabpanel" aria-expanded="false"><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2;">[</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">IC2402.IF</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">IC2403.IF</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">IC2406.IF</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">IC2409.IF</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><!--]--></div><h2 id="交易示例" tabindex="-1"><a class="header-anchor" href="#交易示例" aria-hidden="true">#</a> 交易示例</h2><h3 id="order-stock-async-下单" tabindex="-1"><a class="header-anchor" href="#order-stock-async-下单" aria-hidden="true">#</a> order_stock_async - 下单</h3><p>本示例用于展示如何订阅上海及深圳市场全推，对于沪深A股品种策略进行判断当前涨幅超过 9 个点的买入 200 股</p><p><strong>需要调整的参数：</strong></p><ul><li><code>111</code>行的<code>path</code>变量需要改为本地客户端路径</li><li><code>116</code>行的资金账号需要调整为自身资金账号</li></ul><div class="custom-container warning"><p class="custom-container-title">注意</p><p>本策略只用于提供策略写法及参考，若您直接进行实盘下单，造成损失本网站不负担责任。</p></div><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-134-0" aria-selected="true">python</button></div><!--[--><div class="vp-tab active" id="tab-134-0" role="tabpanel" aria-expanded="true"><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#6272A4;">#coding:utf-8</span></span>
<span class="line"><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> time, datetime, traceback, sys</span></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> xtdata</span></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant.xttrader </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> XtQuantTrader, XtQuantTraderCallback</span></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant.xttype </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> StockAccount</span></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> xtconstant</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">#定义一个类 创建类的实例 作为状态的容器</span></span>
<span class="line"><span style="color:#FF79C6;">class</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">_a</span><span style="color:#F8F8F2;">():</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">pass</span></span>
<span class="line"><span style="color:#F8F8F2;">A </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> _a()</span></span>
<span class="line"><span style="color:#F8F8F2;">A.bought_list </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> []</span></span>
<span class="line"><span style="color:#F8F8F2;">A.hsa </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xtdata.get_stock_list_in_sector(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">沪深A股</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">interact</span><span style="color:#F8F8F2;">():</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;">&quot;&quot;&quot;执行后进入repl模式&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> code</span></span>
<span class="line"><span style="color:#F8F8F2;">    code.InteractiveConsole(</span><span style="color:#FFB86C;font-style:italic;">locals</span><span style="color:#FF79C6;">=</span><span style="color:#8BE9FD;">globals</span><span style="color:#F8F8F2;">()).interact()</span></span>
<span class="line"><span style="color:#F8F8F2;">xtdata.download_sector_data()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">f</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">data</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">    now </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> datetime.datetime.now()</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">for</span><span style="color:#F8F8F2;"> stock </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> data:</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> stock </span><span style="color:#FF79C6;">not</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> A.hsa:</span></span>
<span class="line"><span style="color:#F8F8F2;">            </span><span style="color:#FF79C6;">continue</span></span>
<span class="line"><span style="color:#F8F8F2;">        cuurent_price </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> data[stock][</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">lastPrice</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">]</span></span>
<span class="line"><span style="color:#F8F8F2;">        pre_price </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> data[stock][</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">lastClose</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">]</span></span>
<span class="line"><span style="color:#F8F8F2;">        ratio </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> cuurent_price </span><span style="color:#FF79C6;">/</span><span style="color:#F8F8F2;"> pre_price </span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> pre_price </span><span style="color:#FF79C6;">&gt;</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">else</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> ratio </span><span style="color:#FF79C6;">&gt;</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0.09</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">and</span><span style="color:#F8F8F2;"> stock </span><span style="color:#FF79C6;">not</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">in</span><span style="color:#F8F8F2;"> A.bought_list:</span></span>
<span class="line"><span style="color:#F8F8F2;">            </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#FF79C6;">f</span><span style="color:#F1FA8C;">&quot;</span><span style="color:#BD93F9;">{</span><span style="color:#F8F8F2;">now</span><span style="color:#BD93F9;">}</span><span style="color:#F1FA8C;"> 最新价 买入 </span><span style="color:#BD93F9;">{</span><span style="color:#F8F8F2;">stock</span><span style="color:#BD93F9;">}</span><span style="color:#F1FA8C;"> 200股&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">            async_seq </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xt_trader.order_stock_async(acc, stock, xtconstant.</span><span style="color:#BD93F9;">STOCK_BUY</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">200</span><span style="color:#F8F8F2;">, xtconstant.</span><span style="color:#BD93F9;">LATEST_PRICE</span><span style="color:#F8F8F2;">, </span><span style="color:#FF79C6;">-</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">strategy_name</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, stock)</span></span>
<span class="line"><span style="color:#F8F8F2;">            A.bought_list.append(stock)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span></span>
<span class="line"><span style="color:#FF79C6;">class</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">MyXtQuantTraderCallback</span><span style="color:#F8F8F2;">(</span><span style="color:#8BE9FD;font-style:italic;">XtQuantTraderCallback</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_disconnected</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        连接断开</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(datetime.datetime.now(),</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">连接断开回调</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_stock_order</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">order</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        委托回报推送</span></span>
<span class="line"><span style="color:#6272A4;">        :param order: XtOrder对象</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(datetime.datetime.now(), </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">委托回调</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, order.order_remark)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_stock_trade</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">trade</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        成交变动推送</span></span>
<span class="line"><span style="color:#6272A4;">        :param trade: XtTrade对象</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(datetime.datetime.now(), </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">成交回调</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, trade.order_remark)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_order_error</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">order_error</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        委托失败推送</span></span>
<span class="line"><span style="color:#6272A4;">        :param order_error:XtOrderError 对象</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;"># print(&quot;on order_error callback&quot;)</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;"># print(order_error.order_id, order_error.error_id, order_error.error_msg)</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#FF79C6;">f</span><span style="color:#F1FA8C;">&quot;委托报错回调 </span><span style="color:#BD93F9;">{</span><span style="color:#F8F8F2;">order_error.order_remark</span><span style="color:#BD93F9;">}</span><span style="color:#F1FA8C;"> </span><span style="color:#BD93F9;">{</span><span style="color:#F8F8F2;">order_error.error_msg</span><span style="color:#BD93F9;">}</span><span style="color:#F1FA8C;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_cancel_error</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">cancel_error</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        撤单失败推送</span></span>
<span class="line"><span style="color:#6272A4;">        :param cancel_error: XtCancelError 对象</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(datetime.datetime.now(), sys._getframe().f_code.co_name)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_order_stock_async_response</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">response</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        异步下单回报推送</span></span>
<span class="line"><span style="color:#6272A4;">        :param response: XtOrderResponse 对象</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#FF79C6;">f</span><span style="color:#F1FA8C;">&quot;异步委托回调 </span><span style="color:#BD93F9;">{</span><span style="color:#F8F8F2;">response.order_remark</span><span style="color:#BD93F9;">}</span><span style="color:#F1FA8C;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_cancel_order_stock_async_response</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">response</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        :param response: XtCancelOrderResponse 对象</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(datetime.datetime.now(), sys._getframe().f_code.co_name)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_account_status</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">status</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        :param response: XtAccountStatus 对象</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(datetime.datetime.now(), sys._getframe().f_code.co_name)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">__name__</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">==</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">__main__</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">start</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;">#指定客户端所在路径</span></span>
<span class="line"><span style="color:#F8F8F2;">    path </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">r</span><span style="color:#FF5555;">&#39;</span><span style="color:#F1FA8C;">D:</span><span style="color:#FF79C6;">\q</span><span style="color:#F1FA8C;">mt</span><span style="color:#8BE9FD;font-style:italic;">\s</span><span style="color:#F1FA8C;">p3</span><span style="color:#FF79C6;">\交易终端</span><span style="color:#FF79C6;">\u</span><span style="color:#F1FA8C;">serdata_mini</span><span style="color:#FF5555;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 生成session id 整数类型 同时运行的策略不能重复</span></span>
<span class="line"><span style="color:#F8F8F2;">    session_id </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;font-style:italic;">int</span><span style="color:#F8F8F2;">(time.time())</span></span>
<span class="line"><span style="color:#F8F8F2;">    xt_trader </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> XtQuantTrader(path, session_id)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 开启主动请求接口的专用线程 开启后在on_stock_xxx回调函数里调用XtQuantTrader.query_xxx函数不会卡住回调线程，但是查询和推送的数据在时序上会变得不确定</span></span>

<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># xt_trader.set_relaxed_response_order_enabled(True)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 创建资金账号为 800068 的证券账号对象</span></span>
<span class="line"><span style="color:#F8F8F2;">    acc </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> StockAccount(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">800068</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">STOCK</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 创建交易回调类对象，并声明接收回调</span></span>
<span class="line"><span style="color:#F8F8F2;">    callback </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> MyXtQuantTraderCallback()</span></span>
<span class="line"><span style="color:#F8F8F2;">    xt_trader.register_callback(callback)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 启动交易线程</span></span>
<span class="line"><span style="color:#F8F8F2;">    xt_trader.start()</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 建立交易连接，返回0表示连接成功</span></span>
<span class="line"><span style="color:#F8F8F2;">    connect_result </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xt_trader.connect()</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">建立交易连接，返回0表示连接成功</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, connect_result)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 对交易回调进行订阅，订阅后可以收到交易主推，返回0表示订阅成功</span></span>
<span class="line"><span style="color:#F8F8F2;">    subscribe_result </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xt_trader.subscribe(acc)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">对交易回调进行订阅，订阅后可以收到交易主推，返回0表示订阅成功</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, subscribe_result)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;">#这一行是注册全推回调函数 包括下单判断 安全起见处于注释状态 确认理解效果后再放开</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># xtdata.subscribe_whole_quote([&quot;SH&quot;, &quot;SZ&quot;], callback=f)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 阻塞主线程退出</span></span>
<span class="line"><span style="color:#F8F8F2;">    xt_trader.run_forever()</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 如果使用vscode pycharm等本地编辑器 可以进入交互模式 方便调试 （把上一行的run_forever注释掉 否则不会执行到这里）</span></span>
<span class="line"><span style="color:#F8F8F2;">    interact()</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--]--></div><h3 id="交易接口重连" tabindex="-1"><a class="header-anchor" href="#交易接口重连" aria-hidden="true">#</a> 交易接口重连</h3><p>该示例演示交易链接断开时重连的代码处理。</p><div class="custom-container tip"><p class="custom-container-title">提示</p><ol><li>该示例<strong>不是线程安全</strong>的，仅演示断开链接时应该怎么处理重连代码，实际使用时请注意避免潜在的问题</li><li>本策略只用于提供策略写法及参考，若您直接进行实盘下单，造成损失本网站不负担责任。</li></ol></div><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-159-0" aria-selected="true">python</button></div><!--[--><div class="vp-tab active" id="tab-159-0" role="tabpanel" aria-expanded="true"><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> time</span></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant.xttrader </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> XtQuantTrader, XtQuantTraderCallback</span></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant.xttype </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> StockAccount</span></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> xtconstant</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">#指定客户端所在路径</span></span>
<span class="line"><span style="color:#F8F8F2;">path </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">E:\qmt</span><span style="color:#FF79C6;">\\</span><span style="color:#F1FA8C;">userdata_mini</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#6272A4;"># 指定session id 整数类型，任意整数即可，同时运行的策略不能重复</span></span>
<span class="line"><span style="color:#F8F8F2;">session_id </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">123456</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">xt_trader </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">None</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">class</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">MyXtQuantTraderCallback</span><span style="color:#F8F8F2;">(</span><span style="color:#8BE9FD;font-style:italic;">XtQuantTraderCallback</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_disconnected</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        连接断开</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">connection lost, 交易接口断开，即将重连</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">global</span><span style="color:#F8F8F2;"> xt_trader</span></span>
<span class="line"><span style="color:#F8F8F2;">        xt_trader </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">None</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">connect</span><span style="color:#F8F8F2;">():</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">global</span><span style="color:#F8F8F2;"> session_id</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 重连时需要更换session_id</span></span>
<span class="line"><span style="color:#F8F8F2;">    session_id </span><span style="color:#FF79C6;">+=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1</span></span>
<span class="line"><span style="color:#F8F8F2;">    xt_trader </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> XtQuantTrader(path, session_id)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 创建资金账号为1000000365的证券账号对象</span></span>
<span class="line"><span style="color:#F8F8F2;">    acc </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> StockAccount(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">1000000365</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">    callback </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> MyXtQuantTraderCallback()</span></span>
<span class="line"><span style="color:#F8F8F2;">    xt_trader.register_callback(callback)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 启动交易线程</span></span>
<span class="line"><span style="color:#F8F8F2;">    xt_trader.start()</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 建立交易连接，返回0表示连接成功</span></span>
<span class="line"><span style="color:#F8F8F2;">    connect_result </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xt_trader.connect()</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> connect_result </span><span style="color:#FF79C6;">==</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> xt_trader, </span><span style="color:#BD93F9;">True</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">else</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">None</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">False</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">__name__</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">==</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">__main__</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">    xt_trader, success </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> connect()</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(xt_trader, success)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">while</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> xt_trader </span><span style="color:#FF79C6;">is</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">None</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">            </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">开始重连交易接口</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">            xt_trader, success </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> connect()</span></span>
<span class="line"><span style="color:#F8F8F2;">            </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> success:</span></span>
<span class="line"><span style="color:#F8F8F2;">                </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">交易接口重连成功</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">        time.sleep(</span><span style="color:#BD93F9;">3</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--]--></div><h3 id="信用账号执行还款" tabindex="-1"><a class="header-anchor" href="#信用账号执行还款" aria-hidden="true">#</a> 信用账号执行还款</h3><p>本示例用于展示如何使用xtquant库对信用账号执行还款的操作</p><div class="custom-container tip"><p class="custom-container-title">提示</p><p>本策略只用于提供策略写法及参考，若您直接进行实盘下单，造成损失本网站不负担责任。</p></div><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-175-0" aria-selected="true">python</button></div><!--[--><div class="vp-tab active" id="tab-175-0" role="tabpanel" aria-expanded="true"><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dracula" style="background-color:#282A36;" tabindex="0"><code><span class="line"><span style="color:#6272A4;">#coding=utf-8</span></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant.xttrader </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> XtQuantTrader, XtQuantTraderCallback</span></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant.xttype </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> StockAccount</span></span>
<span class="line"><span style="color:#FF79C6;">from</span><span style="color:#F8F8F2;"> xtquant </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> xtconstant</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 修改参数</span></span>
<span class="line"><span style="color:#6272A4;"># path为mini qmt客户端安装目录下userdata_mini路径</span></span>
<span class="line"><span style="color:#F8F8F2;">path </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">E:</span><span style="color:#FF79C6;">\\</span><span style="color:#F1FA8C;">qmt</span><span style="color:#FF79C6;">\\</span><span style="color:#F1FA8C;">userdata_mini</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#6272A4;"># session_id为会话编号，策略使用方对于不同的Python策略需要使用不同的会话编号</span></span>
<span class="line"><span style="color:#F8F8F2;">session_id </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1234567</span></span>
<span class="line"><span style="color:#F8F8F2;">repay_money </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1000.51</span><span style="color:#F8F8F2;">  </span><span style="color:#6272A4;"># 元，需要执行还款的金额</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">class</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">MyXtQuantTraderCallback</span><span style="color:#F8F8F2;">(</span><span style="color:#8BE9FD;font-style:italic;">XtQuantTraderCallback</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_disconnected</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        连接断开</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">connection lost</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_stock_order</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">order</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        委托回报推送</span></span>
<span class="line"><span style="color:#6272A4;">        :param order: XtOrder对象</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">on order callback:</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(order.stock_code, order.order_status, order.order_sysid)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_stock_asset</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">asset</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        资金变动推送</span></span>
<span class="line"><span style="color:#6272A4;">        :param asset: XtAsset对象</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">on asset callback</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(asset.account_id, asset.cash, asset.total_asset)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_stock_trade</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">trade</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        成交变动推送</span></span>
<span class="line"><span style="color:#6272A4;">        :param trade: XtTrade对象</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">on trade callback</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(trade.account_id, trade.stock_code, trade.order_id)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_order_error</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">order_error</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        委托失败推送</span></span>
<span class="line"><span style="color:#6272A4;">        :param order_error:XtOrderError 对象</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">on order_error callback</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(order_error.order_id, order_error.error_id, order_error.error_msg)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_cancel_error</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">cancel_error</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        撤单失败推送</span></span>
<span class="line"><span style="color:#6272A4;">        :param cancel_error: XtCancelError 对象</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">on cancel_error callback</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(cancel_error.order_id, cancel_error.error_id, cancel_error.error_msg)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_order_stock_async_response</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">response</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        异步下单回报推送</span></span>
<span class="line"><span style="color:#6272A4;">        :param response: XtOrderResponse 对象</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">on_order_stock_async_response</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(response.account_id, response.order_id, response.seq)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">def</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">on_account_status</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">self</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">status</span><span style="color:#F8F8F2;">):</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6272A4;">        :param response: XtAccountStatus 对象</span></span>
<span class="line"><span style="color:#6272A4;">        :return:</span></span>
<span class="line"><span style="color:#6272A4;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">on_account_status</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(status.account_id, status.account_type, status.status)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">__name__</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">==</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">__main__</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">demo test</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    xt_trader </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> XtQuantTrader(path, session_id)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 创建资金账号为1000000365的证券账号对象</span></span>
<span class="line"><span style="color:#F8F8F2;">    acc </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> StockAccount(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">200035</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">CREDIT</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># StockAccount可以用第二个参数指定账号类型，如沪港通传&#39;HUGANGTONG&#39;，深港通传&#39;SHENGANGTONG&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># acc = StockAccount(&#39;1000000365&#39;,&#39;STOCK&#39;)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 创建交易回调类对象，并声明接收回调</span></span>
<span class="line"><span style="color:#F8F8F2;">    callback </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> MyXtQuantTraderCallback()</span></span>
<span class="line"><span style="color:#F8F8F2;">    xt_trader.register_callback(callback)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 启动交易线程</span></span>
<span class="line"><span style="color:#F8F8F2;">    xt_trader.start()</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 建立交易连接，返回0表示连接成功</span></span>
<span class="line"><span style="color:#F8F8F2;">    connect_result </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xt_trader.connect()</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> connect_result </span><span style="color:#FF79C6;">!=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">import</span><span style="color:#F8F8F2;"> sys</span></span>
<span class="line"><span style="color:#F8F8F2;">        sys.exit(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">链接失败，程序即将退出 </span><span style="color:#BD93F9;">%d</span><span style="color:#E9F284;">&#39;</span><span style="color:#FF79C6;">%</span><span style="color:#F8F8F2;">connect_result)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 对交易回调进行订阅，订阅后可以收到交易主推，返回0表示订阅成功</span></span>
<span class="line"><span style="color:#F8F8F2;">    subscribe_result </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xt_trader.subscribe(acc)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> subscribe_result </span><span style="color:#FF79C6;">!=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">账号订阅失败 </span><span style="color:#BD93F9;">%d</span><span style="color:#E9F284;">&#39;</span><span style="color:#FF79C6;">%</span><span style="color:#F8F8F2;">subscribe_result)</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">print</span><span style="color:#F8F8F2;">(subscribe_result)</span></span>
<span class="line"><span style="color:#F8F8F2;">    stock_code </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">600000.SH</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">  </span><span style="color:#6272A4;"># 参数占位用，任意股票代码都可以</span></span>
<span class="line"><span style="color:#F8F8F2;">    volume </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">200</span><span style="color:#F8F8F2;">  </span><span style="color:#6272A4;"># 参数占位用，任意数量</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 使用指定价下单，接口返回订单编号，后续可以用于撤单操作以及查询委托状态</span></span>
<span class="line"><span style="color:#F8F8F2;">    fix_result_order_id </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> xt_trader.order_stock(acc, stock_code, xtconstant.</span><span style="color:#BD93F9;">CREDIT_DIRECT_CASH_REPAY</span><span style="color:#F8F8F2;">, repay_money, xtconstant.</span><span style="color:#BD93F9;">FIX_PRICE</span><span style="color:#F8F8F2;">, </span><span style="color:#FF79C6;">-</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">strategy_name</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">remark</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 阻塞线程，接收交易推送</span></span>
<span class="line"><span style="color:#F8F8F2;">    xt_trader.run_forever()</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--]--></div></div></div><!--[--><!--]--></div>

<nav class="page-nav" data-v-3c904194><p class="inner"><span class="prev"><a href="../nativeApi/xttrader.html" class="" aria-label="XtQuant.Xttrade 交易模块"><!--[--><!--]--> XtQuant.Xttrade 交易模块 <!--[--><!--]--></a></span><span class="next"><a href="../nativeApi/question_function.html" class="" aria-label="常见问题"><!--[--><!--]--> 常见问题 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>

  <div class="toFixedCopy wxFixed" style="text-align: center"><a href="https://work.weixin.qq.com/ca/cawcde1dc261ca71f1" target="_blank" rel="noopener noreferrer">联系微信获取权限<br><img src="../assets/联系客户经理.png" alt="微信扫码联系客服" title="点击联系客服" style="width:150px;"></a></div></body>
</html>
